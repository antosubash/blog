<?xml version="1.0" encoding="UTF-8"?>
        <rss version="2.0" xmlns:content="https://blog.antosubash.com/">
        <channel>
            <title>Anto Subash</title>
            <link>https://blog.antosubash.com</link>
            <description>Anto Subash's Blog</description>
            <language>en</language>
            <item>
          <title>Migrating Identity Service to OpenIddict Module</title>
          <link>https://blog.antosubash.com/posts/migrating-identity-service-to-open-iddict-module</link>
          <guid>https://blog.antosubash.com/posts/migrating-identity-service-to-open-iddict-module</guid>
          <pubDate>Mon, 05 Dec 2022 20:59:17 GMT</pubDate>
          <description>In this post we will see how to replace Identity server with OpenIddict in our microservice</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    code: "code",
    pre: "pre",
    h3: "h3",
    blockquote: "blockquote"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "introduction",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#introduction",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Introduction"]
    }), "\n", _jsxs(_components.p, {
      children: ["In this post we will see how to replace Identity server with OpenIddict in our microservice. We will use the same microservice we created in the previous posts. If you haven't read the previous post, you can read it ", _jsx(_components.a, {
        href: "/posts/abp-microservice-series",
        children: "here"
      }), "."]
    }), "\n", _jsxs(_components.h2, {
      id: "openiddict",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#openiddict",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "OpenIddict"]
    }), "\n", _jsx(_components.p, {
      children: "OpenIddict aims at providing a versatile solution to implement OpenID Connect client, server and token validation support in any ASP.NET Core 2.1 (and higher) application. ASP.NET 4.6.1 (and higher) applications are also fully supported thanks to a native Microsoft.Owin 4.2 integration."
    }), "\n", _jsx(_components.p, {
      children: "OpenIddict fully supports the code/implicit/hybrid flows, the client credentials/resource owner password grants and the device authorization flow."
    }), "\n", _jsx(_components.p, {
      children: "OpenIddict natively supports Entity Framework Core, Entity Framework 6 and MongoDB out-of-the-box and custom stores can be implemented to support other providers."
    }), "\n", _jsxs(_components.h2, {
      id: "reason-for-the-migration",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#reason-for-the-migration",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Reason for the migration"]
    }), "\n", _jsxs(_components.p, {
      children: ["The main reason for the migration is that the Identity server is not maintained anymore. The last release was in 2019. The latest version of ABP framework is using OpenIddict. So, it is better to use the latest version of the framework. you can read more about the migration ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/6.0/Migration-Guides/OpenIddict-Step-by-Step",
        children: "here"
      }), ". you can learn more about the background of the migration ", _jsx(_components.a, {
        href: "https://github.com/abpframework/abp/issues/11989",
        children: "here"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-new-temp-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-new-temp-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a new temp project"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will create a temp project and copy the ", _jsx(_components.code, {
        children: "AuthServer"
      }), " project from the temp project to the solution. We did the same while creating the microservice. We will do the same here."]
    }), "\n", _jsx(_components.p, {
      children: "Create a new folder and create the solution using the following command."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp new Tasky -t app -u angular --separate-auth-server -dbms PostgreSQL\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will create a new solution with the ", _jsx(_components.code, {
        children: "AuthServer"
      }), " project. Copy the ", _jsx(_components.code, {
        children: "AuthServer"
      }), " project from the temp project to the solution. after copying the project, copy ", _jsx(_components.code, {
        children: "angular"
      }), " folder from the temp project to the solution. This will replace the existing ", _jsx(_components.code, {
        children: "angular"
      }), " folder."]
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-abp-packages",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-abp-packages",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the ABP packages"]
    }), "\n", _jsx(_components.p, {
      children: "To update the ABP packages, use the following command."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp update\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will update all the ABP packages to the latest version. You can see the changes in the ", _jsx(_components.code, {
        children: "*.csproj"
      }), " files."]
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-net-version",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-net-version",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the .Net Version"]
    }), "\n", _jsxs(_components.p, {
      children: ["Update the .Net version to ", _jsx(_components.code, {
        children: "6.0"
      }), " in the ", _jsx(_components.code, {
        children: "*.csproj"
      }), " files."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<TargetFramework>net6.0</TargetFramework>\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-tyeyaml-file",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-tyeyaml-file",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the tye.yaml file"]
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "tye.yaml"
      }), " file to add the ", _jsx(_components.code, {
        children: "AuthServer"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "- name: tasky-auth-server\r\n  project: apps/Tasky.AuthServer/Tasky.AuthServer.csproj\r\n  bindings:\r\n    - protocol: https\r\n      port: 7600\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "configure-the-authserver",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#configure-the-authserver",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Configure the AuthServer"]
    }), "\n", _jsxs(_components.h3, {
      id: "add-auth-server-to-the-solution",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-auth-server-to-the-solution",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add Auth Server to the solution"]
    }), "\n", _jsxs(_components.p, {
      children: ["Add the ", _jsx(_components.code, {
        children: "AuthServer"
      }), " project to the solution."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet sln add .\\apps\\Tasky.AuthServer\\Tasky.AuthServer.csproj\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Add the Project references to the ", _jsx(_components.code, {
        children: "AuthServer"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet add .\\apps\\Tasky.AuthServer\\Tasky.AuthServer.csproj reference .\\services\\administration\\src\\Tasky.AdministrationService.EntityFrameworkCore\\Tasky.AdministrationService.EntityFrameworkCore.csproj\r\n\r\ndotnet add .\\apps\\Tasky.AuthServer\\Tasky.AuthServer.csproj reference .\\services\\identity\\src\\Tasky.IdentityService.EntityFrameworkCore\\Tasky.IdentityService.EntityFrameworkCore.csproj\r\n\r\ndotnet add .\\apps\\Tasky.AuthServer\\Tasky.AuthServer.csproj reference .\\services\\saas\\src\\Tasky.SaasService.EntityFrameworkCore\\Tasky.SaasService.EntityFrameworkCore.csproj\r\n\r\ndotnet add .\\apps\\Tasky.AuthServer\\Tasky.AuthServer.csproj reference .\\shared\\Tasky.Shared.Microservice.Hosting\\Tasky.Shared.Microservice.Hosting.csproj\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-taskyauthservermodule-dependency",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-taskyauthservermodule-dependency",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the TaskyAuthServerModule Dependency"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will update the ", _jsx(_components.code, {
        children: "TaskyAuthServerModule"
      }), " dependency in the ", _jsx(_components.code, {
        children: "AuthServer.csproj"
      }), " file:"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-csharp",
        children: "    typeof(AdministrationServiceEntityFrameworkCoreModule),\r\n    typeof(SaaSServiceEntityFrameworkCoreModule),\r\n    typeof(IdentityServiceEntityFrameworkCoreModule),\r\n    typeof(TaskyMicroserviceHosting)\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "configure-rabbitmq",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#configure-rabbitmq",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Configure RabbitMQ"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will use RabbitMQ to publish the events. So, we need to configure RabbitMQ in the ", _jsx(_components.code, {
        children: "AuthServer"
      }), " project."]
    }), "\n", _jsxs(_components.p, {
      children: ["Add the following section to the ", _jsx(_components.code, {
        children: "appsettings.json"
      }), " file:"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "  \"RabbitMQ\": {\r\n    \"Connections\": {\r\n      \"Default\": {\r\n        \"HostName\": \"localhost\"\r\n      }\r\n    },\r\n    \"EventBus\": {\r\n      \"ClientName\": \"Tasky_AuthServer\",\r\n      \"ExchangeName\": \"Tasky\"\r\n    }\r\n  }\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "configure-the-database",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#configure-the-database",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Configure the Database"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will update the connection string in the ", _jsx(_components.code, {
        children: "appsettings.json"
      }), " file:"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "  \"ConnectionStrings\": {\r\n    \"SaaS\": \"User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=SaasService;Pooling=false;\",\r\n    \"IdentityService\": \"User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=IdentityService;Pooling=false;\",\r\n    \"Administration\": \"User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=AdministrationService;Pooling=false;\"\r\n  },\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-cors-and-redirect-uris",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-cors-and-redirect-uris",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update CORS and Redirect URIs"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will update the CORS and Redirect URIs in the ", _jsx(_components.code, {
        children: "appsettings.json"
      }), " file:"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "  \"App\": {\r\n    \"SelfUrl\": \"https://localhost:44346\",\r\n    \"ClientUrl\": \"http://localhost:4200\",\r\n    \"CorsOrigins\": \"http://localhost:4200,http://localhost:3000,https://localhost:7001,https://localhost:7002,https://localhost:7003,https://localhost:7004,https://localhost:7005\",\r\n    \"RedirectAllowedUrls\": \"http://localhost:4200,http://localhost:3000,https://localhost:7001\"\r\n  },\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-port-number-in-the-authserver-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-port-number-in-the-authserver-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the port number in the ", _jsx(_components.code, {
        children: "AuthServer"
      }), " project"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will update the port number in the ", _jsx(_components.code, {
        children: "AuthServer"
      }), " project to ", _jsx(_components.code, {
        children: "7600"
      }), " in the ", _jsx(_components.code, {
        children: "AuthServer"
      }), ". you can do this by updating the ", _jsx(_components.code, {
        children: "launchSettings.json"
      }), " file."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "  \"applicationUrl\": \"https://localhost:7600;http://localhost:7600\"\n"
      })
    }), "\n", _jsxs(_components.blockquote, {
      children: ["\n", _jsx(_components.p, {
        children: "Note: after updating the .Net version, you may get the error from non abp packages. You can update the non abp packages to the latest version."
      }), "\n"]
    }), "\n", _jsx(_components.p, {
      children: "Build the solution to make sure everything is working fine."
    }), "\n", _jsxs(_components.h2, {
      id: "replace-the-identityserver-with-openiddict",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#replace-the-identityserver-with-openiddict",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Replace the IdentityServer with OpenIddict"]
    }), "\n", _jsxs(_components.p, {
      children: ["Search for ", _jsx(_components.code, {
        children: "IdentityServer"
      }), " in the solution and replace it with ", _jsx(_components.code, {
        children: "OpenIddict"
      }), " in the ", _jsx(_components.code, {
        children: "*.csproj"
      }), " files and ", _jsx(_components.code, {
        children: "*.cs"
      }), " files."]
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-identityservicedbcontext",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-identityservicedbcontext",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the IdentityServiceDbContext"]
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "IdentityServiceDbContext"
      }), " class to inherit from ", _jsx(_components.code, {
        children: "IOpenIddictDbContext"
      }), ". This will add the required tables for the OpenIddict and remove the tables for the IdentityServer."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-csharp",
        children: "    public DbSet<OpenIddictApplication> Applications { get; set; }\r\n    public DbSet<OpenIddictAuthorization> Authorizations { get; set; }\r\n    public DbSet<OpenIddictScope> Scopes { get; set; }\r\n    public DbSet<OpenIddictToken> Tokens { get; set; }\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "add-the-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-the-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add the migrations"]
    }), "\n", _jsxs(_components.p, {
      children: ["After updating the ", _jsx(_components.code, {
        children: "IdentityServiceDbContext"
      }), " class, add the migrations using the following command."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef migrations add Init-OpenIddict\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will add the migrations for the OpenIddict. Now, we can run the migrations using the following command."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef database update\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will remove the tables for the IdentityServer and add the tables for the OpenIddict."
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-data-seeder",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-data-seeder",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the data seeder"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will need to update the data seeder in the ", _jsx(_components.code, {
        children: "Tasky.DbMigrator"
      }), "."]
    }), "\n", _jsxs(_components.p, {
      children: ["Create a new class ", _jsx(_components.code, {
        children: "OpenIddictDataSeeder"
      }), " and add the following code."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-csharp",
        children: "using System;\r\nusing System.Collections.Generic;\r\nusing System.Linq;\r\nusing System.Threading.Tasks;\r\nusing Microsoft.Extensions.Configuration;\r\nusing OpenIddict.Abstractions;\r\nusing Volo.Abp.Authorization.Permissions;\r\nusing Volo.Abp.DependencyInjection;\r\nusing Volo.Abp.Guids;\r\nusing Volo.Abp.MultiTenancy;\r\nusing Volo.Abp.OpenIddict.Applications;\r\nusing Volo.Abp.PermissionManagement;\r\nusing Volo.Abp.Uow;\r\nusing Microsoft.Extensions.Localization;\r\nusing Volo.Abp;\r\nusing JetBrains.Annotations;\r\n\r\nnamespace Tasky.DbMigrator;\r\n\r\npublic class OpenIddictDataSeeder : ITransientDependency\r\n{\r\n    private readonly IConfiguration _configuration;\r\n    private readonly ICurrentTenant _currentTenant;\r\n    private readonly IGuidGenerator _guidGenerator;\r\n    private readonly IAbpApplicationManager _applicationManager;\r\n    private readonly IOpenIddictScopeManager _scopeManager;\r\n    private readonly IPermissionDataSeeder _permissionDataSeeder;\r\n    private readonly IStringLocalizer<OpenIddictResponse> L;\r\n\r\n    public OpenIddictDataSeeder(\r\n        IAbpApplicationManager applicationManager,\r\n        IOpenIddictScopeManager scopeManager,\r\n        IPermissionDataSeeder permissionDataSeeder,\r\n        IStringLocalizer<OpenIddictResponse> l,\r\n        IGuidGenerator guidGenerator,\r\n        IConfiguration configuration,\r\n        ICurrentTenant currentTenant)\r\n    {\r\n        _configuration = configuration;\r\n        _applicationManager = applicationManager;\r\n        _scopeManager = scopeManager;\r\n        _permissionDataSeeder = permissionDataSeeder;\r\n        _guidGenerator = guidGenerator;\r\n        _currentTenant = currentTenant;\r\n        L = l;\r\n    }\r\n\r\n    [UnitOfWork]\r\n    public async virtual Task SeedAsync()\r\n    {\r\n        using (_currentTenant.Change(null))\r\n        {\r\n            await CreateApiResourcesAsync();\r\n            await CreateClientsAsync();\r\n        }\r\n    }\r\n\r\n    private async Task CreateClientsAsync()\r\n    {\r\n        var clients = _configuration.GetSection(\"Clients\").Get<List<ServiceClient>>();\r\n        var commonScopes = new[] {\r\n            OpenIddictConstants.Permissions.Scopes.Address,\r\n            OpenIddictConstants.Permissions.Scopes.Email,\r\n            OpenIddictConstants.Permissions.Scopes.Phone,\r\n            OpenIddictConstants.Permissions.Scopes.Profile,\r\n            OpenIddictConstants.Permissions.Scopes.Roles,\r\n            \"offline_access\"\r\n        };\r\n\r\n        foreach (var client in clients)\r\n        {\r\n            var isClientSecretAvailable = !string.IsNullOrEmpty(client.ClientSecret);\r\n\r\n            await CreateClientAsync(\r\n                    client.ClientId,\r\n                    displayName: client.ClientId,\r\n                    secret: isClientSecretAvailable ? client.ClientSecret : null,\r\n                    type: isClientSecretAvailable ? OpenIddictConstants.ClientTypes.Confidential : OpenIddictConstants.ClientTypes.Public,\r\n                    scopes: commonScopes.Union(client.Scopes).ToList(),\r\n                    grantTypes: client.GrantTypes.ToList(),\r\n                    redirectUris: client.RedirectUris,\r\n                    postLogoutRedirectUris: client.PostLogoutRedirectUris,\r\n                    consentType: OpenIddictConstants.ConsentTypes.Implicit\r\n                );\r\n        }\r\n    }\r\n\r\n\r\n    private async Task CreateApiResourcesAsync()\r\n    {\r\n        var apiResources = _configuration.GetSection(\"ApiResource\").Get<string[]>();\r\n\r\n        foreach (var item in apiResources)\r\n        {\r\n            await CreateApiResourceAsync(item);\r\n        }\r\n    }\r\n\r\n    private async Task CreateApiResourceAsync(string name)\r\n    {\r\n        if (await _scopeManager.FindByNameAsync(name) == null)\r\n        {\r\n            await _scopeManager.CreateAsync(new OpenIddictScopeDescriptor\r\n            {\r\n                Name = name,\r\n                DisplayName = name + \" API\",\r\n                Resources =\r\n                {\r\n                    name\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    private async Task CreateClientAsync(\r\n        [NotNull] string name,\r\n        [NotNull] string type,\r\n        [NotNull] string consentType,\r\n        string displayName,\r\n        string secret,\r\n        List<string> grantTypes,\r\n        List<string> scopes,\r\n        string[] redirectUris = null,\r\n        string[] postLogoutRedirectUris = null,\r\n        List<string> permissions = null)\r\n    {\r\n        if (!string.IsNullOrEmpty(secret) && string.Equals(type, OpenIddictConstants.ClientTypes.Public, StringComparison.OrdinalIgnoreCase))\r\n        {\r\n            throw new BusinessException(L[\"NoClientSecretCanBeSetForPublicApplications\"]);\r\n        }\r\n\r\n        if (string.IsNullOrEmpty(secret) && string.Equals(type, OpenIddictConstants.ClientTypes.Confidential, StringComparison.OrdinalIgnoreCase))\r\n        {\r\n            throw new BusinessException(L[\"TheClientSecretIsRequiredForConfidentialApplications\"]);\r\n        }\r\n\r\n        if (!string.IsNullOrEmpty(name) && await _applicationManager.FindByClientIdAsync(name) != null)\r\n        {\r\n            return;\r\n            //throw new BusinessException(L[\"TheClientIdentifierIsAlreadyTakenByAnotherApplication\"]);\r\n        }\r\n\r\n        var client = await _applicationManager.FindByClientIdAsync(name);\r\n        if (client == null)\r\n        {\r\n            var application = new OpenIddictApplicationDescriptor\r\n            {\r\n                ClientId = name,\r\n                Type = type,\r\n                ClientSecret = secret,\r\n                ConsentType = consentType,\r\n                DisplayName = displayName\r\n            };\r\n\r\n            Check.NotNullOrEmpty(grantTypes, nameof(grantTypes));\r\n            Check.NotNullOrEmpty(scopes, nameof(scopes));\r\n\r\n            if (new[] { OpenIddictConstants.GrantTypes.AuthorizationCode, OpenIddictConstants.GrantTypes.Implicit }.All(grantTypes.Contains))\r\n            {\r\n                application.Permissions.Add(OpenIddictConstants.Permissions.ResponseTypes.CodeIdToken);\r\n                if (string.Equals(type, OpenIddictConstants.ClientTypes.Public, StringComparison.OrdinalIgnoreCase))\r\n                {\r\n                    application.Permissions.Add(OpenIddictConstants.Permissions.ResponseTypes.CodeIdTokenToken);\r\n                    application.Permissions.Add(OpenIddictConstants.Permissions.ResponseTypes.CodeToken);\r\n                }\r\n            }\r\n            application.Permissions.Add(OpenIddictConstants.Permissions.Endpoints.Logout);\r\n\r\n\r\n            foreach (var grantType in grantTypes)\r\n            {\r\n                if (grantType == OpenIddictConstants.GrantTypes.AuthorizationCode)\r\n                {\r\n                    application.Permissions.Add(OpenIddictConstants.Permissions.GrantTypes.AuthorizationCode);\r\n                    application.Permissions.Add(OpenIddictConstants.Permissions.ResponseTypes.Code);\r\n                }\r\n\r\n                if (grantType == OpenIddictConstants.GrantTypes.AuthorizationCode || grantType == OpenIddictConstants.GrantTypes.Implicit)\r\n                {\r\n                    application.Permissions.Add(OpenIddictConstants.Permissions.Endpoints.Authorization);\r\n                }\r\n\r\n                if (grantType == OpenIddictConstants.GrantTypes.AuthorizationCode ||\r\n                    grantType == OpenIddictConstants.GrantTypes.ClientCredentials ||\r\n                    grantType == OpenIddictConstants.GrantTypes.Password ||\r\n                    grantType == OpenIddictConstants.GrantTypes.RefreshToken ||\r\n                    grantType == OpenIddictConstants.GrantTypes.DeviceCode)\r\n                {\r\n                    application.Permissions.Add(OpenIddictConstants.Permissions.Endpoints.Token);\r\n                    application.Permissions.Add(OpenIddictConstants.Permissions.Endpoints.Revocation);\r\n                    application.Permissions.Add(OpenIddictConstants.Permissions.Endpoints.Introspection);\r\n                }\r\n\r\n                if (grantType == OpenIddictConstants.GrantTypes.ClientCredentials)\r\n                {\r\n                    application.Permissions.Add(OpenIddictConstants.Permissions.GrantTypes.ClientCredentials);\r\n                }\r\n\r\n                if (grantType == OpenIddictConstants.GrantTypes.Implicit)\r\n                {\r\n                    application.Permissions.Add(OpenIddictConstants.Permissions.GrantTypes.Implicit);\r\n                }\r\n\r\n                if (grantType == OpenIddictConstants.GrantTypes.Password)\r\n                {\r\n                    application.Permissions.Add(OpenIddictConstants.Permissions.GrantTypes.Password);\r\n                }\r\n\r\n                if (grantType == OpenIddictConstants.GrantTypes.RefreshToken)\r\n                {\r\n                    application.Permissions.Add(OpenIddictConstants.Permissions.GrantTypes.RefreshToken);\r\n                }\r\n\r\n                if (grantType == OpenIddictConstants.GrantTypes.DeviceCode)\r\n                {\r\n                    application.Permissions.Add(OpenIddictConstants.Permissions.GrantTypes.DeviceCode);\r\n                    application.Permissions.Add(OpenIddictConstants.Permissions.Endpoints.Device);\r\n                }\r\n\r\n                if (grantType == OpenIddictConstants.GrantTypes.Implicit)\r\n                {\r\n                    application.Permissions.Add(OpenIddictConstants.Permissions.ResponseTypes.IdToken);\r\n                    if (string.Equals(type, OpenIddictConstants.ClientTypes.Public, StringComparison.OrdinalIgnoreCase))\r\n                    {\r\n                        application.Permissions.Add(OpenIddictConstants.Permissions.ResponseTypes.IdTokenToken);\r\n                        application.Permissions.Add(OpenIddictConstants.Permissions.ResponseTypes.Token);\r\n                    }\r\n                }\r\n            }\r\n\r\n            var buildInScopes = new[]\r\n            {\r\n                OpenIddictConstants.Permissions.Scopes.Address,\r\n                OpenIddictConstants.Permissions.Scopes.Email,\r\n                OpenIddictConstants.Permissions.Scopes.Phone,\r\n                OpenIddictConstants.Permissions.Scopes.Profile,\r\n                OpenIddictConstants.Permissions.Scopes.Roles,\r\n                \"offline_access\"\r\n            };\r\n\r\n            foreach (var scope in scopes)\r\n            {\r\n                if (buildInScopes.Contains(scope))\r\n                {\r\n                    application.Permissions.Add(scope);\r\n                }\r\n                else\r\n                {\r\n                    application.Permissions.Add(OpenIddictConstants.Permissions.Prefixes.Scope + scope);\r\n                }\r\n            }\r\n\r\n            if (redirectUris != null)\r\n            {\r\n                foreach (var redirectUri in redirectUris)\r\n                {\r\n                    if (!redirectUri.IsNullOrEmpty())\r\n                    {\r\n                        if (!Uri.TryCreate(redirectUri, UriKind.Absolute, out var uri) || !uri.IsWellFormedOriginalString())\r\n                        {\r\n                            throw new BusinessException(L[\"InvalidRedirectUri\", redirectUri]);\r\n                        }\r\n\r\n                        if (application.RedirectUris.All(x => x != uri))\r\n                        {\r\n                            application.RedirectUris.Add(uri);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (postLogoutRedirectUris != null)\r\n            {\r\n                foreach (var postLogoutRedirectUri in postLogoutRedirectUris)\r\n                {\r\n                    if (!postLogoutRedirectUri.IsNullOrEmpty())\r\n                    {\r\n                        if (!Uri.TryCreate(postLogoutRedirectUri, UriKind.Absolute, out var uri) || !uri.IsWellFormedOriginalString())\r\n                        {\r\n                            throw new BusinessException(L[\"InvalidPostLogoutRedirectUri\", postLogoutRedirectUri]);\r\n                        }\r\n\r\n                        if (application.PostLogoutRedirectUris.All(x => x != uri))\r\n                        {\r\n                            application.PostLogoutRedirectUris.Add(uri);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (permissions != null)\r\n            {\r\n                await _permissionDataSeeder.SeedAsync(\r\n                    ClientPermissionValueProvider.ProviderName,\r\n                    name,\r\n                    permissions,\r\n                    null\r\n                );\r\n            }\r\n\r\n            await _applicationManager.CreateAsync(application);\r\n        }\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Create a new class ", _jsx(_components.code, {
        children: "OpenIddictDataSeedContributor"
      }), " and add the following code:"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-csharp",
        children: "using System.Threading.Tasks;\r\nusing Volo.Abp.Data;\r\nusing Volo.Abp.DependencyInjection;\r\n\r\nnamespace Tasky.DbMigrator;\r\n\r\npublic class OpenIddictDataSeedContributor : IDataSeedContributor, ITransientDependency\r\n{\r\n    private readonly OpenIddictDataSeeder _OpenIddictDataSeeder;\r\n\r\n    public OpenIddictDataSeedContributor(OpenIddictDataSeeder OpenIddictDataSeeder)\r\n    {\r\n        _OpenIddictDataSeeder = OpenIddictDataSeeder;\r\n    }\r\n\r\n\r\n    public async Task SeedAsync(DataSeedContext context)\r\n    {\r\n        await _OpenIddictDataSeeder.SeedAsync();\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["With the above code, we have created a new data seed contributor for OpenIddict. Now, we can delete the old ", _jsx(_components.code, {
        children: "IdentityServerDataSeedContributor"
      }), " class and ", _jsx(_components.code, {
        children: "IdentityServerDataSeeder"
      }), " class."]
    }), "\n", _jsxs(_components.h2, {
      id: "seed-the-application-client",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#seed-the-application-client",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Seed the Application Client"]
    }), "\n", _jsxs(_components.p, {
      children: ["Now, we have our OpenIddict data seed contributor. We can run the ", _jsx(_components.code, {
        children: "DbMigration"
      }), " project to create the seed data in the database."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will create the new Scopes and Clients in the database. We can check the database to see the new data."
    }), "\n", _jsxs(_components.h2, {
      id: "test-the-authserver",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#test-the-authserver",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Test the AuthServer"]
    }), "\n", _jsxs(_components.p, {
      children: ["We can test the AuthServer by running the ", _jsx(_components.code, {
        children: "AuthServer"
      }), " project:"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "If everything is configured correctly, we will be able to login to the AuthServer."
    }), "\n", _jsx(_components.p, {
      children: "Now, run all the projects using tye and test the entire application with the angular application."
    }), "\n", _jsxs(_components.h2, {
      id: "conclusion",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#conclusion",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Conclusion"]
    }), "\n", _jsx(_components.p, {
      children: "In this article, I have shown how to migrate the IdentityServer to OpenIddict. We have also seen how to create a new data seed contributor for OpenIddict and configure the AuthServer to use RabbitMQ and PostgreSQL. We have also tested the AuthServer and the entire application."
    }), "\n", _jsxs(_components.p, {
      children: ["you can find the source code for this article on ", _jsx(_components.a, {
        href: "https://github.com/antosubash/AbpMicroservice",
        children: "GitHub"
      })]
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Automatically version and release .Net Application</title>
          <link>https://blog.antosubash.com/posts/automatic-version-and-release</link>
          <guid>https://blog.antosubash.com/posts/automatic-version-and-release</guid>
          <pubDate>Sun, 23 Oct 2022 00:00:00 GMT</pubDate>
          <description>In this post you will see how to automatically version and release a .Net Application using GitHub Actions</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    ul: "ul",
    li: "li",
    code: "code",
    blockquote: "blockquote",
    h3: "h3",
    pre: "pre"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "introduction",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#introduction",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Introduction"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to automatically version and release a .Net Application using GitHub Actions. We will use the conventional commits specification to automatically version and release our application."
    }), "\n", _jsxs(_components.h2, {
      id: "conventional-commits",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#conventional-commits",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Conventional Commits"]
    }), "\n", _jsxs(_components.p, {
      children: ["Conventional Commits is a specification for adding human and machine readable meaning to commit messages. It provides an easy set of rules for creating an explicit commit history; which makes it easier to write automated tools on top of. This convention dovetails with ", _jsx(_components.a, {
        href: "https://semver.org",
        children: "SemVer"
      }), ", by describing the features, fixes, and breaking changes made in commit messages. If you want to know more about conventional commits, please check ", _jsx(_components.a, {
        href: "https://www.conventionalcommits.org/en/v1.0.0/",
        children: "this"
      }), "."]
    }), "\n", _jsxs(_components.h2, {
      id: "libraries-used",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#libraries-used",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Libraries used"]
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsxs(_components.li, {
        children: [_jsx(_components.a, {
          href: "https://github.com/versionize/versionize",
          children: "Versionize"
        }), " - To version the application"]
      }), "\n", _jsxs(_components.li, {
        children: [_jsx(_components.a, {
          href: "https://github.com/alirezanet/husky.net",
          children: "Husky.Net"
        }), " - To run git hooks in dotnet"]
      }), "\n", _jsx(_components.li, {
        children: "Github Actions - To automatically release the application"
      }), "\n"]
    }), "\n", _jsxs(_components.p, {
      children: ["Please note that we will use the ", _jsx(_components.code, {
        children: "Versionize"
      }), " library to version the application and ", _jsx(_components.code, {
        children: "Husky.Net"
      }), " to run git hooks in dotnet. These are amazing libraries and I highly recommend them. please check them out if you want to know more about them and give them a star. It will help the authors to keep working on them. I'm not affiliated with them in any way. I just like them and I'm using them in this post."]
    }), "\n", _jsxs(_components.h2, {
      id: "versionize",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#versionize",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Versionize"]
    }), "\n", _jsxs(_components.p, {
      children: ["Versionize is a library that can be used to version a .Net application. It uses the conventional commits specification to automatically version the application. It can also be used to automatically release the application. It can be used in any .Net application. It can be used in a console application, a web application, a web api, a library, etc. The current supported project types are: ", _jsx(_components.code, {
        children: "csproj"
      }), ", ", _jsx(_components.code, {
        children: "fsproj"
      }), ", ", _jsx(_components.code, {
        children: "vbproj"
      }), ". There is PR to support ", _jsx(_components.code, {
        children: ".props"
      }), " projects. hopefully, it will be merged soon."]
    }), "\n", _jsxs(_components.h2, {
      id: "huskynet",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#huskynet",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Husky.Net"]
    }), "\n", _jsxs(_components.p, {
      children: ["Husky.Net is a library that can be used to run git hooks in dotnet. It is a port of the famous ", _jsx(_components.a, {
        href: "https://github.com/typicode/husky",
        children: "Husky"
      }), " library. Husky is a library that can be used to run git hooks in nodejs. Husky.Net can be used to run git hooks in dotnet. It can be used in any .Net application."]
    }), "\n", _jsxs(_components.blockquote, {
      children: ["\n", _jsx(_components.p, {
        children: "Husky is not required for this but it is a nice to have. It will help us to keep the commit messages clean and consistent. If you don't want to use it you can skip this section. But I highly recommend it."
      }), "\n"]
    }), "\n", _jsxs(_components.h2, {
      id: "github-actions",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#github-actions",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "GitHub Actions"]
    }), "\n", _jsxs(_components.p, {
      children: ["I think there is no need to explain what GitHub Actions is. If you don't know what GitHub Actions is, please check ", _jsx(_components.a, {
        href: "https://docs.github.com/en/actions",
        children: "this"
      }), "."]
    }), "\n", _jsxs(_components.h2, {
      id: "create-the-net-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-net-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the .Net project"]
    }), "\n", _jsxs(_components.h3, {
      id: "create-a-github-repository",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-github-repository",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a github repository"]
    }), "\n", _jsx(_components.p, {
      children: "Create a github repository and clone it locally. You can use the following command to clone the repository."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "git clone \"url of the repository\"\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now, we will create a .Net project and add it to the repository."
    }), "\n", _jsxs(_components.h3, {
      id: "create-the-net-project-using-this-following-command",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-net-project-using-this-following-command",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the .Net project using this following command"]
    }), "\n", _jsx(_components.p, {
      children: "Navigate to the your repository folder and run the following command to create a .Net project."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet new console -n VersionMe -o .\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now we have a .Net console application. We will use this application to test the versioning and releasing."
    }), "\n", _jsxs(_components.h2, {
      id: "add-version-to-the-net-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-version-to-the-net-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add Version to the .Net project"]
    }), "\n", _jsx(_components.p, {
      children: "To get started add version to you csproj file."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "    <Version>1.0.0</Version>\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now we can install the versionize tool."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet tool install --global Versionize\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "When you want to version the application, run the following command."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "versionize\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will version the application, create a tag for the release and generate a changelog. You can find the changelog in the ", _jsx(_components.code, {
        children: "CHANGELOG.md"
      }), " file. make sure you push the tag to the remote repository."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "git push --tags\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "For now we have versioned the application manually and tagged the release. we also have a changelog. but to create a release we need to do it manually. we need to use the GitHub UI. But we want to automate this process. We want to automatically create a release when we push a commit to the main branch. We will use GitHub Actions to do this."
    }), "\n", _jsx(_components.p, {
      children: "Now lets automate this process using github actions."
    }), "\n", _jsxs(_components.h2, {
      id: "creating-github-action",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#creating-github-action",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Creating github action"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will create a github action to version and release the application. Create a new file in the ", _jsx(_components.code, {
        children: ".github/workflows"
      }), " folder and name it ", _jsx(_components.code, {
        children: "version-and-release.yml"
      }), ". In the ", _jsx(_components.code, {
        children: "version-and-release.yml"
      }), " file, add the following code."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "name: Version and Release\r\n\r\non:\r\n  push:\r\n    branches: [ \"main\" ]\r\n\r\njobs:\r\n  build:\r\n\r\n    runs-on: ubuntu-latest\r\n\r\n    steps:\r\n    - uses: actions/checkout@v3\r\n      with:\r\n        fetch-depth: 0\r\n    - name: Setup .NET\r\n      uses: actions/setup-dotnet@v3\r\n      with:\r\n        dotnet-version: 6.0.x\r\n    - name: Restore dependencies\r\n      run: dotnet restore\r\n    - name: Build\r\n      run: dotnet build --no-restore\r\n    - name: Install Versionize\r\n      run: dotnet tool install --global Versionize\r\n    - name: Setup git\r\n      run: |\r\n        git config --local user.email \"antosubash@live.com\"\r\n        git config --local user.name \"Anto Subash\"\r\n    - name: Versionize Release\r\n      id: versionize\r\n      run: versionize --changelog-all --exit-insignificant-commits\r\n      continue-on-error: true\r\n    - name: No release required\r\n      if: steps.versionize.outcome != 'success'\r\n      run: echo \"Skipping Release. No release required.\"\r\n    - name: Push changes to GitHub\r\n      if: steps.versionize.outcome == 'success'\r\n      uses: ad-m/github-push-action@master\r\n      with:\r\n        github_token: ${{ secrets.GITHUB_TOKEN }}\r\n        branch: ${{ github.ref }}\r\n        tags: true\r\n    - name: \"Create release\"\r\n      if: steps.versionize.outcome == 'success'\r\n      uses: \"actions/github-script@v5\"\r\n      with:\r\n        github-token: \"${{ secrets.GITHUB_TOKEN }}\"\r\n        script: |\r\n          try {\r\n            const tags_url = context.payload.repository.tags_url + \"?per_page=1\"\r\n            const result = await github.request(tags_url)\r\n            const current_tag = result.data[0].name\r\n            await github.rest.repos.createRelease({\r\n              draft: false,\r\n              generate_release_notes: true,\r\n              name: current_tag,\r\n              owner: context.repo.owner,\r\n              prerelease: false,\r\n              repo: context.repo.repo,\r\n              tag_name: current_tag,\r\n            });\r\n          } catch (error) {\r\n            core.setFailed(error.message);\r\n          }\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will run when we push a commit to the main branch. It will version the application, create a tag for the release and generate a changelog. It will also create a release using the GitHub API. You can find the changelog in the ", _jsx(_components.code, {
        children: "CHANGELOG.md"
      }), " file."]
    }), "\n", _jsxs(_components.p, {
      children: ["If you are new to GitHub Actions, please check ", _jsx(_components.a, {
        href: "https://docs.github.com/en/actions/learn-github-actions/introduction-to-github-actions",
        children: "this"
      }), " to learn more about GitHub Actions. It will help you to understand the above code."]
    }), "\n", _jsx(_components.p, {
      children: "Here is a brief explanation of the above code."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "name: Version and Release\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This is the name of the action."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "on:\r\n  push:\r\n    branches: [ \"main\" ]\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will run the action when we push a commit to the main branch."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "jobs:\r\n  build:\r\n    runs-on: ubuntu-latest\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This is the job that will run. We are using ubuntu-latest as the operating system."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "- uses: actions/checkout@v3\r\n  with:\r\n    fetch-depth: 0\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will checkout the repository."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "- name: Setup .NET\r\n  uses: actions/setup-dotnet@v3\r\n  with:\r\n    dotnet-version: 6.0.x\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will setup the .Net environment."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "- name: Restore dependencies\r\n  run: dotnet restore\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will restore the dependencies."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "- name: Build\r\n  run: dotnet build --no-restore\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will build the application."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "- name: Install Versionize\r\n  run: dotnet tool install --global Versionize\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will install the versionize tool."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "- name: Setup git\r\n  run: |\r\n        git config --local user.email \"antosubash@live.com\"\r\n        git config --local user.name \"Anto Subash\"\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will setup the git user name and email."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "- name: Versionize Release\r\n  id: versionize\r\n  run: versionize --changelog-all --exit-insignificant-commits\r\n  continue-on-error: true\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will version the application, create a tag for the release and generate a changelog. You can find the changelog in the ", _jsx(_components.code, {
        children: "CHANGELOG.md"
      }), " file."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "- name: No release required\r\n  if: steps.versionize.outcome != 'success'\r\n  run: echo \"Skipping Release. No release required.\"\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will check if the versionize command was successful. If it was successful, it will continue to the next step. If it was not successful, it will skip the release."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "- name: Push changes to GitHub\r\n  if: steps.versionize.outcome == 'success'\r\n  uses: ad-m/github-push-action@master\r\n  with:\r\n    github_token: ${{ secrets.GITHUB_TOKEN }}\r\n    branch: ${{ github.ref }}\r\n    tags: true\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will push the changes to the GitHub repository."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "- name: \"Create release\"\r\n  if: steps.versionize.outcome == 'success'\r\n  uses: \"actions/github-script@v5\"\r\n  with:\r\n    github-token: \"${{ secrets.GITHUB_TOKEN }}\"\r\n    script: |\r\n      try {\r\n        const tags_url = context.payload.repository.tags_url + \"?per_page=1\"\r\n        const result = await github.request(tags_url)\r\n        const current_tag = result.data[0].name\r\n        await github.rest.repos.createRelease({\r\n          draft: false,\r\n          generate_release_notes: true,\r\n          name: current_tag,\r\n          owner: context.repo.owner,\r\n          prerelease: false,\r\n          repo: context.repo.repo,\r\n          tag_name: current_tag,\r\n        });\r\n      } catch (error) {\r\n        core.setFailed(error.message);\r\n      }\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will create a release using the GitHub API."
    }), "\n", _jsxs(_components.h2, {
      id: "adding-huskynet",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#adding-huskynet",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Adding Husky.Net"]
    }), "\n", _jsx(_components.p, {
      children: "We will use Husky.Net to lint the commit message. this will make the commit message follow the conventional commits standard."
    }), "\n", _jsxs(_components.blockquote, {
      children: ["\n", _jsx(_components.p, {
        children: "As I said earlier, This is not required. But it is a nice to have. If you don't want to use it you can skip this section. But I highly recommend it."
      }), "\n"]
    }), "\n", _jsx(_components.p, {
      children: "Follow the steps here to add Husky.Net to your project. https://alirezanet.github.io/Husky.Net/guide/getting-started.html#installation"
    }), "\n", _jsx(_components.p, {
      children: "if you are new to git hooks, please check this https://githooks.com. It will help you to understand what git hooks are."
    }), "\n", _jsxs(_components.h3, {
      id: "add-a-pre-commit-hook",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-a-pre-commit-hook",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add a pre-commit hook"]
    }), "\n", _jsx(_components.p, {
      children: "We will add a pre-commit hook to lint the commit message. Husky.Net will run the pre-commit hook before the commit is made."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet husky add pre-commit\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will add a pre-commit hook to your project. You can find the hook in the ", _jsx(_components.code, {
        children: ".husky"
      }), " folder. In the ", _jsx(_components.code, {
        children: "pre-commit"
      }), " file, you can add the commands you want to run before the commit is made. In our case, we will run a group of command. This is a good example in case you want to run multiple commands before the commit is made."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "husky run -v --group \"pre-commit\"\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "add-commit-msg-hook",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-commit-msg-hook",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add commit-msg hook"]
    }), "\n", _jsx(_components.p, {
      children: "We will add a commit msg hook to lint the commit message before the commit is made. Husky.Net will run the commit msg hook before the commit is made."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet husky add commit-msg\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will add a commit msg hook to your project. You can find the hook in the ", _jsx(_components.code, {
        children: ".husky"
      }), " folder. In the ", _jsx(_components.code, {
        children: "commit-msg"
      }), " file, you can add the commands you want to run before the commit is made. In our case, we will run commit-msg."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "husky run --name \"commit-message-linter\" --args \"$1\"\r\necho\r\necho Great work! 🥂\r\necho\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "add-a-commit-message-linter",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-a-commit-message-linter",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add a commit message linter"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will add a commit message linter to lint the commit message. Husky.Net will run the commit message linter before the commit is made. Create a new folder in the ", _jsx(_components.code, {
        children: ".husky"
      }), " folder and name it ", _jsx(_components.code, {
        children: "csx"
      }), " (csx stands for C# script). In the ", _jsx(_components.code, {
        children: "csx"
      }), " folder, create a new file and name it ", _jsx(_components.code, {
        children: "commit-lint.csx"
      }), ". In the ", _jsx(_components.code, {
        children: "commit-lint.csx"
      }), " file, add the following code."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-csharp",
        children: "using System.Text.RegularExpressions;\r\n\r\nprivate var pattern = @\"^(?=.{1,90}$)(?:build|feat|ci|chore|docs|fix|perf|refactor|revert|style|test|wip)(?:\\(.+\\))*(?::).{4,}(?:#\\d+)*(?<![\\.\\s])$\";\r\nprivate var msg = File.ReadAllLines(Args[0])[0];\r\n\r\nif (Regex.IsMatch(msg, pattern))\r\n    return 0;\r\n\r\nConsole.ForegroundColor = ConsoleColor.Red;\r\nConsole.WriteLine(\"Invalid commit message\");\r\nConsole.ResetColor();\r\nConsole.WriteLine(\"e.g: 'feat(scope): subject' or 'fix: subject'\");\r\nConsole.ForegroundColor = ConsoleColor.Gray;\r\nConsole.WriteLine(\"more info: https://www.conventionalcommits.org/en/v1.0.0/\");\r\n\r\nreturn 1;\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-task-runner",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-task-runner",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the task runner"]
    }), "\n", _jsxs(_components.p, {
      children: ["Now we have our hooks ready. We need to update the task runner to run the hooks. Open the ", _jsx(_components.code, {
        children: "task-runner.json"
      }), " file and update the tasks."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "{\r\n   \"tasks\": [\r\n     {\r\n       \"name\": \"commit-message-linter\",\r\n       \"command\": \"husky\",\r\n       \"args\": [\r\n         \"exec\",\r\n         \".husky/csx/commit-lint.csx\",\r\n         \"--args\",\r\n         \"${args}\"\r\n       ]\r\n     },\r\n     {\r\n       \"name\": \"dotnet-format\",\r\n       \"group\": \"pre-commit\",\r\n       \"command\": \"dotnet-format\",\r\n       \"args\": [\"--include\", \"${staged}\"],\r\n       \"include\": [\"**/*.cs\"]\r\n     }\r\n   ]\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "commit-and-push",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#commit-and-push",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Commit and push"]
    }), "\n", _jsx(_components.p, {
      children: "Now we are ready to commit and push our changes. Commit and push your changes. You can find the commit message linter in action."
    }), "\n", _jsx(_components.p, {
      children: "if you followed the steps correctly, you should see the following output when you didn't follow the conventional commits standard."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "[Husky] 🚀 Loading tasks ...\r\n--------------------------------------------------\r\n--------------------------------------------------\r\n[Husky] ⚡ Preparing task 'dotnet-format'\r\n[Husky] 💤 Skipped, no matched files\r\n--------------------------------------------------\r\n[Husky] 🚀 Loading tasks ...\r\n--------------------------------------------------\r\n[Husky] ⚡ Preparing task 'commit-message-linter'\r\n[Husky] ⌛ Executing task 'commit-message-linter' ...\r\nInvalid commit message\r\ne.g: 'feat(scope): subject' or 'fix: subject'\r\nMore info: https://www.conventionalcommits.org/en/v1.0.0/\r\nscript execution failed\r\n\r\n  ❌ Task 'commit-message-linter' failed in 2.445ms\r\n\r\nhusky - commit-msg hook exited with code 1 (error)\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "if you commit message is valid, you should see the following output."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "[Husky] 🚀 Loading tasks ...\r\n--------------------------------------------------\r\n[Husky] ⚡ Preparing task 'dotnet-format'\r\n[Husky] 💤 Skipped, no matched files\r\n--------------------------------------------------\r\n[Husky] 🚀 Loading tasks ...\r\n--------------------------------------------------\r\n[Husky] ⚡ Preparing task 'commit-message-linter'\r\n[Husky] ⌛ Executing task 'commit-message-linter' ...\r\n[Husky]  ✔ Successfully executed in 404ms\r\n--------------------------------------------------\r\n\r\nGreat work! 🥂\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "attach-huskynet-to-your-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#attach-huskynet-to-your-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Attach Husky.Net to your project"]
    }), "\n", _jsx(_components.p, {
      children: "To make things easier for other developers, you can attach Husky.Net to your project."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet husky attach <path-to-project-file>\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will add required configuration to your project file. You can find the configuration in the ", _jsx(_components.code, {
        children: "PropertyGroup"
      }), " section."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<Target Name=\"husky\" BeforeTargets=\"Restore;CollectPackageReferences\" Condition=\"'$(HUSKY)' != 0\">\r\n   <Exec Command=\"dotnet tool restore\"  StandardOutputImportance=\"Low\" StandardErrorImportance=\"High\"/>\r\n   <Exec Command=\"dotnet husky install\" StandardOutputImportance=\"Low\" StandardErrorImportance=\"High\"\r\n         WorkingDirectory=\"../../\" />  <!--Update this to the relative path to your project root dir -->\r\n</Target>\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "conclusion",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#conclusion",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Conclusion"]
    }), "\n", _jsxs(_components.p, {
      children: ["In this article, we have seen how to version and release a dotnet application using versionize and github actions. You can find the source code in the ", _jsx(_components.a, {
        href: "https://github.com/antosubash/dotnet-version-and-release",
        children: "github repository"
      }), " for this article. If you have any questions or suggestions, please leave a comment below. Thanks for reading. Happy coding! 🚀 🚀 🚀"]
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>MicroK8s - Hassle-free Kubernetes</title>
          <link>https://blog.antosubash.com/posts/microk8s-gettings-started</link>
          <guid>https://blog.antosubash.com/posts/microk8s-gettings-started</guid>
          <pubDate>Thu, 15 Sep 2022 14:30:14 GMT</pubDate>
          <description>In this post we will see how to get started with the MicroK8s Kubernetes distribution.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    ul: "ul",
    li: "li"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "introduction",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#introduction",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Introduction"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to get started with the microk8s and deploy a simple service. We will see how to access the service from outside the cluster using ingress controller. We will also see how to use the cert-manager to get a valid ssl certificate for the service and then how to use the docker registry to store the docker images and how to use the postgres database in the microk8s cluster. We will use tye to build the application and deploy it in the microk8s cluster."
    }), "\n", _jsxs(_components.h2, {
      id: "what-is-microk8s",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#what-is-microk8s",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "What is MicroK8s?"]
    }), "\n", _jsx(_components.p, {
      children: "MicroK8s is the easiest and fastest way to get Kubernetes up and running. Experiment with the latest upstream features and toggle services on and off. Seamlessly move your work from dev to production. It is Minimal and CNCF-certified distribution. it has Batteries included and sensible defaults. Microk8s is built by the Kubernetes team at Canonical. It is a single package of kubernetes that installs on 42 flavours of Linux. It works on all major Linux distributions, Windows, and macOS."
    }), "\n", _jsxs(_components.h2, {
      id: "why-use-microk8s",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#why-use-microk8s",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Why use MicroK8s?"]
    }), "\n", _jsx(_components.p, {
      children: "After moving away from docker swarm. I was looking for simple and easy to use kubernetes distribution. After trying out few options I have settled on microk8s as best option for the replacement of docker swarm. It is very easy to setup and managing it very easy and its perfect for my personal use. It provides all the features I need in the form of addons and removes most of the complexity in managing the kubernetes cluster. It is perfect for personal use. If you a developer who wants to use the kubernetes cluster without the complexities of managing the cluster this is the best option. It is also perfect for the small teams who want to use the kubernetes cluster for their development and testing."
    }), "\n", _jsxs(_components.h2, {
      id: "what-is-the-cost",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#what-is-the-cost",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "What is the cost?"]
    }), "\n", _jsxs(_components.p, {
      children: ["In this post I will create a single node cluster which will cost around 15€ or $. I'm going to use hetzner cloud and you can use the referral link ", _jsx(_components.a, {
        href: "https://hetzner.cloud/?ref=ENhA4rCZ5JUM",
        children: "https://hetzner.cloud/?ref=ENhA4rCZ5JUM"
      }), " and get 20€ for free to try it out."]
    }), "\n", _jsxs(_components.h2, {
      id: "what-are-the-goals",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#what-are-the-goals",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "What are the goals"]
    }), "\n", _jsx(_components.p, {
      children: "The goals are as follows"
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsx(_components.li, {
        children: "Setup and connect to the kubernetes cluster using kubectl"
      }), "\n", _jsx(_components.li, {
        children: "Setup reverse proxy to redirect traffic to containers (nginx) and lets encrypt for ssl."
      }), "\n", _jsx(_components.li, {
        children: "Deploy registry and postgres with storage"
      }), "\n", _jsx(_components.li, {
        children: "Deploy a .Net application which connects to the postgres database"
      }), "\n"]
    }), "\n", _jsxs(_components.h2, {
      id: "parts",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#parts",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Parts"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/setup-micro-k8s-with-ubuntu",
        children: "Part 1. Setup MicroK8s With Ubuntu"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/setup-nginx-and-cert-manager-in-micro-k8s",
        children: "Part 2. Setup Nginx and cert-manager in MicroK8s"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/deploy-docker-registry-and-postgres-database-in-micro-k8s",
        children: "Part 3. Deploy docker registry and postgres database in MicroK8s"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/create-and-deploy-dotnet-application-in-micro-k8s",
        children: "Part 4. Create and deploy .Net application in MicroK8s"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "repository",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#repository",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Repository"]
    }), "\n", _jsxs(_components.p, {
      children: ["you can find most of the code and yaml files used in the series ", _jsx(_components.a, {
        href: "https://github.com/antosubash/microk8s-hetzner-deployment",
        children: "here"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "conclusion",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#conclusion",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Conclusion"]
    }), "\n", _jsx(_components.p, {
      children: "This series is created with developers in mind. I wanted to show how easy it is to use k8s without the complexities. I think after docker swarm this is the best option for the my personal use. Give it a try and let me know how do you like it. I will be happy to hear your feedback. If you have any questions or suggestions please leave a comment below. I will be happy to answer them."
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Create and deploy .Net application in MicroK8s</title>
          <link>https://blog.antosubash.com/posts/create-and-deploy-dotnet-application-in-micro-k8s</link>
          <guid>https://blog.antosubash.com/posts/create-and-deploy-dotnet-application-in-micro-k8s</guid>
          <pubDate>Wed, 14 Sep 2022 19:55:43 GMT</pubDate>
          <description>In this post we will create a simple abp application and deploy it in the microk8s instance.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    pre: "pre",
    code: "code",
    blockquote: "blockquote"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "introduction",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#introduction",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Introduction"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will create a simple abp application and deploy it in the microk8s instance. We will use tye to deploy the application in the cluster and setup the ingress for the application the ingress will use cert-manager to get the certificate for the application. this app will connect to a postgres database to store its data."
    }), "\n", _jsxs(_components.h2, {
      id: "parts",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#parts",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Parts"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/setup-micro-k8s-with-ubuntu",
        children: "Part 1. Setup MicroK8s With Ubuntu"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/setup-nginx-and-cert-manager-in-micro-k8s",
        children: "Part 2. Setup Nginx and cert-manager in MicroK8s"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/deploy-docker-registry-and-postgres-database-in-micro-k8s",
        children: "Part 3. Deploy docker registry and postgres database in MicroK8s"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 4. Create and deploy .Net application in MicroK8s (this post)"
    }), "\n", _jsxs(_components.h2, {
      id: "repository",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#repository",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Repository"]
    }), "\n", _jsxs(_components.p, {
      children: ["you can find the sample application we will use in this post ", _jsx(_components.a, {
        href: "https://github.com/antosubash/abp-single-layer",
        children: "here"
      }), " and the yaml files used in this post ", _jsx(_components.a, {
        href: "https://github.com/antosubash/abp-single-layer/blob/main/todoapp-generate-production.yaml",
        children: "here"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-new-application",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-new-application",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a new application"]
    }), "\n", _jsx(_components.p, {
      children: "We will use the abp cli to create a new application. If you want to create a new application you can use the following command."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp new TodoApp -t app-nolayers --preview -dbms PostgreSQL\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["We are using the app-nolayers template and we are using the PostgreSQL database. You can use the other templates as well. You can find more information about this template ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Startup-Templates/Application-Single-Layer",
        children: "here"
      }), "."]
    }), "\n", _jsxs(_components.h2, {
      id: "build-the-application",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#build-the-application",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Build the application"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will use the tye to build the application. You can find more information about tye ", _jsx(_components.a, {
        href: "https://github.com/dotnet/tye",
        children: "here"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "tye init # this will create a tye.yaml file\r\ntye build # this will build the application\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-application",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-application",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the application"]
    }), "\n", _jsx(_components.p, {
      children: "We will update the application and make some changes. we will remove the migration check and migrate the database on startup. We will also update the tye file with registry information."
    }), "\n", _jsxs(_components.p, {
      children: ["lets update the ", _jsx(_components.code, {
        children: "Program.cs"
      }), " file with the following code."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-csharp",
        children: "var builder = WebApplication.CreateBuilder(args);\r\nbuilder.Host.AddAppSettingsSecretsJson()\r\n    .UseAutofac()\r\n    .UseSerilog();\r\nawait builder.AddApplicationAsync<TodoAppModule>();\r\nvar app = builder.Build();\r\nawait app.InitializeApplicationAsync();\r\nawait app.Services.GetRequiredService<TodoAppDbMigrationService>(). MigrateAsync(); // add this line\r\nLog.Information(\"Starting TodoApp.\");\r\nawait app.RunAsync();\r\nreturn 0;\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Since we are going to use nginx to serve the application we need to add the forwarded headers middleware. We will add the following code to the ", _jsx(_components.code, {
        children: "TodoAppModule.cs"
      }), " file."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-csharp",
        children: "context.Services.Configure<ForwardedHeadersOptions>(options =>\r\n        {\r\n            options.ForwardedHeaders =\r\n                ForwardedHeaders.XForwardedProto;\r\n        }); // add this line in ConfigureServices method\r\n\r\napp.UseForwardedHeaders(); // add this line in  OnApplicationInitialization method\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["lets update the ", _jsx(_components.code, {
        children: "tye.yaml"
      }), " file with the following code."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "name: todoapp\r\nregistry: registry.kdev.antosubash.com\r\nservices:\r\n- name: todoapp\r\n  project: TodoApp/TodoApp.csproj\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["lets add the version to the ", _jsx(_components.code, {
        children: "TodoApp.csproj"
      }), " file."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<Project Sdk=\"Microsoft.NET.Sdk.Web\">\r\n  <PropertyGroup>\r\n    <TargetFramework>net6.0</TargetFramework>\r\n    <Version>1.0.0</Version> <!-- add this line -->\r\n  </PropertyGroup>\r\n</Project>\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "lets build the application again."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "tye build\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "push-the-application-to-the-registry",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#push-the-application-to-the-registry",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Push the application to the registry"]
    }), "\n", _jsx(_components.p, {
      children: "lets push the application to the registry. we will use tye to push the application to the registry. tye will build the application and push it to the registry."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "tye push\n"
      })
    }), "\n", _jsxs(_components.blockquote, {
      children: ["\n", _jsx(_components.p, {
        children: "this will push the application to the registry. make sure you have logged in to the registry before pushing the application."
      }), "\n"]
    }), "\n", _jsxs(_components.h2, {
      id: "deploy-the-application",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#deploy-the-application",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Deploy the application"]
    }), "\n", _jsx(_components.p, {
      children: "lets deploy the application to the microk8s instance. the first thing is to generate the yaml files. we will use the tye to generate the yaml files."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "tye generate\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["this will generate the yaml file. we will rename the generated yaml file to ", _jsx(_components.code, {
        children: "todoapp-generate.yaml"
      }), ". we will use the ", _jsx(_components.code, {
        children: "todoapp-generate.yaml"
      }), " file to deploy the application. before deploying the application we need to update the ", _jsx(_components.code, {
        children: "todoapp-generate.yaml"
      }), " file. we will update the image name and add the environment variables. we will also add the ingress resource. we will use the following code to update the ", _jsx(_components.code, {
        children: "todoapp-generate.yaml"
      }), " file."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "kind: Deployment\r\napiVersion: apps/v1\r\nmetadata:\r\n  name: todoapp\r\n  labels:\r\n    app.kubernetes.io/name: 'todoapp'\r\n    app.kubernetes.io/part-of: 'todoapp'\r\nspec:\r\n  replicas: 1\r\n  selector:\r\n    matchLabels:\r\n      app.kubernetes.io/name: todoapp\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app.kubernetes.io/name: 'todoapp'\r\n        app.kubernetes.io/part-of: 'todoapp'\r\n    spec:\r\n      imagePullSecrets:\r\n      - name: regcred\r\n      containers:\r\n      - name: todoapp\r\n        image: registry.kdev.antosubash.com/todoapp:1.0.4\r\n        imagePullPolicy: Always\r\n        resources:\r\n          limits:\r\n            cpu: \"1\"\r\n            memory: 1Gi\r\n          requests:\r\n            cpu: \"0.5\"\r\n            memory: 1Gi\r\n        env:\r\n        - name: ASPNETCORE_URLS\r\n          value: 'http://*'\r\n        - name: PORT\r\n          value: '80'\r\n        - name: CONNECTIONSTRINGS__Default\r\n          value: 'Host=postgres.default.svc.cluster.local;Port=5432;Database=TodoApp;User ID=postgres;Password=my_postgres_password;'\r\n        - name: ASPNETCORE_ENVIRONMENT\r\n          value: 'Production'\r\n        - name: App__SelfUrl\r\n          value: 'https://todoapp.kdev.antosubash.com'\r\n        ports:\r\n        - containerPort: 80\r\n...\r\n---\r\nkind: Service\r\napiVersion: v1\r\nmetadata:\r\n  name: todoapp\r\n  labels:\r\n    app.kubernetes.io/name: 'todoapp'\r\n    app.kubernetes.io/part-of: 'todoapp'\r\nspec:\r\n  selector:\r\n    app.kubernetes.io/name: todoapp\r\n  type: ClusterIP\r\n  ports:\r\n  - name: http\r\n    protocol: TCP\r\n    port: 80\r\n    targetPort: 80\r\n...\r\n---\r\nkind: Ingress\r\napiVersion: networking.k8s.io/v1\r\nmetadata:\r\n  name: http-ingress-todoapp\r\n  annotations:\r\n    cert-manager.io/cluster-issuer: \"lets-encrypt\"\r\n    kubernetes.io/ingress.class: \"public\"\r\n    nginx.ingress.kubernetes.io/rewrite-target: '/$2'\r\n  labels:\r\n    app.kubernetes.io/part-of: 'todoapp'\r\nspec:\r\n  tls:\r\n  - hosts:\r\n    - todoapp.kdev.antosubash.com\r\n    secretName: todoapp-tls\r\n  rules:\r\n  - host: todoapp.kdev.antosubash.com\r\n    http:\r\n      paths:\r\n      - backend:\r\n          service:\r\n            name: todoapp\r\n            port:\r\n              number: 80\r\n        pathType: Prefix\r\n        path: /()(.*)\r\n...\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "lets deploy the application to the microk8s instance."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "kubectl apply -f todoapp-generate.yaml\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "access-the-application",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#access-the-application",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Access the application"]
    }), "\n", _jsx(_components.p, {
      children: "lets access the application. we will use the following url to access the application."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "https://todoapp.kdev.antosubash.com\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "conclusion",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#conclusion",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Conclusion"]
    }), "\n", _jsx(_components.p, {
      children: "This is the final post of the series. In this post we have seen how to deploy the application to the microk8s instance. we have also seen how to use the tye to deploy the application, build the application and push the application to the registry. we have also seen how to use the ingress resource to access the application. I hope you have enjoyed this series. I will see you in the next post."
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Deploy docker registry and postgres database in MicroK8s</title>
          <link>https://blog.antosubash.com/posts/deploy-docker-registry-and-postgres-database-in-micro-k8s</link>
          <guid>https://blog.antosubash.com/posts/deploy-docker-registry-and-postgres-database-in-micro-k8s</guid>
          <pubDate>Wed, 14 Sep 2022 19:53:18 GMT</pubDate>
          <description>In this post we will see how to deploy and secure the registry along with deploying a postgres database in microk8s</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    h3: "h3",
    code: "code",
    pre: "pre",
    blockquote: "blockquote"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "introduction",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#introduction",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Introduction"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to deploy and secure the registry along with deploying a postgres database in microk8s. We will also see how to connect to the created registry. We will also see how to create a secret in kubernetes and use it in the deployment. We will also see how to create a persistent volume and use it in the deployment."
    }), "\n", _jsxs(_components.h2, {
      id: "parts",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#parts",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Parts"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/setup-micro-k8s-with-ubuntu",
        children: "Part 1. Setup MicroK8s With Ubuntu"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/setup-nginx-and-cert-manager-in-micro-k8s",
        children: "Part 2. Setup Nginx and cert-manager in MicroK8s"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 3. Deploy docker registry and postgres database in MicroK8s (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/create-and-deploy-dotnet-application-in-micro-k8s",
        children: "Part 4. Create and deploy .Net application in MicroK8s"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "docker-registry",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#docker-registry",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Docker Registry"]
    }), "\n", _jsxs(_components.h3, {
      id: "registry-login-info",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#registry-login-info",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Registry login info"]
    }), "\n", _jsxs(_components.p, {
      children: ["first lets create a username and password and store it in ", _jsx(_components.code, {
        children: "registry.password"
      }), " file."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "touch registry.password\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "lets create the username and password."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "docker run --entrypoint htpasswd httpd:2 -Bbn youruser yourpassword\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["lets store the username and password in the ", _jsx(_components.code, {
        children: "registry.password"
      }), " file."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "docker run --entrypoint htpasswd httpd:2 -Bbn youruser yourpassword\n"
      })
    }), "\n", _jsxs(_components.blockquote, {
      children: ["\n", _jsxs(_components.p, {
        children: ["make sure to replace ", _jsx(_components.code, {
          children: "youruser"
        }), " and ", _jsx(_components.code, {
          children: "yourpassword"
        }), " with your own username and password."]
      }), "\n"]
    }), "\n", _jsxs(_components.p, {
      children: ["this will output the username and password. copy the output and paste it in the ", _jsx(_components.code, {
        children: "registry.password"
      }), " file."]
    }), "\n", _jsxs(_components.h3, {
      id: "deploy-registry",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#deploy-registry",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Deploy registry"]
    }), "\n", _jsx(_components.p, {
      children: "lets create a namespace for the registry."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s kubectl create namespace registry\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "lets create a secret for the registry."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s create secret generic auth-secret --from-file=registry.password -n registry\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now we have the auth-secret created. lets create the secret for the docker registry."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "kubectl create secret docker-registry regcred -n default --docker-server=registry.yourdomain.com --docker-username=youruser --docker-password=yourpassword --docker-email=myemail@something.com\n"
      })
    }), "\n", _jsxs(_components.blockquote, {
      children: ["\n", _jsxs(_components.p, {
        children: ["make sure to replace the ", _jsx(_components.code, {
          children: "yourdomain.com"
        }), " with your domain name. also replace the ", _jsx(_components.code, {
          children: "youruser"
        }), " and ", _jsx(_components.code, {
          children: "yourpassword"
        }), " with the username and password you created earlier. also replace the ", _jsx(_components.code, {
          children: "registry.yourdomain.com"
        }), " with your domain name."]
      }), "\n"]
    }), "\n", _jsx(_components.p, {
      children: "lets create the folder for the registry."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "mkdir /mnt/registry\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "lets create the registry deployment."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "apiVersion: v1\r\nkind: Namespace\r\nmetadata:\r\n  name: registry\r\n  labels:\r\n    app: registry\r\n---\r\napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: registry\r\n  namespace: registry\r\n  labels:\r\n    app: registry\r\nspec:\r\n  replicas: 1\r\n  selector:\r\n    matchLabels:\r\n      app: registry\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: registry\r\n    spec:\r\n      containers:\r\n      - name: registry\r\n        resources:\r\n          requests:\r\n            memory: \"100Mi\"\r\n            cpu: \"250m\"\r\n          limits:\r\n            memory: \"200Mi\"\r\n            cpu: \"500m\"\r\n        image: registry:2\r\n        ports:\r\n        - containerPort: 5000\r\n        volumeMounts:\r\n        - name: repo-vol\r\n          mountPath: \"/var/lib/registry\"\r\n        - name: certs-vol\r\n          mountPath: \"/certs\"\r\n          readOnly: true\r\n        - name: auth-vol\r\n          mountPath: \"/auth\"\r\n          readOnly: true\r\n        env:\r\n        - name: REGISTRY_AUTH\r\n          value: \"htpasswd\"\r\n        - name: REGISTRY_AUTH_HTPASSWD_REALM\r\n          value: \"Registry Realm\"\r\n        - name: REGISTRY_AUTH_HTPASSWD_PATH\r\n          value: \"/auth/registry.password\"\r\n        - name: REGISTRY_HTTP_TLS_CERTIFICATE\r\n          value: \"/certs/tls.crt\"\r\n        - name: REGISTRY_HTTP_TLS_KEY\r\n          value: \"/certs/tls.key\"\r\n        - name: VIRTUAL_HOST\r\n          value: \"registry.kdev.antosubash.com\"\r\n     \r\n      volumes:\r\n      - name: repo-vol\r\n        hostPath:\r\n          # directory location on host\r\n          path: /mnt/registry\r\n          # this field is optional\r\n          type: Directory\r\n      - name: certs-vol\r\n        secret:\r\n          secretName: registry-tls-secret\r\n      - name: auth-vol\r\n        secret:\r\n          secretName: auth-secret\r\n---\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: docker-registry\r\n  namespace: registry\r\nspec:\r\n  selector:\r\n    app: registry\r\n  ports:\r\n  - port: 5000\r\n    targetPort: 5000\r\n---\r\napiVersion: networking.k8s.io/v1\r\nkind: Ingress\r\nmetadata:\r\n  name: registry\r\n  namespace: registry\r\n  labels:\r\n    app: registry\r\n  annotations:\r\n    cert-manager.io/cluster-issuer: \"lets-encrypt\"\r\n    nginx.ingress.kubernetes.io/backend-protocol: \"HTTPS\"\r\n    nginx.ingress.kubernetes.io/proxy-body-size: 1024m\r\nspec:\r\n  tls:\r\n  - hosts:\r\n    - registry.kdev.antosubash.com\r\n    secretName: registry-tls-secret\r\n  rules:\r\n  - host: registry.kdev.antosubash.com\r\n    http:\r\n      paths:\r\n      - path: /\r\n        pathType: Prefix\r\n        backend:\r\n          service:\r\n            name: docker-registry\r\n            port:\r\n              number: 5000   \n"
      })
    }), "\n", _jsxs(_components.blockquote, {
      children: ["\n", _jsxs(_components.p, {
        children: ["make sure to replace the ", _jsx(_components.code, {
          children: "registry.kdev.antosubash.com"
        }), " with your domain name."]
      }), "\n"]
    }), "\n", _jsx(_components.p, {
      children: "apply the deployment."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s kubectl apply -f registry.yml\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "lets check the pods."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s kubectl get pods -n registry\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "lets check the services."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s kubectl get services -n registry\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "lets check the ingress."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s kubectl get ingress -n registry\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now we have the registry deployed. lets test it."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "docker login registry.kdev.antosubash.com\n"
      })
    }), "\n", _jsxs(_components.blockquote, {
      children: ["\n", _jsxs(_components.p, {
        children: ["make sure to replace the ", _jsx(_components.code, {
          children: "registry.kdev.antosubash.com"
        }), " with your domain name."]
      }), "\n"]
    }), "\n", _jsx(_components.p, {
      children: "if you managed to login to the registry, then you have successfully deployed the registry."
    }), "\n", _jsxs(_components.h2, {
      id: "postgres-database",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#postgres-database",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Postgres Database"]
    }), "\n", _jsx(_components.p, {
      children: "For this post, I am using the postgres database. you can use any database you want. I will be using the postgres database because it is the database I am most familiar with."
    }), "\n", _jsxs(_components.p, {
      children: ["we will use the ", _jsx(_components.code, {
        children: "PersistentVolume"
      }), " to store the database data. so lets make we have the storage addon enabled."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s status\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "if the storage addon is not enabled, then enable it."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s enable hostpath-storage\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now we have the storage addon enabled. lets deploy the postgres database."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "apiVersion: v1\r\nkind: PersistentVolumeClaim\r\nmetadata:\r\n  name: postgres-pvc\r\nspec:\r\n  accessModes: [ReadWriteOnce]\r\n  resources: { requests: { storage: 5Gi } }\r\n---\r\napiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: postgres\r\n  labels:\r\n    app: postgres\r\n    name: postgres\r\nspec:\r\n  replicas: 1\r\n  selector:\r\n    matchLabels:\r\n      app: postgres\r\n      task: postgres\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: postgres\r\n        task: postgres\r\n    spec:\r\n      containers:\r\n        - name: postgres\r\n          image: kartoza/postgis:12.0\r\n          ports:\r\n            - containerPort: 5432\r\n          env:\r\n            - name: POSTGRES_DB\r\n              value: \"test\"\r\n            - name: POSTGRES_USER\r\n              value: postgres\r\n            - name: POSTGRES_PASS\r\n              value: \"my_postgres_password\"\r\n            - name: --auth\r\n              value: \"md5\"\r\n            - name: POSTGRES_MULTIPLE_EXTENSIONS\r\n              value: \"postgis,hstore,postgis_topology\"\r\n          resources:\r\n            requests:\r\n              memory: \"100Mi\"\r\n              cpu: \"250m\"\r\n            limits:\r\n              memory: \"200Mi\"\r\n              cpu: \"500m\"\r\n          volumeMounts:\r\n            - name: postgres-data\r\n              mountPath: /var/lib/postgresql\r\n      volumes:\r\n        - name: postgres-data\r\n          persistentVolumeClaim:\r\n            claimName: postgres-pvc\r\n---\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: postgres\r\n  labels:\r\n    app: postgres\r\nspec:\r\n  ports:\r\n    - port: 5432\r\n      targetPort: 5432\r\n  selector:\r\n    app: postgres\r\n    task: postgres\r\n---\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "apply the deployment."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s kubectl apply -f postgres.yml\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "lets check the pods."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s kubectl get pods\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "lets check the services."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s kubectl get services\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "lets check the persistent volume claim."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s kubectl get pvc\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now we have the postgres database deployed. lets test it."
    }), "\n", _jsxs(_components.p, {
      children: ["To test the database, we will use the ", _jsx(_components.code, {
        children: "adminer"
      }), " tool. you can use any tool you want."]
    }), "\n", _jsxs(_components.p, {
      children: ["we will deploy the ", _jsx(_components.code, {
        children: "adminer"
      }), " tool."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "apiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: pgweb\r\nspec:\r\n  selector:\r\n    matchLabels:\r\n      app: pgweb\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: pgweb\r\n    spec:\r\n      containers:\r\n      - name: pgweb\r\n        image: adminer\r\n        resources:\r\n          limits:\r\n            memory: \"128Mi\"\r\n            cpu: \"500m\"\r\n        ports:\r\n        - containerPort: 8080\r\n---\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: pgweb-service\r\nspec:\r\n  selector:\r\n    app: pgweb\r\n  ports:\r\n  - port: 8080\r\n    targetPort: 8080\r\n---\r\napiVersion: networking.k8s.io/v1\r\nkind: Ingress\r\nmetadata:\r\n  name: pgweb-ingress\r\n  labels:\r\n    name: pgweb-ingress\r\n  annotations:\r\n    kubernetes.io/ingress.class: \"public\"\r\n    cert-manager.io/cluster-issuer: \"lets-encrypt\"\r\nspec:\r\n  tls:\r\n    - hosts:\r\n      - pgweb.kdev.antosubash.com\r\n      secretName: pgweb-tls\r\n  rules:\r\n  - host: pgweb.kdev.antosubash.com\r\n    http:\r\n      paths:\r\n      - pathType: Prefix\r\n        path: \"/\"\r\n        backend:\r\n          service:\r\n            name: pgweb-service\r\n            port: \r\n              number: 8080\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "apply the deployment."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s kubectl apply -f pgweb.yml\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "lets check the pods."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s kubectl get pods\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "lets check the services."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s kubectl get services\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "lets check the ingress."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s kubectl get ingress\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Now we have the ", _jsx(_components.code, {
        children: "adminer"
      }), " tool deployed. lets test it."]
    }), "\n", _jsxs(_components.blockquote, {
      children: ["\n", _jsxs(_components.p, {
        children: ["make sure to replace the ", _jsx(_components.code, {
          children: "pgweb.kdev.antosubash.com"
        }), " with your domain name."]
      }), "\n"]
    }), "\n", _jsxs(_components.p, {
      children: ["Lets visit the ", _jsx(_components.code, {
        children: "adminer"
      }), " tool. ", _jsx(_components.a, {
        href: "https://pgweb.kdev.antosubash.com",
        children: "https://pgweb.kdev.antosubash.com"
      }), " and login with the following credentials."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "System: PostgreSQL\r\nServer: postgres.default.svc.cluster.local\r\nUsername: postgres\r\nPassword: my_postgres_password\r\nDatabase: test\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "conclusion",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#conclusion",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Conclusion"]
    }), "\n", _jsxs(_components.p, {
      children: ["In this post, we have deployed the docker registry and postgres database to the microk8s cluster. we have also deployed the ", _jsx(_components.code, {
        children: "adminer"
      }), " tool to test the database. In the next post, we will deploy a simple dotnet core application to the microk8s cluster."]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/create-and-deploy-dotnet-application-in-micro-k8s",
        children: "Part 4. Create and deploy .Net application in MicroK8s"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "credits",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#credits",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Credits"]
    }), "\n", _jsx(_components.p, {
      children: "Docker registry is secured based on this post https://timvw.be/2021/11/08/hosting-a-secure-registry-on-microk8s/"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Setup Nginx and cert-manager in MicroK8s</title>
          <link>https://blog.antosubash.com/posts/setup-nginx-and-cert-manager-in-micro-k8s</link>
          <guid>https://blog.antosubash.com/posts/setup-nginx-and-cert-manager-in-micro-k8s</guid>
          <pubDate>Wed, 14 Sep 2022 19:51:51 GMT</pubDate>
          <description>In this post we will see how to setup nginx reverse proxy and cert-manager in microk8s</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    h3: "h3",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "introduction",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#introduction",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Introduction"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to setup nginx reverse proxy and cert-manager in microk8s. We will use the nginx ingress controller to create a reverse proxy for our applications. We will also use cert-manager to create and manage SSL certificates for our applications."
    }), "\n", _jsxs(_components.h2, {
      id: "parts",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#parts",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Parts"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/setup-micro-k8s-with-ubuntu",
        children: "Part 1. Setup MicroK8s With Ubuntu"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 2. Setup Nginx and cert-manager in MicroK8s (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/deploy-docker-registry-and-postgres-database-in-micro-k8s",
        children: "Part 3. Deploy docker registry and postgres database in MicroK8s"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/create-and-deploy-dotnet-application-in-micro-k8s",
        children: "Part 4. Create and deploy .Net application in MicroK8s"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "cert-manager",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#cert-manager",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Cert-Manager"]
    }), "\n", _jsxs(_components.h3, {
      id: "what-is-cert-manager",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#what-is-cert-manager",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "What is cert-manager?"]
    }), "\n", _jsx(_components.p, {
      children: "cert-manager adds certificates and certificate issuers as resource types in Kubernetes clusters, and simplifies the process of obtaining, renewing and using those certificates."
    }), "\n", _jsx(_components.p, {
      children: "It can issue certificates from a variety of supported sources, including Let's Encrypt, HashiCorp Vault, and Venafi as well as private PKI. It will ensure certificates are valid and up to date, and attempt to renew certificates at a configured time before expiry."
    }), "\n", _jsx(_components.p, {
      children: "We are going to use Let's Encrypt for the ssl certificates."
    }), "\n", _jsxs(_components.h3, {
      id: "enable-cert-manger",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#enable-cert-manger",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Enable cert-manger"]
    }), "\n", _jsx(_components.p, {
      children: "cert-manager comes as an addon for the microk8s. Make sure the addon is enabled. To check if the addons is enabled. just check the status of the microk8s."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s status\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: [_jsx(_components.code, {
        children: "cert-manager"
      }), " addons should be inside the enabled section."]
    }), "\n", _jsx(_components.p, {
      children: "If it is not available in the enabled section. then, run the following command to enable it."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s enable cert-manager\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will enable the cert-manager in microk8s."
    }), "\n", _jsxs(_components.h3, {
      id: "add-clusterissuer",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-clusterissuer",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add ClusterIssuer"]
    }), "\n", _jsx(_components.p, {
      children: "The first thing you'll need to configure after you've enabled cert-manager is an Issuer or a ClusterIssuer. These are resources that represent certificate authorities (CAs) able to sign certificates in response to certificate signing requests."
    }), "\n", _jsxs(_components.h3, {
      id: "production-issuer",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#production-issuer",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Production Issuer"]
    }), "\n", _jsx(_components.p, {
      children: "lets create a production issuer which can be used to get the ssl certificate from lets encrypt."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "apiVersion: cert-manager.io/v1\r\nkind: ClusterIssuer\r\nmetadata:\r\n name: lets-encrypt\r\nspec:\r\n acme:\r\n   email:  username@yourdomain.com # Change the email here\r\n   server: https://acme-v02.api.letsencrypt.org/directory\r\n   privateKeySecretRef:\r\n     name: lets-encrypt-prod\r\n   solvers:\r\n   - http01:\r\n       ingress:\r\n         class: public\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "staging-issuer",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#staging-issuer",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Staging issuer"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "apiVersion: cert-manager.io/v1\r\nkind: ClusterIssuer\r\nmetadata:\r\n name: lets-encrypt-staging\r\nspec:\r\n acme:\r\n   server: https://acme-staging-v02.api.letsencrypt.org/directory\r\n   email: username@yourdomain.com # Change the email here\r\n   privateKeySecretRef:\r\n     name: lets-encrypt-staging\r\n   solvers:\r\n   - http01:\r\n       ingress:\r\n         class:  public\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "setup-nginx",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#setup-nginx",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Setup nginx"]
    }), "\n", _jsxs(_components.h3, {
      id: "what-is-ingress",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#what-is-ingress",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "What is Ingress"]
    }), "\n", _jsx(_components.p, {
      children: "Ingress exposes HTTP and HTTPS routes from outside the cluster to services within the cluster. Traffic routing is controlled by rules defined on the Ingress resource. An Ingress may be configured to give Services externally-reachable URLs, load balance traffic, terminate SSL / TLS, and offer name-based virtual hosting. An Ingress controller is responsible for fulfilling the Ingress, usually with a load balancer, though it may also configure your edge router or additional frontends to help handle the traffic."
    }), "\n", _jsxs(_components.p, {
      children: ["We are going to use ", _jsx(_components.a, {
        href: "https://kubernetes.github.io/ingress-nginx/",
        children: "NGINX Ingress Controller"
      }), " which comes as an addon for the microk8s."]
    }), "\n", _jsxs(_components.h3, {
      id: "enable-ingress",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#enable-ingress",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Enable Ingress"]
    }), "\n", _jsxs(_components.p, {
      children: ["The first step is to make sure the addon is enabled. To verify the that just run the ", _jsx(_components.code, {
        children: "status"
      }), " command."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s status\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Make sure ", _jsx(_components.code, {
        children: "ingress"
      }), " is inside the enabled section."]
    }), "\n", _jsx(_components.p, {
      children: "If it is not available in the enabled section. then, run the following command to enable it."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s enable ingress\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will enable the ingress in microk8s."
    }), "\n", _jsxs(_components.h2, {
      id: "testing-ingress-and-cert-manager",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#testing-ingress-and-cert-manager",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Testing Ingress and cert-manager"]
    }), "\n", _jsxs(_components.p, {
      children: ["Now, we have our ", _jsx(_components.code, {
        children: "ingress"
      }), " and ", _jsx(_components.code, {
        children: "cert-manager"
      }), " enabled. lets test these with deploying a simple ", _jsx(_components.code, {
        children: "whoami"
      }), " application."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "kind: Deployment\r\napiVersion: apps/v1\r\nmetadata:\r\n  name: whoami\r\n  labels:\r\n    app: traefiklabs\r\n    name: whoami\r\n\r\nspec:\r\n  replicas: 1\r\n  selector:\r\n    matchLabels:\r\n      app: traefiklabs\r\n      task: whoami\r\n  template:\r\n    metadata:\r\n      labels:\r\n        app: traefiklabs\r\n        task: whoami\r\n    spec:\r\n      containers:\r\n        - name: whoami\r\n          image: traefik/whoami\r\n          ports:\r\n            - containerPort: 80\r\n          resources:\r\n            requests:\r\n              memory: \"100Mi\"\r\n              cpu: \"250m\"\r\n            limits:\r\n              memory: \"200Mi\"\r\n              cpu: \"500m\"\r\n\r\n---\r\napiVersion: v1\r\nkind: Service\r\nmetadata:\r\n  name: whoami-service\r\nspec:\r\n  ports:\r\n    - name: http\r\n      port: 80\r\n  selector:\r\n    app: traefiklabs\r\n    task: whoami\r\n---\r\napiVersion: networking.k8s.io/v1\r\nkind: Ingress\r\nmetadata:\r\n  name: http-ingress-whoami\r\n  annotations:\r\n    cert-manager.io/cluster-issuer: \"lets-encrypt\"\r\n    kubernetes.io/ingress.class: \"public\"\r\nspec:\r\n  tls:\r\n    - hosts:\r\n      -  whoami.kdev.antosubash.com\r\n      secretName: whoami-tls\r\n  rules:\r\n  - host: \"whoami.kdev.antosubash.com\"\r\n    http:\r\n      paths:\r\n      - path: /\r\n        pathType: Prefix\r\n        backend:\r\n          service: \r\n            name: whoami-service\r\n            port: \r\n              number: 80\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["you can also find this file in the repo ", _jsx(_components.a, {
        href: "https://github.com/antosubash/microk8s-hetzner-deployment/blob/main/whoami/whoami.yaml",
        children: "here"
      })]
    }), "\n", _jsxs(_components.h3, {
      id: "deploy",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#deploy",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Deploy"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will use the ", _jsx(_components.code, {
        children: "kubectl"
      }), " to deploy this application."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "kubectl apply -f whoami.yaml\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "conclusion",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#conclusion",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Conclusion"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we enabled and configured two addons of microk8s. its cert-manager and ingress and to test these addons we also deployed a sample app. In the next post we will see how to deploy registry and postgres database."
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/deploy-docker-registry-and-postgres-database-in-micro-k8s",
        children: "Part 3. Deploy docker registry and postgres database in MicroK8s"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Setup MicroK8s With Ubuntu</title>
          <link>https://blog.antosubash.com/posts/setup-micro-k8s-with-ubuntu</link>
          <guid>https://blog.antosubash.com/posts/setup-micro-k8s-with-ubuntu</guid>
          <pubDate>Wed, 14 Sep 2022 19:50:03 GMT</pubDate>
          <description>In this post we will see how to setup microk8s in ubuntu server.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    h3: "h3",
    ul: "ul",
    li: "li",
    img: "img",
    code: "code",
    pre: "pre"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "introduction",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#introduction",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Introduction"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to create a single node kubernetes cluster using microk8s. We will use hetzner cloud to create the server and install ubuntu server on it. We will then install microk8s and connect to the cluster using kubectl."
    }), "\n", _jsxs(_components.h2, {
      id: "parts",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#parts",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Parts"]
    }), "\n", _jsx(_components.p, {
      children: "Part 1. Setup MicroK8s With Ubuntu (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/setup-nginx-and-cert-manager-in-micro-k8s",
        children: "Part 2. Setup Nginx and cert-manager in MicroK8s"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/deploy-docker-registry-and-postgres-database-in-micro-k8s",
        children: "Part 3. Deploy docker registry and postgres database in MicroK8s"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/create-and-deploy-dotnet-application-in-micro-k8s",
        children: "Part 4. Create and deploy .Net application in MicroK8s"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "creating-the-ubuntu-server",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#creating-the-ubuntu-server",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Creating the Ubuntu Server"]
    }), "\n", _jsxs(_components.h3, {
      id: "prerequisites",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#prerequisites",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Prerequisites"]
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsx(_components.li, {
        children: "Hetzner Account"
      }), "\n"]
    }), "\n", _jsxs(_components.p, {
      children: ["I'm going to use hetzner cloud to create this machine if you don't have one then you can use the referral link ", _jsx(_components.a, {
        href: "here",
        children: "https://hetzner.cloud/?ref=ENhA4rCZ5JUM"
      }), " and get 20€ for free to try it out."]
    }), "\n", _jsxs(_components.h3, {
      id: "creating-a-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#creating-a-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Creating a project"]
    }), "\n", _jsx(_components.p, {
      children: "Once you have the hetzner account. login and create a project."
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/microk8s/microk8s1.gif",
        alt: "Create Project"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "setup-ssh",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#setup-ssh",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Setup SSH"]
    }), "\n", _jsx(_components.p, {
      children: "The first step in the project is to SSH for the project."
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/microk8s/microk8s2.gif",
        alt: "SSH key"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "setup-firewall",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#setup-firewall",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Setup Firewall"]
    }), "\n", _jsx(_components.p, {
      children: "Now lets setup the firewall for our server."
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/microk8s/microk8s3.gif",
        alt: "Firewall"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "create-server-with-firewall-and-ssh-key",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-server-with-firewall-and-ssh-key",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create server with firewall and ssh key"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/microk8s/microk8s4.gif",
        alt: "Create server"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "add-dns-entry",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-dns-entry",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add DNS entry"]
    }), "\n", _jsx(_components.p, {
      children: "Now you have to add a DNS entry for your newly created machine. you can fine the the IP address of the machine in the Hetzner server page."
    }), "\n", _jsxs(_components.p, {
      children: ["We need to add ", _jsx(_components.code, {
        children: "A"
      }), " record and a ", _jsx(_components.code, {
        children: "CNAME"
      }), " record."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "A XX.XX.XX.XX yourdomain.com\r\nCNAME * yourdomain.com\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "For example this is how my sample entry looks like"
    }), "\n", _jsx(_components.p, {
      children: "Record      Host        Value\r\nA           youtube1    95.217.191.119\r\nCNAME       *           kdev1.antosubash.com"
    }), "\n", _jsx(_components.p, {
      children: "This might take some time to reflect so wait for a while to verify it."
    }), "\n", _jsxs(_components.h2, {
      id: "verify-dns-entry",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#verify-dns-entry",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Verify DNS entry"]
    }), "\n", _jsx(_components.p, {
      children: "To verify dns entry we will use a tool called dig."
    }), "\n", _jsx(_components.p, {
      children: "you can find it here https://toolbox.googleapps.com/apps/dig/#A/"
    }), "\n", _jsx(_components.p, {
      children: "Make sure your domain is pointing to your ip and your subdomain is pointing to your domain"
    }), "\n", _jsx(_components.p, {
      children: "yourdomain.com -> XX.XX.XX.XX\r\nsubdomain.yourdomain.com -> XX.XX.XX.XX"
    }), "\n", _jsx(_components.p, {
      children: "So both your domain and subdomain should point to the same IP Which is the IP of the machine we just created."
    }), "\n", _jsxs(_components.h2, {
      id: "update-ssh-config",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-ssh-config",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update ssh config"]
    }), "\n", _jsx(_components.p, {
      children: "ssh config file can be \"~/.ssh/config\""
    }), "\n", _jsx(_components.p, {
      children: "In the config file add a entry for the newly created server."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Host kdev1.yourdomain.com\r\n   IdentitiesOnly yes\r\n   IdentityFile ~/.ssh/yournewlycreatedkey # Not the pub file\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-server",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-server",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the server"]
    }), "\n", _jsx(_components.p, {
      children: "Run the following command to update the server"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "sudo apt update\r\nsudo apt upgrade\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "install-snapd-daemon",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-snapd-daemon",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install Snapd daemon"]
    }), "\n", _jsx(_components.p, {
      children: "We will use the snap to microk8s. so we will install the snapd first."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "sudo apt install snapd\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "once the it is installed verify it by checking the version"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "snap version\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "install-microk8s",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-microk8s",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install MicroK8s"]
    }), "\n", _jsxs(_components.p, {
      children: ["The current version of the kubernetes is 1.25 so we are using the following command. To verify the current version take a look at ", _jsx(_components.a, {
        href: "https://microk8s.io/docs/getting-started",
        children: "https://microk8s.io/docs/getting-started"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "sudo snap install microk8s --classic --channel=1.25\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "join-the-group",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#join-the-group",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Join the group"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "sudo usermod -a -G microk8s $USER\r\n\r\nsudo chown -f -R $USER ~/.kube\r\n\r\nsu - $USER\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "check-the-status",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#check-the-status",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Check the status"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s status --wait-ready\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "access-kubernetes",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#access-kubernetes",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Access Kubernetes"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s kubectl get nodes\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "create-alias",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-alias",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create alias"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "alias kubectl='microk8s kubectl'\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "view-cluster-info",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#view-cluster-info",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "View Cluster Info"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "kubectl cluster-info\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "view-kube-config",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#view-kube-config",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "View Kube config"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s config\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This config which is displayed here is the one we will use to connect to the cluster. copy it and configure your kubectl in your machine."
    }), "\n", _jsxs(_components.p, {
      children: ["If you want to know how to install ", _jsx(_components.code, {
        children: "kubectl"
      }), " look here https://kubernetes.io/docs/tasks/tools/"]
    }), "\n", _jsxs(_components.h2, {
      id: "enable-addons",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#enable-addons",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Enable addons"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s enable dns ingress prometheus cert-manager hostpath-storage\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "verify-addons",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#verify-addons",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Verify addons"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s kubectl get all --all-namespaces\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-setup-script",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-setup-script",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a setup script"]
    }), "\n", _jsx(_components.p, {
      children: "you can create a setup script to automate the setup process. I have created a setup script which you can find below. this script will install the microk8s and enable the addons."
    }), "\n", _jsxs(_components.p, {
      children: ["let's create a file called ", _jsx(_components.code, {
        children: "setup.sh"
      }), " and add the following content."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "sudo nano setup.sh\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "lets set the permissions for the script"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "sudo chmod +x setup.sh\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now we have the file and the permissions. lets add the following content to the file."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "#!/bin/bash\r\nsudo apt update\r\nsudo apt upgrade\r\nsudo apt install snapd -y\r\nsnap version\r\nsudo snap install microk8s --classic --channel=1.25\r\nsudo usermod -a -G microk8s $USER\r\nsudo chown -f -R $USER ~/.kube\r\nsu - $USER\r\nmicrok8s status --wait-ready\r\nalias kubectl='microk8s kubectl'\r\nkubectl cluster-info\r\nmicrok8s enable dns ingress prometheus cert-manager hostpath-storage\r\nmicrok8s kubectl get all --all-namespaces\r\nmicrok8s kubectl get nodes\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "run-the-setup-script",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-the-setup-script",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run the setup script"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "sudo bash setup.sh\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "this will take some time to complete. once it is completed you can verify the status of the cluster by running the following command."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s status\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "access-the-cluster",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#access-the-cluster",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Access the cluster"]
    }), "\n", _jsxs(_components.p, {
      children: ["To access the cluster we will use the ", _jsx(_components.code, {
        children: "kubectl"
      }), " command. you can find the installation guide for kubectl ", _jsx(_components.a, {
        href: "https://kubernetes.io/docs/tasks/tools/",
        children: "here"
      })]
    }), "\n", _jsx(_components.p, {
      children: "Once you have the kubectl installed you can run the following command to access the cluster."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "microk8s config > ~/.kube/config\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["you can copy the content of the config file and paste it in your ", _jsx(_components.code, {
        children: "~/.kube/config"
      }), " file."]
    }), "\n", _jsxs(_components.h2, {
      id: "using-lens-to-access-the-cluster",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#using-lens-to-access-the-cluster",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Using Lens to access the cluster"]
    }), "\n", _jsxs(_components.p, {
      children: ["Lens is a tool to access the kubernetes cluster. you can find the installation guide ", _jsx(_components.a, {
        href: "https://k8slens.dev/",
        children: "here"
      }), ". once you have installed the lens you can add the cluster by clicking the ", _jsx(_components.code, {
        children: "+"
      }), " button. and paste the config file in the ", _jsx(_components.code, {
        children: "kubeconfig"
      }), " field and click the ", _jsx(_components.code, {
        children: "connect"
      }), " button."]
    }), "\n", _jsxs(_components.h2, {
      id: "prepare-the-terminal-with-oh-my-zsh",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#prepare-the-terminal-with-oh-my-zsh",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Prepare the terminal with oh-my-zsh"]
    }), "\n", _jsxs(_components.p, {
      children: ["I am using the oh-my-zsh to prepare my terminal. you can find the installation guide ", _jsx(_components.a, {
        href: "https://ohmyz.sh/",
        children: "here"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "install-oh-my-zsh",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-oh-my-zsh",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install oh-my-zsh"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "sudo apt install zsh\r\nsh -c \"$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\"\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "install-autosuggestions-and-syntax-highlighting",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-autosuggestions-and-syntax-highlighting",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install autosuggestions and syntax highlighting"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting\r\ngit clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-zshrc-file",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-zshrc-file",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the .zshrc file"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "nano ~/.zshrc\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "add the following lines to the file"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "plugins=(git kubectl zsh-autosuggestions zsh-syntax-highlighting)\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Also update the theme to ", _jsx(_components.code, {
        children: "agnoster"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "ZSH_THEME=\"agnoster\"\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "add the kubectl alias to the file"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "alias kubectl='microk8s kubectl'\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-terminal",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-terminal",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the terminal"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "source ~/.zshrc\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "conclusion",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#conclusion",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Conclusion"]
    }), "\n", _jsx(_components.p, {
      children: "This is it for this post. We have created a server and installed microk8s and enabled few addons. we have also configured the kubectl to access the cluster. Now we are ready for the next step. In the next step we will see how to setup nginx and cert manager. so that we can deploy our first app."
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/setup-nginx-and-cert-manager-in-micro-k8s",
        children: "Part 2. Setup Nginx and cert-manager in MicroK8s"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>NDepend - A tool you can depend on</title>
          <link>https://blog.antosubash.com/posts/ndepend</link>
          <guid>https://blog.antosubash.com/posts/ndepend</guid>
          <pubDate>Tue, 06 Sep 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to use NDepend to improve your .net development.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    ul: "ul",
    li: "li",
    h3: "h3",
    img: "img",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to use the NDepends to improve you .net development."
    }), "\n", _jsxs(_components.h2, {
      id: "what-is-ndepend",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#what-is-ndepend",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "What is NDepend?"]
    }), "\n", _jsx(_components.p, {
      children: "NDepends is a static analyzer. It analyses your code and help you to improve code quality. It creates a dashboard to view the stats about your project and display most relevant info. It creates a in-depth reports that helps to maintain large complex project. It also helps to enforce coding standards."
    }), "\n", _jsx(_components.p, {
      children: "you can find all the features available here : https://www.ndepend.com/features/"
    }), "\n", _jsxs(_components.h2, {
      id: "benefits-of-using-ndepend",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#benefits-of-using-ndepend",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Benefits of using NDepend"]
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsx(_components.li, {
        children: "Code maintainability"
      }), "\n", _jsx(_components.li, {
        children: "Enforce code rules"
      }), "\n", _jsx(_components.li, {
        children: "View the Impact of code change and trends"
      }), "\n", _jsx(_components.li, {
        children: "Visualize code dependencies"
      }), "\n", _jsx(_components.li, {
        children: "Explore the technical debt"
      }), "\n", _jsx(_components.li, {
        children: "and many more"
      }), "\n"]
    }), "\n", _jsxs(_components.h2, {
      id: "is-it-free",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#is-it-free",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Is it free?"]
    }), "\n", _jsx(_components.p, {
      children: "No. It is a paid product. At the time of the this writing it cost €399 for dev machines. I have received the test license to play around."
    }), "\n", _jsxs(_components.h2, {
      id: "sample-report",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#sample-report",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Sample Report"]
    }), "\n", _jsx(_components.p, {
      children: "Orchard core sample report: https://www.ndepend.com/Sample-Reports/OnOrchadCore/NDependReport.html#Main"
    }), "\n", _jsxs(_components.h2, {
      id: "getting-ndepend",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#getting-ndepend",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Getting NDepend"]
    }), "\n", _jsx(_components.p, {
      children: "you can do download it from here https://www.ndepend.com/download"
    }), "\n", _jsx(_components.p, {
      children: "Here is the install guide https://www.ndepend.com/docs/getting-started-with-ndepend#Part1"
    }), "\n", _jsxs(_components.h2, {
      id: "using-ndepend",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#using-ndepend",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Using NDepend"]
    }), "\n", _jsx(_components.p, {
      children: "For this purpose I will use the Tasky Abp Microservice solution. It is a ABP Microservice application which I have created for a youtube series."
    }), "\n", _jsx(_components.p, {
      children: "The first step is to add NDpend to your solution."
    }), "\n", _jsxs(_components.h3, {
      id: "adding-ndepend",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#adding-ndepend",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Adding NDepend"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/ndepend/ndepend1.png",
        alt: "Adding NDepend"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["As shown in the image adding ", _jsx(_components.code, {
        children: "ndepend"
      }), " to your solution is very easy. once added it will start the analysis of the solution and find all the projects and assemblies of your project. once it is done it will prompt with the list of found assemblies. you might want to ignore some assemblies like test and those can be managed in the next step."]
    }), "\n", _jsxs(_components.h3, {
      id: "start-analysis",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#start-analysis",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Start Analysis"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/ndepend/ndepend2.png",
        alt: "Start Analysis"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["After the clicking the analysis ", _jsx(_components.code, {
        children: "ndepend"
      }), " will start the analysis of your code. it might take a min for it show the dashboard."]
    }), "\n", _jsxs(_components.h3, {
      id: "dashboard",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#dashboard",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Dashboard"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/ndepend/ndepend3.png",
        alt: "Dashboard"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Dashboard is where you will see most of the info about you solution. based on the status of you solution it will create a rating. In my case the rating was ", _jsx(_components.code, {
        children: "B"
      }), " for my tasky microservice solution. It also displays more basic metrics like \"Types\" and \"Line of code\". What I found most interesting is the \"Quality Gates\" and \"Rules\" section of the dashboard. It showed 2 problems I didn't see before in my code and gave me an explanation on why they are bad."]
    }), "\n", _jsx(_components.p, {
      children: "The problems were"
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsx(_components.li, {
        children: "Avoid methods with too many parameters"
      }), "\n"]
    }), "\n", _jsx(_components.p, {
      children: "It was a Identity server seed method which was very big and doing too many things."
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsx(_components.li, {
        children: "Avoid having different types with same name"
      }), "\n"]
    }), "\n", _jsx(_components.p, {
      children: "This was a sample Dto class which I forgot to delete. So, the same type was available in multiple services."
    }), "\n", _jsx(_components.p, {
      children: "This was really helpful. After seeing these problems I was more curious to find out what else was wrong in my solution and I had lots of minor issues. It was a great learning process."
    }), "\n", _jsxs(_components.h3, {
      id: "info-window",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#info-window",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Info Window"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/ndepend/ndepend4.png",
        alt: "Info Window"
      })
    }), "\n", _jsx(_components.p, {
      children: "Info window explains your problem. It show what rules were broken and explain the rule clearly in a simple way. It also shows suggestion on how to fix the problem."
    }), "\n", _jsxs(_components.h3, {
      id: "dependency-graph",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#dependency-graph",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Dependency graph"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/ndepend/ndepend5.png",
        alt: "Dependency graph"
      })
    }), "\n", _jsx(_components.p, {
      children: "This is one thing I wished that VS already had. When I saw the Dependency graph it was easy to understand the structure of the application. This will the first thing I do on any new solution to get the overall view of the solution. This helps to create a memory map of project."
    }), "\n", _jsxs(_components.h3, {
      id: "and-many-more",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#and-many-more",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "And many more"]
    }), "\n", _jsx(_components.p, {
      children: "Once it is added the to the solution it starts to track the trend. the trend can be viewed in the graph. it will help us in improving the codebase. there are many more feature for this tool this is just an introduction of very few benefits."
    }), "\n", _jsxs(_components.h2, {
      id: "final-thoughts",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#final-thoughts",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Final thoughts"]
    }), "\n", _jsxs(_components.p, {
      children: ["If your are managing a large project then a tool like ", _jsx(_components.code, {
        children: "ndepend"
      }), " is very useful. It has good CI/CD integration so we can generate the nice report for every build and monitor the progress. The only problem I had is with the VS Code integration. There is a standalone instance which we can try with VS Code but there is no integration with VS Code. The rules helps you to write code with best practices and make you a better developer. It also helps with consistency in the codebase."]
    }), "\n", _jsxs(_components.p, {
      children: ["Next version of the ", _jsx(_components.code, {
        children: "ndepend"
      }), " will have more integration with Rider and VS Code to open source file declaration and diff source files. but not a full integration. Here is how it will look like."]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/ndepend/ndepend6.png",
        alt: "Dependency graph"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "will-i-buy-it",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#will-i-buy-it",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Will I buy it?"]
    }), "\n", _jsx(_components.p, {
      children: "For a personal project - No"
    }), "\n", _jsx(_components.p, {
      children: "For a Commercial project - Yes, for sure."
    }), "\n", _jsx(_components.p, {
      children: "399 Euro is bit on the expensive side for me to buy it for using it on the hobby project. on the other hand I will buy it for me and my team at work. When you compare the cost and benefit it provides at work. it is worth every penny. hope this helps."
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Docker Deployment using docker swarm</title>
          <link>https://blog.antosubash.com/posts/docker-swarm-hetzner</link>
          <guid>https://blog.antosubash.com/posts/docker-swarm-hetzner</guid>
          <pubDate>Sun, 31 Jul 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to setup docker swarm for your development environment.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    ul: "ul",
    li: "li"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "state-is-docker-swarm",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#state-is-docker-swarm",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "State is Docker swarm"]
    }), "\n", _jsx(_components.p, {
      children: "The state of docker swarm is a big question for a while now. I have been a docker swarm user for a while and I really like the simplicity of it. But it seems like there is no major development taking place and the only alternative seems to be kubernetes which is quite complex compare to docker swarm. the main take away is that the future of docker swarm is uncertain."
    }), "\n", _jsxs(_components.h2, {
      id: "why-use-docker-swarm",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#why-use-docker-swarm",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Why use docker swarm"]
    }), "\n", _jsxs(_components.p, {
      children: ["Docker include swarm mode for natively managing a cluster of Docker Engines called a swarm. It is very simple to manage multiple docker nodes and create a cluster. It provides a basic cluster management, networking, service discovery and many more. you can find the full list of features ", _jsx(_components.a, {
        href: "https://docs.docker.com/engine/swarm/#feature-highlights",
        children: "here"
      }), ". For my personal use I don't want to use the complex kubernetes cluster. If you are looking for simple easy to use docker deployment then docker swarm is the best option I can find."]
    }), "\n", _jsxs(_components.h2, {
      id: "how-much-does-it-cost",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#how-much-does-it-cost",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "How much does it cost?"]
    }), "\n", _jsxs(_components.p, {
      children: ["Main goal of this series is to make sure the cost is low. So, the cost will be less than 15€ or 15$. I'm going to use hetzner cloud and you can use the referral link ", _jsx(_components.a, {
        href: "https://hetzner.cloud/?ref=ENhA4rCZ5JUM",
        children: "here"
      }), " and get 20€ for free to try it out."]
    }), "\n", _jsxs(_components.h2, {
      id: "what-are-the-goals",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#what-are-the-goals",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "What are the goals"]
    }), "\n", _jsx(_components.p, {
      children: "The goals are as follows"
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsx(_components.li, {
        children: "Secure the machine properly with proper firewall setup and ssh"
      }), "\n", _jsx(_components.li, {
        children: "Reverse proxy to redirect traffic to containers (traefik)"
      }), "\n", _jsx(_components.li, {
        children: "Deploy Redis, postgres, rabbitmq, registry"
      }), "\n", _jsx(_components.li, {
        children: "Interface for container management (portainer)"
      }), "\n", _jsx(_components.li, {
        children: "Deploy tasky microservice"
      }), "\n"]
    }), "\n", _jsxs(_components.h2, {
      id: "parts",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#parts",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Parts"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/part-1-setup-docker-with-ubuntu-server-in-hetzner",
        children: "Part 1. Setting up Ubuntu Server with docker in Hetzner"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/part-2-setup-docker-swarm-with-traefik-and-portainer",
        children: "Part 2. Setting up docker swarm with traefik and portainer"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/part-3-deploy-registry-redis-rabitmq-postgresql-in-docker",
        children: "Part 3. Deploy redis, rabbitmq, seq, registry and postgres in docker swarm"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/part-4-prepare-and-deploy-microservice-in-docker",
        children: "Part 4. Deploy the microservice in docker swarm"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Prepare and deploy the microservice</title>
          <link>https://blog.antosubash.com/posts/part-4-prepare-and-deploy-microservice-in-docker</link>
          <guid>https://blog.antosubash.com/posts/part-4-prepare-and-deploy-microservice-in-docker</guid>
          <pubDate>Sat, 30 Jul 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to deploy the microservice solution to the our server.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    pre: "pre",
    code: "code",
    h3: "h3"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/part-1-setup-docker-with-ubuntu-server-in-hetzner",
        children: "Part 1. Setting up Ubuntu Server with docker in Hetzner"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/part-2-setup-docker-swarm-with-traefik-and-portainer",
        children: "Part 2. Setting up docker swarm with traefik and portainer"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/part-3-deploy-registry-redis-rabitmq-postgresql-in-docker",
        children: "Part 3. Deploy redis, rabbitmq, seq, registry and postgres in docker swarm"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 4. Prepare and deploy the microservice for deployment (this post)"
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsxs(_components.p, {
      children: ["In this post we will prepare the microservice project for deployment and deploy it to the docker swarm. I'm going to use this ", _jsx(_components.a, {
        href: "/posts/abp-microservice-series",
        children: "Sample microservice application"
      }), " you can find the repo ", _jsx(_components.a, {
        href: "https://github.com/antosubash/Tasky",
        children: "here"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-github-actions",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-github-actions",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the github actions"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "name: Docker Image CI\r\n\r\non:\r\n  push:\r\n    branches: [ main ]\r\n\r\njobs:\r\n\r\n  build:\r\n\r\n    runs-on: ubuntu-latest\r\n\r\n    steps:\r\n    - name: Docker Login\r\n      # You may pin to the exact commit or the version.\r\n      # uses: docker/login-action@dd4fa0671be5250ee6f50aedf4cb05514abda2c7\r\n      uses: docker/login-action@v1.14.1\r\n      with:\r\n        # Server address of Docker registry. If not set then will default to Docker Hub\r\n        registry: registry.yourdomain.com\r\n        # Username used to log against the Docker registry\r\n        username: ${{ secrets.REGISTRY_USERNAME }}\r\n        # Password or personal access token used to log against the Docker registry\r\n        password: ${{ secrets.REGISTRY_PASSWORD }}\r\n    - uses: actions/checkout@v2\r\n    - name: Build the Gateway Docker image\r\n      run: docker build . --file gateway/Tasky.Gateway/Dockerfile --tag gateway:dev\r\n    - name: Docker tag images\r\n      run: docker tag gateway:dev registry.yourdomain.com/gateway:dev\r\n    - name: Push Gateway image\r\n      run: docker push registry.yourdomain.com/gateway:dev\r\n      \r\n    - name: Build the IdentityServer Docker image\r\n      run: docker build . --file apps/Tasky.IdentityServer/Dockerfile --tag identityserver:dev\r\n    - name: Docker tag IdentityServer images\r\n      run: docker tag identityserver:dev registry.yourdomain.com/identityserver:dev\r\n    - name: Push IdentityServer image\r\n      run: docker push registry.yourdomain.com/identityserver:dev\r\n  \r\n    - name: Build the Administration Docker image\r\n      run: docker build . --file services/administration/host/Tasky.Administration.HttpApi.Host/Dockerfile --tag administration:dev\r\n    - name: Docker tag Administration images\r\n      run: docker tag administration:dev registry.yourdomain.com/administration:dev\r\n    - name: Push Administration image\r\n      run: docker push registry.yourdomain.com/administration:dev\r\n      \r\n    - name: Build the IdentityService Docker image\r\n      run: docker build . --file services/identity/host/Tasky.IdentityService.HttpApi.Host/Dockerfile --tag identityservice:dev\r\n    - name: Docker tag identityservice images\r\n      run: docker tag identityservice:dev registry.yourdomain.com/identityservice:dev\r\n    - name: Push IdentityService image\r\n      run: docker push registry.yourdomain.com/identityservice:dev\r\n    \r\n    - name: Build the SaaS Docker image\r\n      run: docker build . --file services/saas/host/Tasky.SaaS.HttpApi.Host/Dockerfile --tag saas:dev\r\n    - name: Docker tag SaaS images\r\n      run: docker tag saas:dev registry.yourdomain.com/saas:dev\r\n    - name: Push SaaS image\r\n      run: docker push registry.yourdomain.com/saas:dev\r\n\r\n    - name: Build the DbMigrator Docker image\r\n      run: docker build . --file shared/Tasky.DbMigrator/Dockerfile --tag migrator:dev\r\n    - name: Docker tag DbMigrator images\r\n      run: docker tag migrator:dev registry.yourdomain.com/migrator:dev\r\n    - name: Push DbMigrator image\r\n      run: docker push registry.yourdomain.com/migrator:dev\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: [_jsx(_components.code, {
        children: "secrets.REGISTRY_USERNAME"
      }), " and ", _jsx(_components.code, {
        children: "secrets.REGISTRY_PASSWORD"
      }), " are coming from the repository secrets."]
    }), "\n", _jsxs(_components.h2, {
      id: "create-docker-compose",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-docker-compose",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create docker compose"]
    }), "\n", _jsxs(_components.h3, {
      id: "migrator",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#migrator",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Migrator"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "version: '3.4'\r\n\r\nservices:\r\n  dbmigrator:\r\n    image: registry.antosubash.com/migrator:dev\r\n    environment:\r\n      ConnectionStrings__SaaSService: \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskySaaSService;Pooling=false;\"\r\n      ConnectionStrings__IdentityService: \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyIdentityService;Pooling=false;\"\r\n      ConnectionStrings__AdministrationService : \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyAdministrationService;Pooling=false;\"\r\n      ConnectionStrings__ProjectService : \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyProjectService;Pooling=false;\"\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "tasky-services-compose",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#tasky-services-compose",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Tasky Services Compose"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "version: '3.4'\r\n\r\nservices:\r\n  identityserver:\r\n    image: registry.youtube.antosubash.com/identityserver:dev\r\n    networks:\r\n      - traefik-public\r\n    environment:\r\n      App__SelfUrl: \"https://id.tasky.youtube.antosubash.com\"\r\n      App__ClientUrl: \"https://app.tasky.youtube.antosubash.com,https://gw.tasky.youtube.antosubash.com\"\r\n      App__CorsOrigins: \"https://app.tasky.youtube.antosubash.com,https://gw.tasky.youtube.antosubash.com\"\r\n      App__RedirectAllowedUrls: \"https://app.tasky.youtube.antosubash.com,https://gw.tasky.youtube.antosubash.com\"\r\n      ConnectionStrings__SaaSService: \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskySaaSService;Pooling=false;\"\r\n      ConnectionStrings__IdentityService: \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyIdentityService;Pooling=false;\"\r\n      ConnectionStrings__AdministrationService : \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyAdministrationService;Pooling=false;\"\r\n      ConnectionStrings__ProjectService : \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyProjectService;Pooling=false;\"\r\n      Redis__Configuration : \"10.0.0.2:6379,password=my_master_password\"\r\n      RabbitMQ__Connections__Default__HostName : \"10.0.0.2\"\r\n      RabbitMQ__Connections__EventBus__ClientName : \"TaskyIdentityService\"\r\n      RabbitMQ__Connections__EventBus__ExchangeName : \"Tasky\"\r\n      Serilog__WriteTo__[0]__Name : \"Seq\"\r\n      Serilog__WriteTo__[0]__Args__serverUrl : \"https://seq.youtube.antosubash.com\"\r\n    deploy:\r\n      labels:\r\n        - \"traefik.enable=true\"\r\n        - \"traefik.http.routers.identityserver.rule=Host(`id.tasky.youtube.antosubash.com`)\"\r\n        - \"traefik.http.services.identityserver.loadbalancer.server.port=80\"\r\n        - \"traefik.http.routers.identityserver.entrypoints=websecure\"\r\n        - \"traefik.http.routers.identityserver.tls=true\"\r\n        - \"traefik.http.routers.identityserver.tls.certresolver=leresolver\"\r\n\r\n  gateway:\r\n    image: registry.youtube.antosubash.com/gateway:dev\r\n    networks:\r\n      - traefik-public\r\n    environment:\r\n      ReverseProxy__Clusters__main__Destinations__main__Address : \"http://10.0.0.2:7001\"\r\n      ReverseProxy__Clusters__identity__Destinations__identity__Address : \"http://10.0.0.2:7002\"\r\n      ReverseProxy__Clusters__account__Destinations__account__Address : \"http://10.0.0.2:7002\"\r\n      ReverseProxy__Clusters__saas__Destinations__saas__Address : \"http://10.0.0.2:7003\"\r\n      ReverseProxy__Clusters__project__Destinations__project__Address : \"http://10.0.0.2:7004\"\r\n      Serilog__WriteTo__[0]__Name : \"Seq\"\r\n      Serilog__WriteTo__[0]__Args__serverUrl : \"https://seq.youtube.antosubash.com\"\r\n    deploy:\r\n      labels:\r\n        - \"traefik.enable=true\"\r\n        - \"traefik.http.routers.gateway.rule=Host(`gw.tasky.youtube.antosubash.com`)\"\r\n        - \"traefik.http.services.gateway.loadbalancer.server.port=80\"\r\n        - \"traefik.http.routers.gateway.entrypoints=websecure\"\r\n        - \"traefik.http.routers.gateway.tls=true\"\r\n        - \"traefik.http.routers.gateway.tls.certresolver=leresolver\"\r\n\r\n  administrationservice:\r\n    image: registry.youtube.antosubash.com/administration:dev\r\n    ports:\r\n      - target: 80\r\n        published: 7001\r\n        protocol: tcp\r\n        mode: host\r\n    environment:\r\n      App__CorsOrigins: http://10.0.0.2:7000\r\n      ConnectionStrings__SaaSService: \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskySaaSService;Pooling=false;\"\r\n      ConnectionStrings__IdentityService: \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyIdentityService;Pooling=false;\"\r\n      ConnectionStrings__AdministrationService : \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyAdministrationService;Pooling=false;\"\r\n      ConnectionStrings__ProjectService : \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyProjectService;Pooling=false;\"\r\n      Redis__Configuration : \"10.0.0.2:6379,password=my_master_password\"\r\n      AuthServer__Authority : \"https://id.tasky.youtube.antosubash.com\"\r\n      AuthServer__RequireHttpsMetadata : \"false\"\r\n      AuthServer__SwaggerClientId : \"AdministrationService_Swagger\"\r\n      AuthServer__SwaggerClientSecret : \"1q2w3e*\"\r\n      RabbitMQ__Connections__Default__HostName : \"10.0.0.2\"\r\n      RabbitMQ__Connections__EventBus__ClientName : \"TaskyAdministrationService\"\r\n      RabbitMQ__Connections__EventBus__ExchangeName : \"Tasky\"\r\n      Serilog__WriteTo__[0]__Name : \"Seq\"\r\n      Serilog__WriteTo__[0]__Args__serverUrl : \"https://seq.youtube.antosubash.com\"\r\n\r\n  identityservice:\r\n    image: registry.youtube.antosubash.com/identityservice:dev\r\n    ports:\r\n      - target: 80\r\n        published: 7002\r\n        protocol: tcp\r\n        mode: host\r\n    environment:\r\n      App__CorsOrigins: http://10.0.0.2:7000\r\n      ConnectionStrings__SaaSService: \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskySaaSService;Pooling=false;\"\r\n      ConnectionStrings__IdentityService: \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyIdentityService;Pooling=false;\"\r\n      ConnectionStrings__AdministrationService : \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyAdministrationService;Pooling=false;\"\r\n      ConnectionStrings__ProjectService : \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyProjectService;Pooling=false;\"\r\n      Redis__Configuration : \"10.0.0.2:6379,password=my_master_password\"\r\n      AuthServer__Authority : \"https://id.tasky.youtube.antosubash.com\"\r\n      AuthServer__RequireHttpsMetadata : \"false\"\r\n      AuthServer__SwaggerClientId : \"IdentityService_Swagger\"\r\n      AuthServer__SwaggerClientSecret : \"1q2w3e*\"\r\n      RabbitMQ__Connections__Default__HostName : \"10.0.0.2\"\r\n      RabbitMQ__Connections__EventBus__ClientName : \"TaskyIdentityService\"\r\n      RabbitMQ__Connections__EventBus__ExchangeName : \"Tasky\"\r\n      Serilog__WriteTo__[0]__Name : \"Seq\"\r\n      Serilog__WriteTo__[0]__Args__serverUrl : \"https://seq.youtube.antosubash.com\"\r\n\r\n  saasservice:\r\n    image: registry.youtube.antosubash.com/saas:dev\r\n    ports:\r\n      - target: 80\r\n        published: 7003\r\n        protocol: tcp\r\n        mode: host\r\n    environment:\r\n      App__CorsOrigins: http://10.0.0.2:7000\r\n      ConnectionStrings__SaaSService: \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskySaaSService;Pooling=false;\"\r\n      ConnectionStrings__IdentityService: \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyIdentityService;Pooling=false;\"\r\n      ConnectionStrings__AdministrationService : \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyAdministrationService;Pooling=false;\"\r\n      ConnectionStrings__ProjectService : \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyProjectService;Pooling=false;\"\r\n      Redis__Configuration : \"10.0.0.2:6379,password=my_master_password\"\r\n      AuthServer__Authority : \"https://id.tasky.youtube.antosubash.com\"\r\n      AuthServer__RequireHttpsMetadata : \"false\"\r\n      AuthServer__SwaggerClientId : \"IdentityService_Swagger\"\r\n      AuthServer__SwaggerClientSecret : \"1q2w3e*\"\r\n      RabbitMQ__Connections__Default__HostName : \"10.0.0.2\"\r\n      RabbitMQ__Connections__EventBus__ClientName : \"TaskyIdentityService\"\r\n      RabbitMQ__Connections__EventBus__ExchangeName : \"Tasky\"\r\n      Serilog__WriteTo__[0]__Name : \"Seq\"\r\n      Serilog__WriteTo__[0]__Args__serverUrl : \"https://seq.youtube.antosubash.com\"\r\n\r\n  projectservice:\r\n    image: registry.youtube.antosubash.com/project:dev\r\n    ports:\r\n      - target: 80\r\n        published: 7004\r\n        protocol: tcp\r\n        mode: host\r\n    environment:\r\n      App__CorsOrigins: http://10.0.0.2:7000\r\n      ConnectionStrings__SaaSService: \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskySaaSService;Pooling=false;\"\r\n      ConnectionStrings__IdentityService: \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyIdentityService;Pooling=false;\"\r\n      ConnectionStrings__AdministrationService : \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyAdministrationService;Pooling=false;\"\r\n      ConnectionStrings__ProjectService : \"User ID=postgres;Password=my_postgres_password;Host=10.0.0.2;Port=5432;Database=TaskyProjectService;Pooling=false;\"\r\n      Redis__Configuration : \"10.0.0.2:6379,password=my_master_password\"\r\n      AuthServer__Authority : \"https://id.tasky.youtube.antosubash.com\"\r\n      AuthServer__RequireHttpsMetadata : \"false\"\r\n      AuthServer__SwaggerClientId : \"IdentityService_Swagger\"\r\n      AuthServer__SwaggerClientSecret : \"1q2w3e*\"\r\n      RabbitMQ__Connections__Default__HostName : \"10.0.0.2\"\r\n      RabbitMQ__Connections__EventBus__ClientName : \"TaskyIdentityService\"\r\n      RabbitMQ__Connections__EventBus__ExchangeName : \"Tasky\"\r\n      Serilog__WriteTo__[0]__Name : \"Seq\"\r\n      Serilog__WriteTo__[0]__Args__serverUrl : \"https://seq.youtube.antosubash.com\"\r\n\r\nnetworks:\r\n  traefik-public:\r\n    external: true\n"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Deploy redis, rabbitmq, seq, registry and postgres in docker swarm</title>
          <link>https://blog.antosubash.com/posts/part-3-deploy-registry-redis-rabitmq-postgresql-in-docker</link>
          <guid>https://blog.antosubash.com/posts/part-3-deploy-registry-redis-rabitmq-postgresql-in-docker</guid>
          <pubDate>Tue, 21 Jun 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to deploy redis, rabbitmq, postgres and registry.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    h3: "h3",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/part-1-setup-docker-with-ubuntu-server-in-hetzner",
        children: "Part 1. Setting up Ubuntu Server with docker in Hetzner"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/part-2-setup-docker-swarm-with-traefik-and-portainer",
        children: "Part 2. Setting up docker swarm with traefik and portainer"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 3. Deploy redis, rabbitmq, seq, registry and postgres in docker swarm (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/part-4-prepare-and-deploy-microservice-in-docker",
        children: "Part 4. Deploy the microservice in docker swarm"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to deploy redis, rabbitmq, postgres and registry."
    }), "\n", _jsxs(_components.h2, {
      id: "deploy-docker-registry",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#deploy-docker-registry",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Deploy docker registry"]
    }), "\n", _jsx(_components.p, {
      children: "We will deploy a docker registry"
    }), "\n", _jsxs(_components.h3, {
      id: "create-folder-for-registry-deployment",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-folder-for-registry-deployment",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create folder for registry deployment"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "mkdir /mnt/auth\r\nmkdir /mnt/registry\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Auth folder is for storing the password and registry folder is for storing the images."
    }), "\n", _jsxs(_components.h3, {
      id: "create-password-for-registry",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-password-for-registry",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create password for registry"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "docker run --entrypoint htpasswd httpd:2 -Bbn testuser testpassword\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Copy the output to ", _jsx(_components.code, {
        children: "/mnt/auth/registry.password"
      })]
    }), "\n", _jsxs(_components.h3, {
      id: "registry-docker-compose",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#registry-docker-compose",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Registry docker compose"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "version: '3'\r\n\r\nservices:\r\n  registry:\r\n    image: registry:2\r\n    networks:\r\n      - traefik-public\r\n    environment:\r\n      VIRTUAL_HOST: registry.yourdomain.com\r\n      REGISTRY_AUTH: htpasswd\r\n      REGISTRY_AUTH_HTPASSWD_REALM: Registry Realm\r\n      REGISTRY_AUTH_HTPASSWD_PATH: /auth/registry.password\r\n    volumes:\r\n      - /mnt/auth:/auth\r\n      - /mnt/registry:/var/lib/registry\r\n    deploy:\r\n      labels:\r\n        - \"traefik.enable=true\"\r\n        - \"traefik.http.routers.registry.rule=Host(`registry.yourdomain.com`)\"\r\n        - \"traefik.http.services.registry.loadbalancer.server.port=5000\"\r\n        - \"traefik.http.routers.registry.entrypoints=websecure\"\r\n        - \"traefik.http.routers.registry.tls=true\"\r\n        - \"traefik.http.routers.registry.tls.certresolver=leresolver\"\r\n        \r\nnetworks:\r\n  traefik-public:\r\n    external: true\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "deploy-redis",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#deploy-redis",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Deploy redis"]
    }), "\n", _jsx(_components.p, {
      children: "Redis is an in-memory data structure store, used as a distributed, in-memory key–value database, cache and message broker, with optional durability. Redis supports different kinds of abstract data structures, such as strings, lists, maps, sets, sorted sets, HyperLogLogs, bitmaps, streams, and spatial indices."
    }), "\n", _jsxs(_components.h3, {
      id: "create-folder-for-redis-deployment",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-folder-for-redis-deployment",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create folder for redis deployment"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "mkdir /mnt/redis\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "redis-docker-compose",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#redis-docker-compose",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Redis docker compose"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "version: \"3\"\r\n  \r\nservices:\r\n  redis-master:\r\n    image: \"bitnami/redis:latest\"\r\n    ports:\r\n      - \"6379:6379\"\r\n    environment:\r\n      - REDIS_REPLICATION_MODE=master\r\n      - REDIS_PASSWORD=my_master_password\r\n    volumes:\r\n      - '/mnt/redis:/bitnami'\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "deploy-postgres",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#deploy-postgres",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Deploy postgres"]
    }), "\n", _jsx(_components.p, {
      children: "PostgreSQL, also known as Postgres, is a free and open-source relational database management system emphasizing extensibility and SQL compliance."
    }), "\n", _jsxs(_components.h3, {
      id: "create-folder-for-postgres-deployment",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-folder-for-postgres-deployment",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create folder for postgres deployment"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "mkdir /mnt/postgres\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "postgres-docker-compose",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#postgres-docker-compose",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Postgres docker compose"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "version: \"3.2\"\r\n\r\nservices:\r\n  postgres:\r\n    image: kartoza/postgis:12.0\r\n    ports:\r\n      - 5432:5432\r\n    volumes:\r\n      - /mnt/postgres:/var/lib/postgresql\r\n    environment:\r\n      POSTGRES_DB: test\r\n      POSTGRES_USER: postgres\r\n      POSTGRES_PASS: my_postgres_password\r\n      --auth: \"md5\"\r\n      POSTGRES_MULTIPLE_EXTENSIONS: postgis,hstore,postgis_topology\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "deploy-rabbitmq",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#deploy-rabbitmq",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Deploy rabbitmq"]
    }), "\n", _jsx(_components.p, {
      children: "RabbitMQ is an open-source message-broker Software that originally implemented the Advanced Message Queuing Protocol and has since been extended with a plug-in architecture to support Streaming Text Oriented Messaging Protocol, MQ Telemetry Transport, and other protocols."
    }), "\n", _jsxs(_components.h3, {
      id: "rabbitmq-docker-compose",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#rabbitmq-docker-compose",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "rabbitmq docker compose"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "version: '3.7'\r\n\r\nservices:\r\n  rabbitmq:\r\n    container_name: rabbitmq\r\n    image: rabbitmq:management-alpine\r\n    ports:\r\n      - \"15672:15672\"\r\n      - \"5672:5672\"\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "deploy-seq",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#deploy-seq",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Deploy seq"]
    }), "\n", _jsx(_components.p, {
      children: "Seq is the intelligent search, Analysis, and alerting server built specifically for modern structured log data."
    }), "\n", _jsxs(_components.h3, {
      id: "create-folder-for-seq-deployment",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-folder-for-seq-deployment",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create folder for seq deployment"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "mkdir /mnt/seq\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "seq-docker-compose",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#seq-docker-compose",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "seq docker compose"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "version: '3'\r\n\r\nservices:\r\n  seq:\r\n    image: datalust/seq\r\n    networks:\r\n      - traefik-public\r\n    environment:\r\n      ACCEPT_EULA: \"Y\"\r\n    volumes:\r\n      - /mnt/seq:/data\r\n    deploy:\r\n      labels:\r\n        - \"traefik.enable=true\"\r\n        - \"traefik.http.routers.seq.rule=Host(`seq.yourdomain.com`)\"\r\n        - \"traefik.http.services.seq.loadbalancer.server.port=80\"\r\n        - \"traefik.http.routers.seq.entrypoints=websecure\"\r\n        - \"traefik.http.routers.seq.tls=true\"\r\n        - \"traefik.http.routers.seq.tls.certresolver=leresolver\"\r\n        \r\nnetworks:\r\n  traefik-public:\r\n    external: true\n"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Setting up docker swarm with traefik and portainer</title>
          <link>https://blog.antosubash.com/posts/part-2-setup-docker-swarm-with-traefik-and-portainer</link>
          <guid>https://blog.antosubash.com/posts/part-2-setup-docker-swarm-with-traefik-and-portainer</guid>
          <pubDate>Mon, 20 Jun 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to create a docker swarm and deploy traefik and portainer in our ubuntu server.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    pre: "pre",
    code: "code",
    h3: "h3"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/part-1-setup-docker-with-ubuntu-server-in-hetzner",
        children: "Part 1. Setting up Ubuntu Server with docker in Hetzner"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 2. Setting up docker swarm with traefik and portainer (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/part-3-deploy-registry-redis-rabitmq-postgresql-in-docker",
        children: "Part 3. Deploy redis, rabbitmq, seq, registry and postgres in docker swarm"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/part-4-prepare-and-deploy-microservice-in-docker",
        children: "Part 4. Deploy the microservice in docker swarm"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to create a docker swarm and deploy traefik and portainer in our ubuntu server."
    }), "\n", _jsxs(_components.h2, {
      id: "what-is-traefik",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#what-is-traefik",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "What is traefik?"]
    }), "\n", _jsx(_components.p, {
      children: "Traefik is a leading modern reverse proxy and load balancer that makes deploying microservices easy. Traefik integrates with your existing infrastructure components and configures itself automatically and dynamically."
    }), "\n", _jsx(_components.p, {
      children: "For more info visit : https://traefik.io/traefik"
    }), "\n", _jsxs(_components.h2, {
      id: "what-is-portainer",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#what-is-portainer",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "What is portainer?"]
    }), "\n", _jsx(_components.p, {
      children: "Portainer is the definitive container management tool for Docker, Docker Swarm with it's highly intuitive GUI and API. Portainer is a fully featured management tool for Docker. It runs locally, giving developers a rich UI to build and publish container images, deploy and manage applications and leverage data persistence and horizontal scaling for their applications. And, once an application is deployed into a container, Portainer makes it easy for users to secure, monitor and measure the performance of the platform. The tool negates the need for developers to learn Infrastructure as Code and makes it easy for them to maximize their efficiency which means both users and organizations love it."
    }), "\n", _jsx(_components.p, {
      children: "For more info visit: https://www.portainer.io/"
    }), "\n", _jsxs(_components.h2, {
      id: "what-is-docker-swarm",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#what-is-docker-swarm",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "What is Docker Swarm?"]
    }), "\n", _jsx(_components.p, {
      children: "Docker swarm is a container orchestration tool, meaning that it allows the user to manage multiple containers deployed across multiple host machines. One of the key benefits associated with the operation of a docker swarm is the high level of availability offered for applications."
    }), "\n", _jsx(_components.p, {
      children: "For more info: https://docs.docker.com/engine/swarm/"
    }), "\n", _jsxs(_components.h2, {
      id: "init-docker-swarm",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#init-docker-swarm",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Init Docker Swarm"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "docker swarm init --advertise-addr 10.0.0.3 # change the ip here with your machine ip\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will initialize docker in swarm mode and also display a join token for the other machines to join the cluster."
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-traefik-network",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-traefik-network",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a traefik network"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "docker network create --driver overlay traefik-public \n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This is our primary network for the traefik."
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-htpasswd-password",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-htpasswd-password",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a htpasswd password"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "docker run --rm httpd:2.4-alpine htpasswd -nbB admin <password> | cut -d \":\" -f 2\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Escape the $ sign in the password by adding one more $ to the generated password. We need this password to protect our end point in the traefik proxy."
    }), "\n", _jsxs(_components.h2, {
      id: "create-folders",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-folders",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create folders"]
    }), "\n", _jsxs(_components.h3, {
      id: "for-traefik",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#for-traefik",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "for Traefik"]
    }), "\n", _jsx(_components.p, {
      children: "create a folder and set 600 as permission."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "mkdir /mnt/data\r\nmkdir /mnt/data/traefik\r\ntouch /mnt/data/traefik/acme.json\r\nchmod 600 /mnt/data/traefik/acme.json\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "for-portainer",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#for-portainer",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "for Portainer"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "mkdir /mnt/data/portainer\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "traefik-docker-compose",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#traefik-docker-compose",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Traefik docker compose"]
    }), "\n", _jsx(_components.p, {
      children: "Traefik is our main reverse proxy and it will sit in front of all out application. we will control all the routes to our containers using traefik."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "version: \"3.3\"\r\n\r\nservices:\r\n  traefik:\r\n    image: \"traefik:v2.1.4\"\r\n    command:\r\n      - --log.level=INFO\r\n      - --entrypoints.web.address=:80\r\n      - --entrypoints.websecure.address=:443\r\n      - --providers.docker\r\n      - --providers.docker.exposedbydefault=false\r\n      - --providers.docker.swarmmode=true\r\n      - --providers.docker.network=traefik-public\r\n      - --api\r\n      - --api.dashboard=true\r\n      - --certificatesresolvers.leresolver.acme.caserver=https://acme-v02.api.letsencrypt.org/directory\r\n      # update your email here\r\n      - --certificatesresolvers.leresolver.acme.email=youremail@test.com\r\n      # Make sure the this file is available and permission is set correctly\r\n      - --certificatesresolvers.leresolver.acme.storage=/le/acme.json\r\n      - --certificatesresolvers.leresolver.acme.tlschallenge=true\r\n    ports:\r\n      - \"80:80\"\r\n      - \"443:443\"\r\n    networks:\r\n      - traefik-public\r\n    volumes:\r\n      - \"/var/run/docker.sock:/var/run/docker.sock:ro\"\r\n      # Make sure the volume folder is created\r\n      - \"/mnt/data/traefik/acme.json:/le/acme.json\"\r\n    deploy:\r\n      labels:\r\n        # Dashboard\r\n        - \"traefik.enable=true\"\r\n        # Change the host url here\r\n        - \"traefik.http.routers.traefik.rule=Host(`traefik.example.com`)\"\r\n        - \"traefik.http.routers.traefik.service=api@internal\"\r\n        - \"traefik.http.services.traefik.loadbalancer.server.port=8080\"\r\n        - \"traefik.http.routers.traefik.tls.certresolver=leresolver\"\r\n        - \"traefik.http.routers.traefik.entrypoints=websecure\"\r\n        - \"traefik.http.routers.traefik.middlewares=authtraefik\"\r\n        # Change the auth password here\r\n        - \"traefik.http.middlewares.authtraefik.basicauth.users=admin:yournewpassword\" # user/password\r\n\r\n        # global redirect to https\r\n        - \"traefik.http.routers.http-catchall.rule=hostregexp(`{host:.+}`)\"\r\n        - \"traefik.http.routers.http-catchall.entrypoints=web\"\r\n        - \"traefik.http.routers.http-catchall.middlewares=redirect-to-https\"\r\n\r\n        # middleware redirect\r\n        - \"traefik.http.middlewares.redirect-to-https.redirectscheme.scheme=https\"\r\n\r\n  my-app:\r\n    image: containous/whoami:v1.3.0\r\n    networks:\r\n      - traefik-public\r\n    command:\r\n      - --port=8082 # Our service listens on 8082\r\n    deploy:\r\n      labels:\r\n        - \"traefik.enable=true\"\r\n        # Change the host url here\r\n        - \"traefik.http.routers.my-app.rule=Host(`whoami.example.com`)\"\r\n        - \"traefik.http.services.my-app.loadbalancer.server.port=8082\"\r\n        - \"traefik.http.routers.my-app.middlewares=auth\"\r\n        - \"traefik.http.routers.my-app.entrypoints=websecure\"\r\n        - \"traefik.http.routers.my-app.tls=true\"\r\n        - \"traefik.http.routers.my-app.tls.certresolver=leresolver\"\r\n        # Change the password here\r\n        - \"traefik.http.middlewares.auth.basicauth.users=admin:changeme\" # user/password\r\n\r\nnetworks:\r\n  traefik-public:\r\n    external: true\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "portainer",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#portainer",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Portainer"]
    }), "\n", _jsx(_components.p, {
      children: "Portainer is our container management software. We will use to deploy our docker containers."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "version: \"3.2\"\r\n\r\nservices:\r\n  agent:\r\n    image: portainer/agent\r\n    volumes:\r\n      - /var/run/docker.sock:/var/run/docker.sock\r\n      - /var/lib/docker/volumes:/var/lib/docker/volumes\r\n    networks:\r\n      - traefik-public\r\n    deploy:\r\n      mode: global\r\n      placement:\r\n        constraints: [node.platform.os == linux]\r\n\r\n  portainer:\r\n    image: portainer/portainer\r\n    command: -H tcp://tasks.agent:9001 --tlsskipverify\r\n    volumes:\r\n      - /var/run/docker.sock:/var/run/docker.sock\r\n      # make sure the folder is available\r\n      - /mnt/volume2/portainer:/data\r\n    networks:\r\n      - traefik-public\r\n    deploy:\r\n      labels:\r\n        - \"traefik.enable=true\"\r\n        # change the host here\r\n        - \"traefik.http.routers.portainer.rule=Host(`admin.example.com`)\"\r\n        - \"traefik.http.services.portainer.loadbalancer.server.port=9000\"\r\n        - \"traefik.http.routers.portainer.entrypoints=websecure\"\r\n        - \"traefik.http.routers.portainer.tls=true\"\r\n        - \"traefik.http.routers.portainer.tls.certresolver=leresolver\"\r\n      mode: replicated\r\n      placement:\r\n        constraints: [node.role == manager]\r\n\r\nnetworks:\r\n  traefik-public:\r\n    external: true\n"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Setting up Ubuntu Server with docker in Hetzner</title>
          <link>https://blog.antosubash.com/posts/part-1-setup-docker-with-ubuntu-server-in-hetzner</link>
          <guid>https://blog.antosubash.com/posts/part-1-setup-docker-with-ubuntu-server-in-hetzner</guid>
          <pubDate>Sun, 19 Jun 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to create a ubuntu server for docker deployment.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    ul: "ul",
    li: "li",
    pre: "pre",
    code: "code",
    h3: "h3",
    img: "img"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: "Part 1. Setting up Ubuntu Server with docker in Hetzner (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/part-2-setup-docker-swarm-with-traefik-and-portainer",
        children: "Part 2. Setting up docker swarm with traefik and portainer"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/part-3-deploy-registry-redis-rabitmq-postgresql-in-docker",
        children: "Part 3. Deploy redis, rabbitmq, seq, registry and postgres in docker swarm"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/part-4-prepare-and-deploy-microservice-in-docker",
        children: "Part 4. Deploy the microservice in docker swarm"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to setup a ubuntu server for our docker deployment."
    }), "\n", _jsxs(_components.h2, {
      id: "prerequisites",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#prerequisites",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Prerequisites"]
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsx(_components.li, {
        children: "Hetzner cloud account"
      }), "\n"]
    }), "\n", _jsx(_components.p, {
      children: "you can use the referral link here and get 20 Euro to play around. https://hetzner.cloud/?ref=ENhA4rCZ5JUM"
    }), "\n", _jsxs(_components.h2, {
      id: "creating-ssh-key",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#creating-ssh-key",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Creating ssh key"]
    }), "\n", _jsx(_components.p, {
      children: "we will use ssh key to login to the server. so lets first create a ssh key."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "ssh-keygen -t ed25519 -C \"demo@antosubash.com\"\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "this command will create a ssh key."
    }), "\n", _jsxs(_components.h2, {
      id: "create-ubuntu-machine-with-docker",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-ubuntu-machine-with-docker",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create ubuntu machine with docker"]
    }), "\n", _jsx(_components.p, {
      children: "For this we will the hetzner apps. Hetzner provides machine with docker CE. this will save us some time."
    }), "\n", _jsxs(_components.h3, {
      id: "add-ssh-key-to-hetzner-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-ssh-key-to-hetzner-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add ssh key to hetzner project"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner1.png",
        alt: "Add ssh to your hetzner project"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner2.png",
        alt: "Add ssh to your hetzner project"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner3.png",
        alt: "Add ssh to your hetzner project"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "create-server",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-server",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create server"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner4.png",
        alt: "Create Server"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner5.png",
        alt: "Create Server"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner6.png",
        alt: "Create Server"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner7.png",
        alt: "Create Server"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner8.png",
        alt: "Create Server"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner9.png",
        alt: "Create Server"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner10.png",
        alt: "Create Server"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner11.png",
        alt: "Create Server"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "create-the-firewall-for-the-server",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-firewall-for-the-server",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the firewall for the server"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner12.png",
        alt: "Create firewall"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner13.png",
        alt: "Create firewall"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner14.png",
        alt: "Create firewall"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner15.png",
        alt: "Create firewall"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner16.png",
        alt: "Create firewall"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "ip-address-of-our-machine",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#ip-address-of-our-machine",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "IP address of our machine"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/docker-deployment/hetzner17.png",
        alt: "IP address"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "add-dns-entry",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-dns-entry",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add DNS entry"]
    }), "\n", _jsx(_components.p, {
      children: "Now you have to add a DNS entry for your newly created machine. you can fine the the IP address of the machine in the Hetzner server page."
    }), "\n", _jsxs(_components.p, {
      children: ["We need to add ", _jsx(_components.code, {
        children: "A"
      }), " record and a ", _jsx(_components.code, {
        children: "CNAME"
      }), " record."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "A XX.XX.XX.XX yourdomain.com\r\nCNAME * yourdomain.com\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "For example this is how my sample entry looks like"
    }), "\n", _jsx(_components.p, {
      children: "Record      Host        Value\r\nA           youtube1    95.217.191.119\r\nCNAME       *           youtube1.antosubash.com"
    }), "\n", _jsx(_components.p, {
      children: "This might take some time to reflect so wait for a while to verify it."
    }), "\n", _jsxs(_components.h2, {
      id: "verify-dns-entry",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#verify-dns-entry",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Verify DNS entry"]
    }), "\n", _jsx(_components.p, {
      children: "To verify dns entry we will use a tool called dig."
    }), "\n", _jsx(_components.p, {
      children: "you can find it here https://toolbox.googleapps.com/apps/dig/#A"
    }), "\n", _jsx(_components.p, {
      children: "Make sure your domain is pointing to your ip and your subdomain is pointing to your domain"
    }), "\n", _jsx(_components.p, {
      children: "yourdomain.com -> XX.XX.XX.XX\r\nsubdomain.yourdomain.com -> XX.XX.XX.XX"
    }), "\n", _jsx(_components.p, {
      children: "So both your domain and subdomain should point to the same IP Which is the IP of the machine we just created."
    }), "\n", _jsxs(_components.h2, {
      id: "update-ssh-config",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-ssh-config",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update ssh config"]
    }), "\n", _jsx(_components.p, {
      children: "ssh config file can be \"~/.ssh/config\""
    }), "\n", _jsx(_components.p, {
      children: "In the config file add a entry for the newly created server."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Host youtube1.yourdomain.com\r\n   IdentitiesOnly yes\r\n   IdentityFile ~/.ssh/yournewlycreatedkey # Not the pub file\n"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Blazor state management with Fluxor</title>
          <link>https://blog.antosubash.com/posts/state-management-blazor-fluxor</link>
          <guid>https://blog.antosubash.com/posts/state-management-blazor-fluxor</guid>
          <pubDate>Wed, 01 Jun 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to setup fluxor in Blazor Wasm App</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    pre: "pre",
    code: "code",
    ul: "ul",
    li: "li",
    h3: "h3"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "what-is-fluxor",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#what-is-fluxor",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "What is Fluxor"]
    }), "\n", _jsx(_components.p, {
      children: "Fluxor is a zero boilerplate Flux/Redux library for .Net. The aim of Fluxor is to create a multi-UI, single-state store approach to front-end development without the headaches typically associated with other implementations, such as the overwhelming amount of boiler-plate code required just to add a very basic feature.\r\nRepo: https://github.com/mrpmorris/Fluxor\r\nDocs: https://github.com/mrpmorris/Fluxor/blob/master/Docs/README.md"
    }), "\n", _jsxs(_components.h2, {
      id: "when-to-use-fluxor",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#when-to-use-fluxor",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "When to use Fluxor"]
    }), "\n", _jsx(_components.p, {
      children: "Fluxor uses Flux/Redux approach. It helps you to manage your app’s state in a single place and keep changes in your app more predictable and traceable. It makes it easier to manage the state. But all of these benefits come with tradeoffs and constraints. One might feel it adds up boilerplate code, making simple things a little overwhelming; but that depends upon the architecture decisions. If you are wondering if you need state management or not then you don't need it. When your app grows to the scale where managing app state becomes a hassle; and you start looking out for making it easy and simple. That is where you will find Fluxor helpful."
    }), "\n", _jsxs(_components.h2, {
      id: "creating-blazor-wasm-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#creating-blazor-wasm-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Creating Blazor Wasm project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet new blazorwasm -n FluxorWithBlazor\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will create a blazor wasm app."
    }), "\n", _jsxs(_components.h2, {
      id: "install-fluxor-packages",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-fluxor-packages",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install Fluxor Packages"]
    }), "\n", _jsx(_components.p, {
      children: "Install Nuget packages"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<PackageReference Include=\"Fluxor\" Version=\"5.4.0\" />\r\n<PackageReference Include=\"Fluxor.Blazor.Web\" Version=\"5.4.0\" />\r\n<PackageReference Include=\"Fluxor.Blazor.Web.ReduxDevTools\" Version=\"5.4.0\" />\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "Program.cs"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using Fluxor;\r\n\r\nbuilder.Services.AddFluxor(o =>\r\n{\r\n    o.ScanAssemblies(typeof(Program).Assembly);\r\n    o.UseReduxDevTools(rdt =>\r\n      {\r\n          rdt.Name = \"My application\";\r\n      });\r\n});\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "App.razor"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<Fluxor.Blazor.Web.StoreInitializer />\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now we are ready to create state in our Blazor application."
    }), "\n", _jsxs(_components.h2, {
      id: "fluxor-rules",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#fluxor-rules",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Fluxor Rules"]
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsx(_components.li, {
        children: "State should always be read-only."
      }), "\n", _jsx(_components.li, {
        children: "To alter state our app should dispatch an action."
      }), "\n", _jsx(_components.li, {
        children: "Every reducer that processes the dispatched action type will create new state to reflect the old state combined with the changes expected for the action."
      }), "\n", _jsx(_components.li, {
        children: "The UI then uses the new state to render its display."
      }), "\n"]
    }), "\n", _jsxs(_components.h2, {
      id: "core-concepts-state-actions-and-reducers",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#core-concepts-state-actions-and-reducers",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Core Concepts (State, Actions, and Reducers)"]
    }), "\n", _jsxs(_components.h3, {
      id: "state",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#state",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "State"]
    }), "\n", _jsx(_components.p, {
      children: "Imagine your app’s state is described as a plain object. For example, the state of a counter app might look like this:"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[FeatureState]\r\npublic class CounterState\r\n{\r\n  public int ClickCount { get; }\r\n\r\n  public CounterState(int clickCount)\r\n  {\r\n    ClickCount = clickCount;\r\n  }\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This object is like a “model” except that there are no setters. This is so that different parts of the code can’t change the state arbitrarily, causing hard-to-reproduce bugs. To change something in the state, you need to dispatch an action."
    }), "\n", _jsxs(_components.h3, {
      id: "action",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#action",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Action"]
    }), "\n", _jsx(_components.p, {
      children: "An action is a plain c# object (notice how we don’t introduce any magic?) that describes what happened. Here are a few example actions:"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class IncrementCounterAction\r\n{\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Enforcing that every change is described as an action lets us have a clear understanding of what’s going on in the app. If something changed, we know why it changed. Actions are like breadcrumbs of what has happened."
    }), "\n", _jsxs(_components.h3, {
      id: "reducers",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#reducers",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Reducers"]
    }), "\n", _jsx(_components.p, {
      children: "Finally, to tie state and actions together, we write a function called a reducer. Again, nothing magical about it—it’s just a function that takes state and action as arguments, and returns the next state of the app. It would be hard to write such a function for a big app, so we write smaller functions managing parts of the state:"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public static class Reducers\r\n{\r\n    [ReducerMethod]\r\n    public static CounterState ReduceIncrementCounterAction(CounterState state, IncrementCounterAction action) =>\r\n        new(clickCount: state.ClickCount + 1);\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "using-the-state",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#using-the-state",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Using the State"]
    }), "\n", _jsxs(_components.p, {
      children: ["To use the state management we will update the ", _jsx(_components.code, {
        children: "counter"
      }), " page which comes with the default app."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-html",
        children: "@page \"/counter\"\r\n@using FluxorWithBlazor.State.Counter\r\n@inject IDispatcher dispatcher\r\n@inject IState<CounterState> counterState\r\n<PageTitle>Counter</PageTitle>\r\n\r\n<h1>Counter</h1>\r\n\r\n<p role=\"status\">Current count: @counterState.Value.ClickCount</p>\r\n\r\n<button class=\"btn btn-primary\" @onclick=\"IncrementCount\">Click me</button>\r\n\r\n@code {\r\n    private void IncrementCount()\r\n    {\r\n        dispatcher.Dispatch(new IncrementCounterAction());\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["In the ", _jsx(_components.code, {
        children: "IncrementCount"
      }), " method we are dispatching an action and the current count is displayed buy injecting the state."]
    }), "\n", _jsxs(_components.h2, {
      id: "effects",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#effects",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Effects"]
    }), "\n", _jsx(_components.p, {
      children: "Flux state is supposed to be immutable, and that state replaced only by pure functions, which should only take input from their parameters. With this in mind, we need something that will enable us to access other sources of data such as web services, and then reduce the results into our state. That is where the effects comes in. Effect handlers cannot (and should not) affect state directly. They are triggered when the action they are interested in is dispatched through the store, and as a response they can dispatch new actions."
    }), "\n", _jsxs(_components.h2, {
      id: "fetch-data-with-effects",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#fetch-data-with-effects",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Fetch data with effects"]
    }), "\n", _jsx(_components.p, {
      children: "We will update the fetch data sample provided in the default blazor application with Effects."
    }), "\n", _jsxs(_components.h3, {
      id: "fetch-data-action",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#fetch-data-action",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Fetch data action"]
    }), "\n", _jsx(_components.p, {
      children: "Lets create a action which will initiate the action. this will the be a empty action which will be used to trigger the effect."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class FetchDataAction\r\n{\r\n}\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "fetch-data-result-action",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#fetch-data-result-action",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Fetch data result action"]
    }), "\n", _jsx(_components.p, {
      children: "Once the data is received from the server we need a action to update the state. we will use the ´FetchDataResultAction´ for that. It will have a the list of Weather forecast available."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class FetchDataResultAction\r\n{\r\n    public IEnumerable<WeatherForecast> Forecasts { get; }\r\n\r\n    public FetchDataResultAction(IEnumerable<WeatherForecast> forecasts)\r\n    {\r\n        Forecasts = forecasts;\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "weather-state",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#weather-state",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Weather state"]
    }), "\n", _jsx(_components.p, {
      children: "Weather state will the two property ´Forecasts´ and ´IsLoading´."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[FeatureState]\r\npublic class WeatherState\r\n{\r\n  public bool IsLoading { get; }\r\n  public IEnumerable<WeatherForecast> Forecasts { get; }\r\n\r\n  private WeatherState() { }\r\n  public WeatherState(bool isLoading, IEnumerable<WeatherForecast> forecasts)\r\n  {\r\n    IsLoading = isLoading;\r\n    Forecasts = forecasts ?? Array.Empty<WeatherForecast>();\r\n  }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "weather-reducers",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#weather-reducers",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Weather Reducers"]
    }), "\n", _jsx(_components.p, {
      children: "In the reducer we need to manage 2 action which are created by us. One is to trigger the data fetch and the next one is to handle the data result."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public static class Reducers\r\n{\r\n  [ReducerMethod]\r\n  public static WeatherState ReduceFetchDataAction(WeatherState state, FetchDataAction action) =>\r\n    new(isLoading: true, forecasts: null);\r\n\r\n  [ReducerMethod]\r\n  public static WeatherState ReduceFetchDataResultAction(WeatherState state, FetchDataResultAction action) =>\r\n    new(isLoading: false, forecasts: action.Forecasts);\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "weather-effects",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#weather-effects",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Weather effects"]
    }), "\n", _jsx(_components.p, {
      children: "Effects is where we will make our ´http´ call. We will inject the ´HttpClient´ and use that in the effect method. once the call is successful we will dispatch an action with the data result."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class Effects\r\n{\r\n    private readonly HttpClient Http;\r\n\r\n    public Effects(HttpClient http)\r\n    {\r\n        Http = http;\r\n    }\r\n\r\n    [EffectMethod]\r\n    public async Task HandleFetchDataAction(FetchDataAction action, IDispatcher dispatcher)\r\n    {\r\n        var forecasts = await Http.GetFromJsonAsync<WeatherForecast[]>(\"sample-data/weather.json\");\r\n        if(forecasts is not null)\r\n        {\r\n            dispatcher.Dispatch(new FetchDataResultAction(forecasts: forecasts!));\r\n        }\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-fetch-data-page",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-fetch-data-page",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the fetch data page"]
    }), "\n", _jsx(_components.p, {
      children: "We need to update the fetch data page to use the weather state."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-html",
        children: "@page \"/fetchdata\"\r\n@inject IDispatcher dispatcher\r\n@inject IState<WeatherState> weather\r\n@inherits Fluxor.Blazor.Web.Components.FluxorComponent\r\n<PageTitle>Weather forecast</PageTitle>\r\n\r\n<h1>Weather forecast</h1>\r\n\r\n<p>This component demonstrates fetching data from the server.</p>\r\n\r\n@if (weather.Value.IsLoading)\r\n{\r\n\t<p><em>Loading...</em></p>\r\n}\r\nelse\r\n{\r\n\t<table class=\"table\">\r\n\t\t<thead>\r\n\t\t\t<tr>\r\n\t\t\t\t<th>Date</th>\r\n\t\t\t\t<th>Temp. (C)</th>\r\n\t\t\t\t<th>Temp. (F)</th>\r\n\t\t\t\t<th>Summary</th>\r\n\t\t\t</tr>\r\n\t\t</thead>\r\n\t\t<tbody>\r\n\t\t\t@foreach (var forecast in weather.Value.Forecasts)\r\n\t\t\t{\r\n\t\t\t<tr>\r\n\t\t\t\t<td>@forecast.Date.ToShortDateString()</td>\r\n\t\t\t\t<td>@forecast.TemperatureC</td>\r\n\t\t\t\t<td>@forecast.TemperatureF</td>\r\n\t\t\t\t<td>@forecast.Summary</td>\r\n\t\t\t</tr>\r\n\t\t\t}\r\n\t\t</tbody>\r\n\t</table>\r\n}\r\n\r\n@code {\r\n\r\n\tprotected override void OnInitialized()\r\n\t{\r\n\t\tbase.OnInitialized();\r\n\t\tdispatcher.Dispatch(new FetchDataAction());\r\n\t}\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Repo : https://github.com/antosubash/blazor-state-management-with-fluxor"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>.NET Microservice with ABP - Full Series</title>
          <link>https://blog.antosubash.com/posts/abp-microservice-series</link>
          <guid>https://blog.antosubash.com/posts/abp-microservice-series</guid>
          <pubDate>Sat, 23 Apr 2022 00:00:00 GMT</pubDate>
          <description>This post contains all the parts of the microservice development with ABP</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    ul: "ul",
    li: "li"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-init-part-1",
        children: "Part 1. Initial Setup"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-shared-project-part-2",
        children: "Part 2. Shared Project"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-administration-services-part-3",
        children: "Part 3. Administration Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-services-part-4",
        children: "Part 4. Identity Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-saas-services-part-5",
        children: "Part 5. SaaS Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-db-migration-part-6",
        children: "Part 6. DB Migration"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-yarp-and-tye-part-7",
        children: "Part 7. Yarp and Tye"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-server-and-angular-part-8",
        children: "Part 8. Identity server and Angular App"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-distributed-event-bus-part-9",
        children: "Part 9. Distributed event bus"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-docker-and-ci-cd-part-10",
        children: "Part 10. Docker and CI/CD"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-new-service-part-11",
        children: "Part 11. Add a New service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-central-logging-part-12",
        children: "Part 12. Central Logging"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "This post consolidates all the parts of the microservice development in the single place."
    }), "\n", _jsxs(_components.h2, {
      id: "what-is-abp",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#what-is-abp",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "What is ABP?"]
    }), "\n", _jsx(_components.p, {
      children: "ABP framework is a complete infrastructure to create modern web applications by following the best practices and conventions of software development. ABP offers a complete, modular and layered software architecture based on Domain Driven Design principles and patterns. There are a lot of features provided by the ABP Framework to achieve real world scenarios easier, like Event Bus, Background Job System, Audit Logging, BLOB Storing, Data Seeding, Data Filtering, etc. ABP also simplifies (and even automates wherever possible) cross cutting concerns and common non-functional requirements like Exception Handling, Validation, Authorization, Localization, Caching, Dependency Injection, Setting Management, etc."
    }), "\n", _jsx(_components.p, {
      children: "You can find more info here: https://github.com/abpframework/abp"
    }), "\n", _jsx(_components.p, {
      children: "You can find the documentation here: https://docs.abp.io/en/abp/latest"
    }), "\n", _jsxs(_components.p, {
      children: ["Here is the ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Tutorials/Todo/Index?UI=MVC&DB=EF",
        children: "Quick Start Guide"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "why-microservice-with-abp",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#why-microservice-with-abp",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Why Microservice with ABP?"]
    }), "\n", _jsx(_components.p, {
      children: "One of the major goals of the ABP framework is to provide a convenient infrastructure to create microservice solutions. To make this possible,"
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsx(_components.li, {
        children: "Provides a module system that allows you to split your application into modules where each module may have its own database, entities, services, APIs, UI components/pages... etc."
      }), "\n", _jsx(_components.li, {
        children: "Offers an architectural model to develop your modules to be compatible to microservice development and deployment."
      }), "\n", _jsx(_components.li, {
        children: "Provides best practices guide to develop your module standards-compliance."
      }), "\n", _jsx(_components.li, {
        children: "Provides base infrastructure to implement Domain Driven Design in your microservice."
      }), "\n", _jsx(_components.li, {
        children: "Provide services to automatically create REST-style APIs from your application services."
      }), "\n", _jsx(_components.li, {
        children: "Provide services to automatically create C# API clients that makes easy to consume your services from another service/application."
      }), "\n", _jsx(_components.li, {
        children: "Provides a distributed event bus to communicate your services."
      }), "\n"]
    }), "\n", _jsxs(_components.h2, {
      id: "purpose",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#purpose",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Purpose"]
    }), "\n", _jsx(_components.p, {
      children: "By default when you create a ABP application it will be a monolith. There is no definitive guide on how to create a microservice application with all the modules. The purpose of this blog series is to have a base solution of the ABP running as a microservice application. We will have a SaaS service for Tenant Management and Identity Service for Identity and IdentityServer and Admin Service for features, permissions, settings and audit logs. this will be a great base solution for your microservice and you will see how to setup the microservice from the scratch."
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Logging with Seq</title>
          <link>https://blog.antosubash.com/posts/netcore-microservice-with-abp-add-central-logging-part-12</link>
          <guid>https://blog.antosubash.com/posts/netcore-microservice-with-abp-add-central-logging-part-12</guid>
          <pubDate>Wed, 13 Apr 2022 00:00:00 GMT</pubDate>
          <description>In this post, we will see how to add centralized logging to our microservice application</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    p: "p",
    a: "a",
    h2: "h2",
    span: "span",
    h3: "h3",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.p, {
      children: ["This is the part 12 of the series: ", _jsx(_components.a, {
        href: "/posts/abp-microservice-series",
        children: ".NET Microservice with ABP"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-init-part-1",
        children: "Part 1. Initial Setup"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-shared-project-part-2",
        children: "Part 2. Shared Project"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-administration-services-part-3",
        children: "Part 3. Administration Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-services-part-4",
        children: "Part 4. Identity Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-saas-services-part-5",
        children: "Part 5. SaaS Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-db-migration-part-6",
        children: "Part 6. DB Migration"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-yarp-and-tye-part-7",
        children: "Part 7. Yarp and Tye"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-server-and-angular-part-8",
        children: "Part 8. Identity server and Angular App"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-distributed-event-bus-part-9",
        children: "Part 9. Distributed event bus"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-docker-and-ci-cd-part-10",
        children: "Part 10. Docker and CI/CD"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-new-service-part-11",
        children: "Part 11. Add a New service"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 12. Central Logging (this post)"
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "This is the Part 12 of the Microservice with ABP series. In this post, we will see how to add centralized logging to our microservice application"
    }), "\n", _jsxs(_components.h2, {
      id: "what-is-seq",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#what-is-seq",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "What is Seq?"]
    }), "\n", _jsx(_components.p, {
      children: "Seq is the intelligent search, analysis, and alerting server built specifically for modern structured log data. Seq creates the visibility you need to quickly identify and diagnose problems in complex applications and microservices."
    }), "\n", _jsxs(_components.h2, {
      id: "why-use-seq",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#why-use-seq",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Why use Seq?"]
    }), "\n", _jsx(_components.p, {
      children: "Application logs are the most useful data available for detecting and solving a wide range of production issues and outages. Seq makes it easier to pinpoint the events and patterns in application behavior that show your system is working correctly — or why it isn't."
    }), "\n", _jsx(_components.p, {
      children: "More info here : https://docs.datalust.co/docs/using-serilog"
    }), "\n", _jsxs(_components.h2, {
      id: "purpose",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#purpose",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Purpose"]
    }), "\n", _jsx(_components.p, {
      children: "In our microservice application, there are four services and one Identity server, and one gateway. This count will keep growing. We use serilog to log the data. But the logs are only available inside the application. This creates a problem. To solve this problem we will use seq. Seq will store all the logs in a central location so that it will make it easy for us to view the application logs and analyze them."
    }), "\n", _jsxs(_components.h2, {
      id: "pricing",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#pricing",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Pricing"]
    }), "\n", _jsx(_components.p, {
      children: "Seq is free if you run Seq on your developer workstation, or in production if you're going solo. what does this mean? it means that if you are using only one user account then it is free."
    }), "\n", _jsxs(_components.h2, {
      id: "setup-the-shared-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#setup-the-shared-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Setup the shared project"]
    }), "\n", _jsx(_components.p, {
      children: "Since the logging has to be applied in all the projects we can create the configuration in the shared project and apply it to all the services."
    }), "\n", _jsxs(_components.h3, {
      id: "install-the-shared-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-the-shared-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install the shared project"]
    }), "\n", _jsx(_components.p, {
      children: "Install the Seq sinks for the serilog"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<PackageReference Include=\"Serilog.Sinks.Seq\" Version=\"5.1.1\" />\r\n<PackageReference Include=\"Serilog.Settings.Configuration\" Version=\"3.3.0\" />\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "create-a-serilog-config-helper",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-serilog-config-helper",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a serilog config helper"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public static class SerilogConfigurationHelper\r\n{\r\n    public static void Configure(string applicationName)\r\n    {\r\n        var configuration = new ConfigurationBuilder()\r\n            .SetBasePath(Directory.GetCurrentDirectory())\r\n            .AddJsonFile(\"appsettings.json\")\r\n            .AddEnvironmentVariables()\r\n            .Build();\r\n\r\n        Log.Logger = new LoggerConfiguration()\r\n            .ReadFrom.Configuration(configuration)\r\n#if DEBUG\r\n            .MinimumLevel.Debug()\r\n#else\r\n                .MinimumLevel.Information()\r\n#endif\r\n            .MinimumLevel.Override(\"Microsoft\", LogEventLevel.Information)\r\n            .MinimumLevel.Override(\"Microsoft.EntityFrameworkCore\", LogEventLevel.Warning)\r\n            .Enrich.FromLogContext()\r\n            .Enrich.WithProperty(\"Application\", $\"{applicationName}\")\r\n            .WriteTo.Async(c => c.File(\"Logs/logs.txt\"))\r\n            .WriteTo.Async(c => c.Console())\r\n            .CreateLogger();\r\n    }\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This Seirlog helper will replace all the other log configurations."
    }), "\n", _jsxs(_components.h3, {
      id: "add-serilog-appsettings",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-serilog-appsettings",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add Serilog appsettings"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "\"Serilog\": {\r\n    \"WriteTo\": [\r\n        { \"Name\": \"Seq\", \"Args\": { \"serverUrl\": \"http://localhost:5341\" } }\r\n    ]\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Server url points to location where the seq is hosted. In the above example it is pointed to the localhost instance of the seq."
    }), "\n", _jsxs(_components.h2, {
      id: "update-services",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-services",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update services"]
    }), "\n", _jsxs(_components.p, {
      children: ["Logger configuration are preset in the ", _jsx(_components.code, {
        children: "Program.cs"
      }), " file in the services. we need to update the ", _jsx(_components.code, {
        children: "Program.cs"
      }), " file in the with the new log config."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "var assemblyName = typeof(Program).Assembly.GetName().Name;\r\nSerilogConfigurationHelper.Configure(assemblyName);\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "We are going to read the assembly name and send it to configure the logging. this is useful for separating the logs based on the services."
    }), "\n", _jsxs(_components.h2, {
      id: "check-the-logs",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#check-the-logs",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Check the logs"]
    }), "\n", _jsx(_components.p, {
      children: "Once all the services are updated run the services and you will be able to see the logs in the seq admin app."
    }), "\n", _jsx(_components.p, {
      children: "Repo: https://github.com/antosubash/Tasky"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Add New Service</title>
          <link>https://blog.antosubash.com/posts/netcore-microservice-with-abp-add-new-service-part-11</link>
          <guid>https://blog.antosubash.com/posts/netcore-microservice-with-abp-add-new-service-part-11</guid>
          <pubDate>Thu, 07 Apr 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to add docker support and create a CI/CD with github actions</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    p: "p",
    a: "a",
    h2: "h2",
    span: "span",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.p, {
      children: ["This is the part 11 of the series: ", _jsx(_components.a, {
        href: "/posts/abp-microservice-series",
        children: ".NET Microservice with ABP"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-init-part-1",
        children: "Part 1. Initial Setup"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-shared-project-part-2",
        children: "Part 2. Shared Project"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-administration-services-part-3",
        children: "Part 3. Administration Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-services-part-4",
        children: "Part 4. Identity Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-saas-services-part-5",
        children: "Part 5. SaaS Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-db-migration-part-6",
        children: "Part 6. DB Migration"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-yarp-and-tye-part-7",
        children: "Part 7. Yarp and Tye"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-server-and-angular-part-8",
        children: "Part 8. Identity server and Angular App"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-distributed-event-bus-part-9",
        children: "Part 9. Distributed event bus"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-docker-and-ci-cd-part-10",
        children: "Part 10. Docker and CI/CD"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 11. Add a New service (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-central-logging-part-12",
        children: "Part 12. Central Logging"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post, we will add a new service to our microservice application."
    }), "\n", _jsxs(_components.h2, {
      id: "create-service-script",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-service-script",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create service script"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "$serviceNameInput = $args[0]\r\n\r\n$solution = Get-ChildItem *.sln | Select-Object -First 1 | Get-ItemProperty -Name Name\r\n$name = (Get-Item $solution.PSPath).Basename\r\n$pascalCase = $serviceNameInput -replace '(?:^|_)(\\p{L})', { $_.Groups[1].Value.ToUpper() }\r\n$service = $pascalCase + \"Service\"\r\n$folder = $serviceNameInput.ToLower()\r\n\r\nabp new \"$name.$service\" -t module --no-ui -o services\\$folder\r\nRemove-Item -Recurse -Force (Get-ChildItem -Path \"services\\$folder\" -Recurse -Include *.IdentityServer)\r\nRemove-Item -Recurse -Force (Get-ChildItem -Path \"services\\$folder\" -Recurse -Include *.MongoDB.Tests)\r\nRemove-Item -Recurse -Force (Get-ChildItem -Path \"services\\$folder\" -Recurse -Include *.MongoDB)\r\nRemove-Item -Recurse -Force (Get-ChildItem -Path \"services\\$folder\" -Recurse -Include *.Host.Shared)\r\nRemove-Item -Recurse -Force (Get-ChildItem -Path \"services\\$folder\" -Recurse -Include *.Installer)\r\ndotnet sln \".\\$name.sln\" add (Get-ChildItem -Path \"services\\$folder\" -Recurse -Include *.csproj)\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "run-the-script",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-the-script",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run the script"]
    }), "\n", _jsx(_components.p, {
      children: "Please make sure to run this command in the root of your project where the solution file is located."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: ".\\newservice.ps1 project\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This script will create a new service and do some cleanup and add the project to solution."
    }), "\n", _jsxs(_components.h2, {
      id: "create-shared-hosting-for-microservice",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-shared-hosting-for-microservice",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create shared hosting for Microservice"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet new classlib -n Tasky.Microservice.Shared -o shared\\Tasky.Microservice.Shared\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "We are creating this project as a shared project for all the new microservice."
    }), "\n", _jsxs(_components.p, {
      children: ["Add the reference to ", _jsx(_components.code, {
        children: "AdministrationService"
      }), " and ", _jsx(_components.code, {
        children: "SaaSService"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<ItemGroup>\r\n  <ProjectReference Include=\"..\\..\\services\\administration\\src\\Tasky.AdministrationService.EntityFrameworkCore\\Tasky.AdministrationService.EntityFrameworkCore.csproj\" />\r\n  <ProjectReference Include=\"..\\..\\services\\saas\\src\\Tasky.SaaSService.EntityFrameworkCore\\Tasky.SaaSService.EntityFrameworkCore.csproj\" />\r\n  <ProjectReference Include=\"..\\Tasky.Shared.Hosting\\Tasky.Shared.Hosting.csproj\" />\r\n</ItemGroup>\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Create the ", _jsx(_components.code, {
        children: "TaskyMicroserviceHosting"
      }), " module"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[DependsOn(\r\n    typeof(TaskyHostingModule),\r\n    typeof(AdministrationServiceEntityFrameworkCoreModule),\r\n    typeof(SaaSServiceEntityFrameworkCoreModule)\r\n)]\r\npublic class TaskyMicroserviceHosting : AbpModule\r\n{\r\n\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now we have the shared project we can use for all the new microservice"
    }), "\n", _jsxs(_components.h2, {
      id: "prepare-the-host-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#prepare-the-host-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Prepare the host project"]
    }), "\n", _jsx(_components.p, {
      children: "Add the reference the of the Shared microservice project"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<ProjectReference Include=\"..\\..\\..\\..\\shared\\Tasky.Shared.Microservice.Hosting\\Tasky.Shared.Microservice.Hosting.csproj\" />\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "DependsOn"
      }), " in the host project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[DependsOn(\r\n    typeof(TaskyMicroserviceHosting),\r\n    typeof(ProjectServiceApplicationModule),\r\n    typeof(ProjectServiceEntityFrameworkCoreModule),\r\n    typeof(ProjectServiceHttpApiModule)\r\n    )]\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the host port to ", _jsx(_components.code, {
        children: "7004"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "appsettings.json"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "{\r\n  \"App\": {\r\n    \"CorsOrigins\": \"http://localhost:4200\"\r\n  },\r\n  \"ConnectionStrings\": {\r\n    \"ProjectService\": \"User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=TaskyProjectService;Pooling=false;\",\r\n    \"SaaSService\": \"User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=TaskySaaSService;Pooling=false;\",\r\n    \"AdministrationService\": \"User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=TaskyAdministrationService;Pooling=false;\"\r\n  },\r\n  \"Redis\": {\r\n    \"Configuration\": \"127.0.0.1\"\r\n  },\r\n  \"AuthServer\": {\r\n    \"Authority\": \"https://localhost:7000/\",\r\n    \"RequireHttpsMetadata\": \"false\",\r\n    \"SwaggerClientId\": \"ProjectService_Swagger\",\r\n    \"SwaggerClientSecret\": \"1q2w3e*\"\r\n  },\r\n  \"RabbitMQ\": {\r\n    \"Connections\": {\r\n      \"Default\": {\r\n        \"HostName\": \"localhost\"\r\n      }\r\n    },\r\n    \"EventBus\": {\r\n      \"ClientName\": \"Tasky_ProjectService\",\r\n      \"ExchangeName\": \"Tasky\"\r\n    }\r\n  }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-ef-core-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-ef-core-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the EF core project"]
    }), "\n", _jsxs(_components.p, {
      children: ["create a ", _jsx(_components.code, {
        children: "ProjectServiceDbContextFactory"
      }), " in the EF core project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class ProjectServiceDbContextFactory : IDesignTimeDbContextFactory<ProjectServiceDbContext>\r\n{\r\n    public ProjectServiceDbContext CreateDbContext(string[] args)\r\n    {\r\n        var configuration = BuildConfiguration();\r\n\r\n        var builder = new DbContextOptionsBuilder<ProjectServiceDbContext>()\r\n            .UseNpgsql(GetConnectionStringFromConfiguration());\r\n\r\n        return new ProjectServiceDbContext(builder.Options);\r\n    }\r\n\r\n    private static string GetConnectionStringFromConfiguration()\r\n    {\r\n        return BuildConfiguration()\r\n            .GetConnectionString(ProjectServiceDbProperties.ConnectionStringName);\r\n    }\r\n\r\n    private static IConfigurationRoot BuildConfiguration()\r\n    {\r\n        var builder = new ConfigurationBuilder()\r\n            .SetBasePath(\r\n                Path.Combine(\r\n                    Directory.GetParent(Directory.GetCurrentDirectory())?.Parent!.FullName!,\r\n                    $\"host{Path.DirectorySeparatorChar}Tasky.ProjectService.HttpApi.Host\"\r\n                )\r\n            )\r\n            .AddJsonFile(\"appsettings.json\", false);\r\n\r\n        return builder.Build();\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-project-api",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-project-api",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a project API"]
    }), "\n", _jsx(_components.p, {
      children: "Create the project entity"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class Project : AggregateRoot<Guid>, IMultiTenant\r\n{\r\n    public string Name { get; set; }\r\n\r\n    public Guid? TenantId { get; set; }\r\n\r\n    public Project(string name)\r\n    {\r\n        Name = name;\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Add ", _jsx(_components.code, {
        children: "Projects"
      }), " to the ", _jsx(_components.code, {
        children: "DbContext"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public DbSet<Project> Projects { get; set; }\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "ProjectServiceDbContextModelCreatingExtensions"
      }), " in the ", _jsx(_components.code, {
        children: "ConfigureProjectService"
      }), " method"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "builder.Entity<Project>(b =>\r\n{\r\n    //Configure table & schema name\r\n    b.ToTable(ProjectServiceDbProperties.DbTablePrefix + \"Projects\", ProjectServiceDbProperties.DbSchema);\r\n\r\n    b.ConfigureByConvention();\r\n});\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "ProjectServiceEntityFrameworkCoreModule"
      }), " in the ", _jsx(_components.code, {
        children: "AddAbpDbContext"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "context.Services.AddAbpDbContext<ProjectServiceDbContext>(options =>\r\n{\r\n    options.AddDefaultRepositories(true);\r\n});\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "prepare-for-the-migration",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#prepare-for-the-migration",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Prepare for the migration"]
    }), "\n", _jsx(_components.p, {
      children: "Add the ef core design nuget for the migrations."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<PackageReference Include=\"Microsoft.EntityFrameworkCore.Design\" Version=\"6.0.1\">\r\n    <PrivateAssets>all</PrivateAssets>\r\n    <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>\r\n</PackageReference>\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Once this is created delete ", _jsx(_components.code, {
        children: "EntityFrameworkCore"
      }), " folder can be created from the host project."]
    }), "\n", _jsxs(_components.h2, {
      id: "migration",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#migration",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Migration"]
    }), "\n", _jsx(_components.p, {
      children: "To create migrations"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "dotnet ef migrations add Init"
      })
    }), "\n", _jsx(_components.p, {
      children: "To update database"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "dotnet ef database update"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-feature-definition-in-contracts",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-feature-definition-in-contracts",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create feature definition in contracts"]
    }), "\n", _jsx(_components.p, {
      children: "Add the Feature package"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<PackageReference Include=\"Volo.Abp.Features\" Version=\"5.2.0\" />\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Create ", _jsx(_components.code, {
        children: "ProjectServiceFeatures"
      }), " for the constants"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class ProjectServiceFeatures\r\n{\r\n    public const string GroupName = \"ProjectService\";\r\n\r\n    public static class Project\r\n    {\r\n        public const string Default = GroupName + \".Project\";\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Create ", _jsx(_components.code, {
        children: "ProjectServiceFeaturesDefinitionProvider"
      }), " for creating permissions"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class ProjectServiceFeaturesDefinitionProvider : FeatureDefinitionProvider\r\n{\r\n    public override void Define(IFeatureDefinitionContext context)\r\n    {\r\n        var myGroup = context.AddGroup(ProjectServiceFeatures.GroupName);\r\n        myGroup.AddFeature(\r\n            ProjectServiceFeatures.Project.Default, \r\n            defaultValue: \"false\",            \r\n            displayName: L(\"Project\"),\r\n            valueType: new ToggleStringValueType());\r\n    }\r\n\r\n    private static LocalizableString L(string name)\r\n    {\r\n        return LocalizableString.Create<ProjectServiceResource>(name);\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-permission",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-permission",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create permission"]
    }), "\n", _jsxs(_components.p, {
      children: ["Create ", _jsx(_components.code, {
        children: "ProjectServicePermissions"
      }), " file"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public const string GroupName = \"ProjectService\";\r\n\r\npublic static class Project\r\n{\r\n    public const string Default = GroupName + \".Project\";\r\n    public const string Create = Default + \".Create\";\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Create ", _jsx(_components.code, {
        children: "ProjectServicePermissionDefinitionProvider"
      }), " file"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class ProjectServicePermissionDefinitionProvider : PermissionDefinitionProvider\r\n{\r\n    public override void Define(IPermissionDefinitionContext context)\r\n    {\r\n        var projectGroup = context.AddGroup(ProjectServicePermissions.GroupName, L(\"Permission:ProjectService\"));\r\n        var projectPermission = projectGroup.AddPermission(ProjectServicePermissions.Project.Default, L(\"Permission:ProjectService:Default\"));\r\n        projectPermission.AddChild(ProjectServicePermissions.Project.Create);\r\n\r\n    }\r\n\r\n    private static LocalizableString L(string name)\r\n    {\r\n        return LocalizableString.Create<ProjectServiceResource>(name);\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-appservice-contract",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-appservice-contract",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create AppService Contract"]
    }), "\n", _jsxs(_components.p, {
      children: ["Create ", _jsx(_components.code, {
        children: "ProjectDto"
      }), " file"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class ProjectDto : EntityDto<Guid>\r\n{\r\n    public string Name { get; set; }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Create ", _jsx(_components.code, {
        children: "IProjectAppService"
      }), " file"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public interface IProjectAppService : IApplicationService\r\n{\r\n    Task<List<ProjectDto>> GetAllAsync();\r\n\r\n    Task<ProjectDto> Create(ProjectDto projectDto);\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-appservice-in-the-application",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-appservice-in-the-application",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create AppService in the Application"]
    }), "\n", _jsxs(_components.p, {
      children: ["Create ", _jsx(_components.code, {
        children: "ProjectAppService"
      }), " file"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[RequiresFeature(ProjectServiceFeatures.Project.Default)]\r\n[Authorize(ProjectServicePermissions.Project.Default)]\r\npublic class ProjectAppService : ProjectServiceAppService, IProjectAppService\r\n{\r\n    private readonly IRepository<Project, Guid> repository;\r\n\r\n    public ProjectAppService(IRepository<Project, Guid> repository)\r\n    {\r\n        this.repository = repository;\r\n    }\r\n\r\n    [Authorize(ProjectServicePermissions.Project.Default)]    \r\n    public async Task<List<ProjectDto>> GetAllAsync()\r\n    {\r\n        var projects = await repository.GetListAsync();\r\n        return ObjectMapper.Map<List<Project>,List<ProjectDto>>(projects);\r\n    }\r\n\r\n    [Authorize(ProjectServicePermissions.Project.Create)]\r\n    public async Task<ProjectDto> Create(ProjectDto projectDto)\r\n    {\r\n        var project = await repository.InsertAsync(new Project(projectDto.Name));\r\n        return new ProjectDto\r\n        {\r\n            Name = project.Name\r\n        };\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-controller",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-controller",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a Controller"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[Area(ProjectServiceRemoteServiceConsts.ModuleName)]\r\n[RemoteService(Name = ProjectServiceRemoteServiceConsts.RemoteServiceName)]\r\n[Route(\"api/project\")]\r\npublic class ProjectController : ProjectServiceController, IProjectAppService\r\n{\r\n    private readonly IProjectAppService _projectService;\r\n\r\n    public ProjectController(IProjectAppService sampleAppService)\r\n    {\r\n        _projectService = sampleAppService;\r\n    }\r\n\r\n    [HttpGet]\r\n    public async Task<List<ProjectDto>> GetAllAsync()\r\n    {\r\n        return await _projectService.GetAllAsync();\r\n    }\r\n\r\n    \r\n    [HttpPost]    \r\n    public async Task<ProjectDto> Create(ProjectDto projectDto)\r\n    {\r\n        return await _projectService.Create(projectDto);\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-dbmigrator-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-dbmigrator-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the DbMigrator project"]
    }), "\n", _jsx(_components.p, {
      children: "Add the project reference for the new service"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<ProjectReference Include=\"..\\..\\services\\project\\src\\Tasky.ProjectService.Application.Contracts\\Tasky.ProjectService.Application.Contracts.csproj\" />\r\n<ProjectReference Include=\"..\\..\\services\\project\\src\\Tasky.ProjectService.EntityFrameworkCore\\Tasky.ProjectService.EntityFrameworkCore.csproj\" />\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Update the dependency"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "typeof(ProjectServiceEntityFrameworkCoreModule),\r\ntypeof(ProjectServiceApplicationContractsModule)\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "MigrateAllDatabasesAsync"
      }), " function in the  ", _jsx(_components.code, {
        children: "TaskyDbMigrationService"
      }), " file"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "await MigrateDatabaseAsync<ProjectServiceDbContext>(cancellationToken);\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "appsettings.json"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "{\r\n  \"ConnectionStrings\": {\r\n    \"SaaSService\": \"User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=TaskySaaSService;Pooling=false;\",\r\n    \"IdentityService\": \"User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=TaskyIdentityService;Pooling=false;\",\r\n    \"AdministrationService\": \"User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=TaskyAdministrationService;Pooling=false;\",\r\n    \"ProjectService\": \"User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=TaskyProjectService;Pooling=false;\"\r\n  },\r\n  \"ApiScope\": [\r\n    \"AuthServer\",\r\n    \"SaaSService\",\r\n    \"IdentityService\",\r\n    \"AdministrationService\",\r\n    \"ProjectService\"\r\n  ],\r\n  \"ApiResource\": [\r\n    \"AuthServer\",\r\n    \"SaaSService\",\r\n    \"IdentityService\",\r\n    \"AdministrationService\",\r\n    \"ProjectService\"\r\n  ],\r\n  \"Clients\": [\r\n    {\r\n      \"ClientId\": \"Tasky_Web\",\r\n      \"ClientSecret\": \"1q2w3e*\",\r\n      \"RootUrls\": [\r\n        \"https://localhost:5000\"\r\n      ],\r\n      \"Scopes\": [\r\n        \"SaaSService\",\r\n        \"IdentityService\",\r\n        \"AdministrationService\",\r\n        \"ProjectService\"\r\n      ],\r\n      \"GrantTypes\": [\r\n        \"hybrid\"\r\n      ],\r\n      \"RedirectUris\": [\r\n        \"https://localhost:5000/signin-oidc\"\r\n      ],\r\n      \"PostLogoutRedirectUris\": [\r\n        \"https://localhost:5000/signout-callback-oidc\"\r\n      ],\r\n      \"AllowedCorsOrigins\": [\r\n        \"https://localhost:5000\"\r\n      ]\r\n    },\r\n    {\r\n      \"ClientId\": \"Tasky_App\",\r\n      \"ClientSecret\": \"1q2w3e*\",\r\n      \"RootUrls\": [\r\n        \"http://localhost:4200\"\r\n      ],\r\n      \"Scopes\": [\r\n        \"AuthServer\",\r\n        \"SaaSService\",\r\n        \"IdentityService\",\r\n        \"AdministrationService\",\r\n        \"ProjectService\"\r\n      ],\r\n      \"GrantTypes\": [\r\n        \"authorization_code\"\r\n      ],\r\n      \"RedirectUris\": [\r\n        \"http://localhost:4200\"\r\n      ],\r\n      \"PostLogoutRedirectUris\": [\r\n        \"http://localhost:4200\"\r\n      ],\r\n      \"AllowedCorsOrigins\": [\r\n        \"http://localhost:4200\"\r\n      ]\r\n    },\r\n    {\r\n      \"ClientId\": \"AdministrationService_Swagger\",\r\n      \"ClientSecret\": \"1q2w3e*\",\r\n      \"RootUrls\": [\r\n        \"https://localhost:7001\"\r\n      ],\r\n      \"Scopes\": [\r\n        \"SaaSService\",\r\n        \"IdentityService\",\r\n        \"AdministrationService\",\r\n        \"ProjectService\"\r\n      ],\r\n      \"GrantTypes\": [\r\n        \"authorization_code\"\r\n      ],\r\n      \"RedirectUris\": [\r\n        \"https://localhost:7001/swagger/oauth2-redirect.html\"\r\n      ],\r\n      \"PostLogoutRedirectUris\": [\r\n        \"https://localhost:7001/signout-callback-oidc\"\r\n      ],\r\n      \"AllowedCorsOrigins\": [\r\n        \"https://localhost:7001\"\r\n      ]\r\n    },\r\n    {\r\n      \"ClientId\": \"IdentityService_Swagger\",\r\n      \"ClientSecret\": \"1q2w3e*\",\r\n      \"RootUrls\": [\r\n        \"https://localhost:7002\"\r\n      ],\r\n      \"Scopes\": [\r\n        \"SaaSService\",\r\n        \"IdentityService\",\r\n        \"AdministrationService\",\r\n        \"ProjectService\"\r\n      ],\r\n      \"GrantTypes\": [\r\n        \"authorization_code\"\r\n      ],\r\n      \"RedirectUris\": [\r\n        \"https://localhost:7002/swagger/oauth2-redirect.html\"\r\n      ],\r\n      \"PostLogoutRedirectUris\": [\r\n        \"https://localhost:7002\"\r\n      ],\r\n      \"AllowedCorsOrigins\": [\r\n        \"https://localhost:7002\"\r\n      ]\r\n    },\r\n    {\r\n      \"ClientId\": \"SaaSService_Swagger\",\r\n      \"ClientSecret\": \"1q2w3e*\",\r\n      \"RootUrls\": [\r\n        \"https://localhost:7003\"\r\n      ],\r\n      \"Scopes\": [\r\n        \"SaaSService\",\r\n        \"IdentityService\",\r\n        \"AdministrationService\",\r\n        \"ProjectService\"\r\n      ],\r\n      \"GrantTypes\": [\r\n        \"authorization_code\"\r\n      ],\r\n      \"RedirectUris\": [\r\n        \"https://localhost:7003/swagger/oauth2-redirect.html\"\r\n      ],\r\n      \"PostLogoutRedirectUris\": [\r\n        \"https://localhost:7003\"\r\n      ],\r\n      \"AllowedCorsOrigins\": [\r\n        \"https://localhost:7003\"\r\n      ]\r\n    },\r\n    {\r\n      \"ClientId\": \"ProjectService_Swagger\",\r\n      \"ClientSecret\": \"1q2w3e*\",\r\n      \"RootUrls\": [\r\n        \"https://localhost:7004\"\r\n      ],\r\n      \"Scopes\": [\r\n        \"SaaSService\",\r\n        \"IdentityService\",\r\n        \"AdministrationService\",\r\n        \"ProjectService\"\r\n      ],\r\n      \"GrantTypes\": [\r\n        \"authorization_code\"\r\n      ],\r\n      \"RedirectUris\": [\r\n        \"https://localhost:7004/swagger/oauth2-redirect.html\"\r\n      ],\r\n      \"PostLogoutRedirectUris\": [\r\n        \"https://localhost:7004\"\r\n      ],\r\n      \"AllowedCorsOrigins\": [\r\n        \"https://localhost:7004\"\r\n      ]\r\n    }\r\n  ]\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "prepare-the-administration-service",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#prepare-the-administration-service",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Prepare the Administration service"]
    }), "\n", _jsxs(_components.p, {
      children: ["Add reference to the ", _jsx(_components.code, {
        children: "ProjectService.Application.Contracts"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "<ProjectReference Include=\"..\\..\\..\\project\\src\\Tasky.ProjectService.Application.Contracts\\Tasky.ProjectService.Application.Contracts.csproj\" />\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Update the dependency in the Admin Host"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "typeof(ProjectServiceApplicationContractsModule)\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Repo: https://github.com/antosubash/Tasky"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Docker and CI/CD</title>
          <link>https://blog.antosubash.com/posts/netcore-microservice-with-abp-docker-and-ci-cd-part-10</link>
          <guid>https://blog.antosubash.com/posts/netcore-microservice-with-abp-docker-and-ci-cd-part-10</guid>
          <pubDate>Sat, 26 Mar 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to add docker support and create a CI/CD with github actions</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    p: "p",
    a: "a",
    h2: "h2",
    span: "span",
    img: "img",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.p, {
      children: ["This is the part 10 of the series: ", _jsx(_components.a, {
        href: "/posts/abp-microservice-series",
        children: ".NET Microservice with ABP"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-init-part-1",
        children: "Part 1. Initial Setup"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-shared-project-part-2",
        children: "Part 2. Shared Project"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-administration-services-part-3",
        children: "Part 3. Administration Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-services-part-4",
        children: "Part 4. Identity Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-saas-services-part-5",
        children: "Part 5. SaaS Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-db-migration-part-6",
        children: "Part 6. DB Migration"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-yarp-and-tye-part-7",
        children: "Part 7. Yarp and Tye"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-server-and-angular-part-8",
        children: "Part 8. Identity server and Angular App"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-distributed-event-bus-part-9",
        children: "Part 9. Distributed event bus"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 10. Docker and CI/CD (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-new-service-part-11",
        children: "Part 11. Add a New service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-central-logging-part-12",
        children: "Part 12. Central Logging"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to add docker support to all the services and setup a CI/CD pipeline with github actions."
    }), "\n", _jsxs(_components.h2, {
      id: "docker-support",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#docker-support",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Docker support"]
    }), "\n", _jsx(_components.p, {
      children: "Docker support can be added easily by using visual studio. since all the project is available in the solution vs will create a Docker file and add it to the project. In this we will use the Identity server it will be similar for all the other services."
    }), "\n", _jsx(_components.p, {
      children: "To add Docker support right click on the Identity server project and choose add."
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/microservice/part10/docker0.png",
        alt: "Add Docker"
      })
    }), "\n", _jsx(_components.p, {
      children: "In the add menu choose docker support"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/microservice/part10/docker1.png",
        alt: "Add Menu"
      })
    }), "\n", _jsx(_components.p, {
      children: "In the docker file option choose linux"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/microservice/part10/docker2.png",
        alt: "Docker Options"
      })
    }), "\n", _jsx(_components.p, {
      children: "The final docker file will look like this. Here is the location of this sample file https://github.com/antosubash/AbpMicroservice/blob/main/apps/Tasky.IdentityServer/Dockerfile"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/microservice/part10/docker3.png",
        alt: "Docker file"
      })
    }), "\n", _jsx(_components.p, {
      children: "We have to do this to all the services."
    }), "\n", _jsxs(_components.h2, {
      id: "cicd",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#cicd",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "CI/CD"]
    }), "\n", _jsx(_components.p, {
      children: "Here is the sample github action file."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "name: Docker Image CI\r\n\r\non:\r\n  push:\r\n    branches: [ main ]\r\n  pull_request:\r\n    branches: [ main ]\r\n\r\njobs:\r\n\r\n  build:\r\n\r\n    runs-on: ubuntu-latest\r\n\r\n    steps:\r\n    - uses: actions/checkout@v2\r\n    - name: Build the Gateway Docker image\r\n      run: docker build . --file gateway/Tasky.Gateway/Dockerfile --tag gateway:dev\r\n    - name: Build the IdentityServer Docker image\r\n      run: docker build . --file apps/Tasky.IdentityServer/Dockerfile --tag identityserver:dev\r\n    - name: Build the Administration Docker image\r\n      run: docker build . --file services/administration/host/Tasky.AdministrationService.HttpApi.Host/Dockerfile --tag administration:dev\r\n    - name: Build the IdentityService Docker image\r\n      run: docker build . --file services/identity/host/Tasky.IdentityService.HttpApi.Host/Dockerfile --tag identityservice:dev\r\n    - name: Build the SaaS Docker image\r\n      run: docker build . --file services/saas/host/Tasky.SaaSService.HttpApi.Host/Dockerfile --tag saas:dev\n"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Distributed Event Bus</title>
          <link>https://blog.antosubash.com/posts/netcore-microservice-with-abp-distributed-event-bus-part-9</link>
          <guid>https://blog.antosubash.com/posts/netcore-microservice-with-abp-distributed-event-bus-part-9</guid>
          <pubDate>Fri, 25 Mar 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to get the RabbitMQ working for service to service communication</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    p: "p",
    a: "a",
    h2: "h2",
    span: "span",
    h3: "h3",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.p, {
      children: ["This is the part 9 of the series: ", _jsx(_components.a, {
        href: "/posts/abp-microservice-series",
        children: ".NET Microservice with ABP"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-init-part-1",
        children: "Part 1. Initial Setup"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-shared-project-part-2",
        children: "Part 2. Shared Project"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-administration-services-part-3",
        children: "Part 3. Administration Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-services-part-4",
        children: "Part 4. Identity Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-saas-services-part-5",
        children: "Part 5. SaaS Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-db-migration-part-6",
        children: "Part 6. DB Migration"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-yarp-and-tye-part-7",
        children: "Part 7. Yarp and Tye"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-server-and-angular-part-8",
        children: "Part 8. Identity server and Angular App"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 9. Distributed event bus (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-docker-and-ci-cd-part-10",
        children: "Part 10. Docker and CI/CD"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-new-service-part-11",
        children: "Part 11. Add a New service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-central-logging-part-12",
        children: "Part 12. Central Logging"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post, we will see how to set up service-to-service communication. We will use RabbitMQ as an event bus. Each service will have a RabbitMQ configuration. ABP comes with the inbuilt support to use the RabbitMQ for events. The packages are already available in the shared project we created in part 2. We just have to add the configuration in the appsettings and implement the events."
    }), "\n", _jsxs(_components.h2, {
      id: "update-appsettingsjson",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-appsettingsjson",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update appsettings.json"]
    }), "\n", _jsxs(_components.h3, {
      id: "administration-service",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#administration-service",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Administration service"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "\"RabbitMQ\": {\r\n  \"Connections\": {\r\n    \"Default\": {\r\n      \"HostName\": \"localhost\"\r\n    }\r\n  },\r\n  \"EventBus\": {\r\n    \"ClientName\": \"Tasky_Administration\",\r\n    \"ExchangeName\": \"Tasky\"\r\n  }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "identity-service",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#identity-service",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Identity service"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "\"RabbitMQ\": {\r\n  \"Connections\": {\r\n    \"Default\": {\r\n      \"HostName\": \"localhost\"\r\n    }\r\n  },\r\n  \"EventBus\": {\r\n    \"ClientName\": \"Tasky_Identity\",\r\n    \"ExchangeName\": \"Tasky\"\r\n  }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "saas-service",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#saas-service",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "SaaS service"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "\"RabbitMQ\": {\r\n  \"Connections\": {\r\n    \"Default\": {\r\n      \"HostName\": \"localhost\"\r\n    }\r\n  },\r\n  \"EventBus\": {\r\n    \"ClientName\": \"Tasky_SaaS\",\r\n    \"ExchangeName\": \"Tasky\"\r\n  }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "identity-server",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#identity-server",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Identity Server"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "\"RabbitMQ\": {\r\n  \"Connections\": {\r\n    \"Default\": {\r\n      \"HostName\": \"localhost\"\r\n    }\r\n  },\r\n  \"EventBus\": {\r\n    \"ClientName\": \"Tasky_AuthServer\",\r\n    \"ExchangeName\": \"Tasky\"\r\n  }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "tenant-created-event-handlers-for-administration-service",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#tenant-created-event-handlers-for-administration-service",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Tenant Created Event handlers for Administration Service"]
    }), "\n", _jsx(_components.p, {
      children: "When the tenant is created in the SaaS service, the administration service needs to know about the newly created tenant so that we can add permission for the new tenant. This permission is given to the admin role. So that when the user is created with the admin role then he can log in to the newly created tenant. The tenant management module triggers a tenant-created event every time a tenant is created. We don't have to do anything extra in our code. We just have to handle the created event. Following is how you can manage the tenant-created event."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using System;\r\nusing System.Linq;\r\nusing System.Threading.Tasks;\r\nusing Microsoft.Extensions.Logging;\r\nusing Volo.Abp.Authorization.Permissions;\r\nusing Volo.Abp.DependencyInjection;\r\nusing Volo.Abp.EventBus.Distributed;\r\nusing Volo.Abp.MultiTenancy;\r\nusing Volo.Abp.PermissionManagement;\r\nusing Volo.Abp.Uow;\r\n\r\nnamespace Tasky.Administration.EventHandler;\r\n\r\npublic class TenantCreatedEventHandler : IDistributedEventHandler<TenantCreatedEto>, ITransientDependency\r\n{\r\n    private readonly ICurrentTenant _currentTenant;\r\n    private readonly ILogger<TenantCreatedEventHandler> _logger;\r\n    private readonly IPermissionDataSeeder _permissionDataSeeder;\r\n    private readonly IPermissionDefinitionManager _permissionDefinitionManager;\r\n    private readonly IUnitOfWorkManager _unitOfWorkManager;\r\n\r\n    public TenantCreatedEventHandler(\r\n        ICurrentTenant currentTenant,\r\n        IUnitOfWorkManager unitOfWorkManager,\r\n        IPermissionDefinitionManager permissionDefinitionManager,\r\n        IPermissionDataSeeder permissionDataSeeder,\r\n        ILogger<TenantCreatedEventHandler> logger)\r\n    {\r\n        _currentTenant = currentTenant;\r\n        _unitOfWorkManager = unitOfWorkManager;\r\n        _permissionDefinitionManager = permissionDefinitionManager;\r\n        _permissionDataSeeder = permissionDataSeeder;\r\n        _logger = logger;\r\n    }\r\n\r\n    public async Task HandleEventAsync(TenantCreatedEto eventData)\r\n    {\r\n        try\r\n        {\r\n            await SeedDataAsync(eventData.Id);\r\n        }\r\n        catch (Exception ex)\r\n        {\r\n            await HandleErrorTenantCreatedAsync(eventData, ex);\r\n        }\r\n    }\r\n\r\n    private Task HandleErrorTenantCreatedAsync(TenantCreatedEto eventData, Exception ex)\r\n    {\r\n        throw new NotImplementedException();\r\n    }\r\n\r\n    private async Task SeedDataAsync(Guid? tenantId)\r\n    {\r\n        _logger.LogInformation($\"Seeding ${tenantId}\");\r\n        using (_currentTenant.Change(tenantId))\r\n        {\r\n            var abpUnitOfWorkOptions = new AbpUnitOfWorkOptions {IsTransactional = true};\r\n            using var uow = _unitOfWorkManager.Begin(abpUnitOfWorkOptions, true);\r\n            var multiTenancySide = tenantId is null\r\n                ? MultiTenancySides.Host\r\n                : MultiTenancySides.Tenant;\r\n\r\n            var permissionNames = _permissionDefinitionManager\r\n                .GetPermissions()\r\n                .Where(p => p.MultiTenancySide.HasFlag(multiTenancySide))\r\n                .Where(p => !p.Providers.Any() || p.Providers.Contains(RolePermissionValueProvider.ProviderName))\r\n                .Select(p => p.Name)\r\n                .ToArray();\r\n\r\n            await _permissionDataSeeder.SeedAsync(\r\n                RolePermissionValueProvider.ProviderName,\r\n                \"admin\",\r\n                permissionNames,\r\n                tenantId\r\n            );\r\n\r\n            await uow.CompleteAsync();\r\n        }\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "tenant-created-event-handlers-for-identity-service",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#tenant-created-event-handlers-for-identity-service",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Tenant Created Event handlers for Identity Service"]
    }), "\n", _jsx(_components.p, {
      children: "Similar to what we have done in the administration service. we need to handle the tenant created event in the identity service to create the admin user for the newly created tenant. we can create the event handler and seed the user with the default username and password."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using System;\r\nusing System.Threading.Tasks;\r\nusing Microsoft.Extensions.Logging;\r\nusing Volo.Abp.DependencyInjection;\r\nusing Volo.Abp.EventBus.Distributed;\r\nusing Volo.Abp.MultiTenancy;\r\nusing Volo.Abp.Identity;\r\nusing System.Collections.Generic;\r\n\r\nnamespace Tasky.IdentityService.EventHandler;\r\n\r\npublic class TenantCreatedEventHandler : IDistributedEventHandler<TenantCreatedEto>, ITransientDependency\r\n{\r\n    private readonly ICurrentTenant _currentTenant;\r\n    private readonly ILogger<TenantCreatedEventHandler> _logger;\r\n    private readonly IIdentityDataSeeder _identityDataSeeder;\r\n    public TenantCreatedEventHandler(\r\n        ICurrentTenant currentTenant,\r\n        IIdentityDataSeeder identityDataSeeder,\r\n        ILogger<TenantCreatedEventHandler> logger)\r\n    {\r\n        _currentTenant = currentTenant;\r\n        _identityDataSeeder = identityDataSeeder;\r\n        _logger = logger;\r\n    }\r\n\r\n    public async Task HandleEventAsync(TenantCreatedEto eventData)\r\n    {\r\n        try\r\n        {\r\n            using (_currentTenant.Change(eventData.Id))\r\n            {\r\n                \r\n                _logger.LogInformation($\"Creating admin user for tenant {eventData.Id}...\");\r\n                await _identityDataSeeder.SeedAsync(\r\n                    eventData.Properties.GetOrDefault(IdentityDataSeedContributor.AdminEmailPropertyName) ?? \"admin@abp.io\",\r\n                    eventData.Properties.GetOrDefault(IdentityDataSeedContributor.AdminPasswordPropertyName) ?? \"1q2w3E*\",\r\n                    eventData.Id\r\n                );\r\n            }\r\n        }\r\n        catch (Exception ex)\r\n        {\r\n            await HandleErrorTenantCreatedAsync(eventData, ex);\r\n        }\r\n    }\r\n\r\n    private Task HandleErrorTenantCreatedAsync(TenantCreatedEto eventData, Exception ex)\r\n    {\r\n        throw new NotImplementedException();\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "run",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run"]
    }), "\n", _jsx(_components.p, {
      children: "Use tye to run all the services. When the service starts it will create the queue in the RabbitMQ. So make sure you have RabbitMQ running."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "tye run\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "test",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#test",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Test"]
    }), "\n", _jsxs(_components.p, {
      children: ["To test the event bus. Login to the angular app in ", _jsx(_components.code, {
        children: "http://localhost:4200"
      }), " as admin and create a new tenant. Once the tenant is created logout and try to login to the tenant you just created. if the event bus is working then you can login with default username and password for the newly created tenant."]
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>IdentityServer and Angular</title>
          <link>https://blog.antosubash.com/posts/netcore-microservice-with-abp-identity-server-and-angular-part-8</link>
          <guid>https://blog.antosubash.com/posts/netcore-microservice-with-abp-identity-server-and-angular-part-8</guid>
          <pubDate>Sun, 20 Mar 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to get the IdentityServer and the Angular App working with other services</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    p: "p",
    a: "a",
    h2: "h2",
    span: "span",
    h3: "h3",
    code: "code",
    pre: "pre",
    h4: "h4",
    blockquote: "blockquote"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.p, {
      children: ["This is eight post of the series: ", _jsx(_components.a, {
        href: "/posts/abp-microservice-series",
        children: ".NET Microservice with ABP"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-init-part-1",
        children: "Part 1. Initial Setup"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-shared-project-part-2",
        children: "Part 2. Shared Project"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-administration-services-part-3",
        children: "Part 3. Administration Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-services-part-4",
        children: "Part 4. Identity Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-saas-services-part-5",
        children: "Part 5. SaaS Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-db-migration-part-6",
        children: "Part 6. DB Migration"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-yarp-and-tye-part-7",
        children: "Part 7. Yarp and Tye"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 8. Identity server and Angular App (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-distributed-event-bus-part-9",
        children: "Part 9. Distributed event bus"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-docker-and-ci-cd-part-10",
        children: "Part 10. Docker and CI/CD"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-new-service-part-11",
        children: "Part 11. Add a New service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-central-logging-part-12",
        children: "Part 12. Central Logging"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "We have copied the IdentityServer and Angular app from the default tired app. So they are configured to work with the tired app. we will modify the Identity server to use the newly created services and the change the config of the angular app to use the Reverse proxy we created with Yarp."
    }), "\n", _jsxs(_components.h2, {
      id: "identityserver",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#identityserver",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "IdentityServer"]
    }), "\n", _jsxs(_components.p, {
      children: ["Even thought we already have the Identity service. it only provides the API endpoints to manage the user. We need the Identity server to do the JWT auth and also for the login and registration. IdentityServer is the default way to login user in the ABP framework right now. But there are plans to replace IdentityServer and replace it with the ", _jsx(_components.a, {
        href: "https://github.com/openiddict/openiddict-core",
        children: "OpenIdDict"
      }), " if you want to know more about this go and check here https://github.com/abpframework/abp/issues/11989"]
    }), "\n", _jsxs(_components.h3, {
      id: "remove-the-wrong-reference",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#remove-the-wrong-reference",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Remove the wrong reference"]
    }), "\n", _jsxs(_components.p, {
      children: ["During the code generation by default Identity server will have the reference for the ", _jsx(_components.code, {
        children: "EFCore"
      }), " project. But after moving the Identity server this reference will be wrong. So the first step is to remove all the project reference in the ", _jsx(_components.code, {
        children: "csproj"
      }), " file of the identity server."]
    }), "\n", _jsxs(_components.h3, {
      id: "add-new-reference",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-new-reference",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add new reference"]
    }), "\n", _jsxs(_components.p, {
      children: ["Once the old references are removed we need to add the new reference to the identity server project. The Identity server should know about all 3 base services ", _jsx(_components.code, {
        children: "identity"
      }), ", ", _jsx(_components.code, {
        children: "administration"
      }), " and ", _jsx(_components.code, {
        children: "saas"
      }), ". So we need to add the reference for the ", _jsx(_components.code, {
        children: "EFCore"
      }), " projects of all the 3 services. Along with we also need to add the reference for the Shared project so that we can reuse some code."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<ItemGroup>\r\n    <ProjectReference Include=\"..\\..\\services\\administration\\src\\Tasky.AdministrationService.EntityFrameworkCore\\Tasky.AdministrationService.EntityFrameworkCore.csproj\" />\r\n    <ProjectReference Include=\"..\\..\\services\\identity\\src\\Tasky.IdentityService.EntityFrameworkCore\\Tasky.IdentityService.EntityFrameworkCore.csproj\" />\r\n    <ProjectReference Include=\"..\\..\\services\\saas\\src\\Tasky.SaaSService.EntityFrameworkCore\\Tasky.SaaSService.EntityFrameworkCore.csproj\" />\r\n    <ProjectReference Include=\"..\\..\\shared\\Tasky.Shared.Hosting\\Tasky.Shared.Hosting.csproj\" />\r\n</ItemGroup>\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-connection-string",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-connection-string",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the connection string"]
    }), "\n", _jsxs(_components.p, {
      children: ["Once we added the reference to the ", _jsx(_components.code, {
        children: "EFCore"
      }), " projects we need to add the connection string for the services in the ", _jsx(_components.code, {
        children: "appsettings.json"
      }), " file so that the Identity server can find the database."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "\"ConnectionStrings\": {\r\n  \"SaaSService\": \"User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=TaskySaaSService;Pooling=false;\",\r\n  \"IdentityService\": \"User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=TaskyIdentityService;Pooling=false;\",\r\n  \"AdministrationService\": \"User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=TaskyAdministrationService;Pooling=false;\"\r\n},\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-cors-urls",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-cors-urls",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update CORS urls"]
    }), "\n", _jsxs(_components.p, {
      children: ["All the services and apps need to contact the Identity server to validate the tokens. so we should add the urls of the service in the ", _jsx(_components.code, {
        children: "CorsOrigins"
      }), " section of the ", _jsx(_components.code, {
        children: "appsettings.json"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "\"CorsOrigins\": \"http://localhost:4200,https://localhost:7001,https://localhost:7002,https://localhost:7003\",\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-authority-url",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-authority-url",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the Authority URL"]
    }), "\n", _jsxs(_components.p, {
      children: ["All the service has ", _jsx(_components.code, {
        children: "Authority"
      }), " url in the ", _jsx(_components.code, {
        children: "appsettings.json"
      }), " file. we have to change that file to point to the identity server."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "\"Authority\": \"https://localhost:7000/\",\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-module-dependency",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-module-dependency",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the module dependency"]
    }), "\n", _jsxs(_components.p, {
      children: ["Identity server project should have a ", _jsx(_components.code, {
        children: "IdentityServerModule"
      }), " in the root of the project directory. In that module we need update the module dependency so that the ", _jsx(_components.code, {
        children: "EFCore"
      }), " modules will be loaded correctly. We also should add the shared module."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "typeof(AbpAccountWebIdentityServerModule),\r\ntypeof(AbpAccountApplicationModule),\r\ntypeof(AbpAccountHttpApiModule),\r\ntypeof(AbpAspNetCoreMvcUiBasicThemeModule),\r\ntypeof(AdministrationServiceEntityFrameworkCoreModule),\r\ntypeof(SaaSServiceEntityFrameworkCoreModule),\r\ntypeof(IdentityServiceEntityFrameworkCoreModule),\r\ntypeof(TaskyHostingModule)\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Once this is done. our identity server is ready for our use. launch the identity server and see if you can login as a super admin."
    }), "\n", _jsxs(_components.h3, {
      id: "running-identity-server",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#running-identity-server",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Running Identity server"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This should launch the identity server and it should be running in the port ", _jsx(_components.code, {
        children: "7000"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "angular-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#angular-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Angular App"]
    }), "\n", _jsxs(_components.p, {
      children: ["angular app in abp is a self contained app. there is not dependency to any other abp project. so to run the we just have to point the angular app in the correct direction and it should work. We need to change 2 things in the angular app. one is the ", _jsx(_components.code, {
        children: "OAuthConfig"
      }), " so that it know where is the identity server is running and the ", _jsx(_components.code, {
        children: "API"
      }), " endpoint which is the reverse proxy in our case which has all the endpoints. you will be able to find the ", _jsx(_components.code, {
        children: "environment.ts"
      }), " file in ", _jsx(_components.code, {
        children: "apps\\angular\\src\\environments"
      }), "."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-ts",
        children: "import { Environment } from '@abp/ng.core';\r\n\r\nconst baseUrl = 'http://localhost:4200';\r\n\r\nexport const environment = {\r\n  production: false,\r\n  application: {\r\n    baseUrl: 'http://localhost:4200/',\r\n    name: 'Tasky',\r\n    logoUrl: '',\r\n  },\r\n  oAuthConfig: {\r\n    issuer: 'https://localhost:7000',\r\n    redirectUri: baseUrl,\r\n    clientId: 'Tasky_App',\r\n    responseType: 'code',\r\n    scope: 'offline_access IdentityService AdministrationService SaaSService role email openid profile',\r\n    requireHttps: true\r\n  },\r\n  apis: {\r\n    default: {\r\n      url: 'https://localhost:7500',\r\n      rootNamespace: 'Tasky',\r\n    }\r\n  },\r\n} as Environment;\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "run",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run"]
    }), "\n", _jsxs(_components.p, {
      children: ["Once you have updated the ", _jsx(_components.code, {
        children: "environment.ts"
      }), " make sure the packages are installed for your angular app."]
    }), "\n", _jsxs(_components.h4, {
      id: "to-install-packages",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#to-install-packages",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "To install packages"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "yarn\n"
      })
    }), "\n", _jsxs(_components.blockquote, {
      children: ["\n", _jsx(_components.p, {
        children: "you need to have yarn installed for this command to work"
      }), "\n"]
    }), "\n", _jsx(_components.p, {
      children: "This command will install all the packages needed for your angular app."
    }), "\n", _jsxs(_components.h4, {
      id: "to-run",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#to-run",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "To Run"]
    }), "\n", _jsx(_components.p, {
      children: "To run the angular app run the following command"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "yarn start\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will start the angular dev server and your application will be running in the port ", _jsx(_components.code, {
        children: "4200"
      }), "."]
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Yarp and Tye</title>
          <link>https://blog.antosubash.com/posts/netcore-microservice-with-abp-yarp-and-tye-part-7</link>
          <guid>https://blog.antosubash.com/posts/netcore-microservice-with-abp-yarp-and-tye-part-7</guid>
          <pubDate>Sat, 19 Mar 2022 05:00:00 GMT</pubDate>
          <description>In this post we will see how to create a reverse proxy with Yarp and integrate Tye for our microservice application</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    p: "p",
    a: "a",
    h2: "h2",
    span: "span",
    h3: "h3",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.p, {
      children: ["This is seventh post of the series: ", _jsx(_components.a, {
        href: "/posts/abp-microservice-series",
        children: ".NET Microservice with ABP"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-init-part-1",
        children: "Part 1. Initial Setup"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-shared-project-part-2",
        children: "Part 2. Shared Project"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-administration-services-part-3",
        children: "Part 3. Administration Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-services-part-4",
        children: "Part 4. Identity Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-saas-services-part-5",
        children: "Part 5. SaaS Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-db-migration-part-6",
        children: "Part 6. DB Migration"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 7. Yarp and Tye (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-server-and-angular-part-8",
        children: "Part 8. Identity server and Angular App"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-distributed-event-bus-part-9",
        children: "Part 9. Distributed event bus"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-docker-and-ci-cd-part-10",
        children: "Part 10. Docker and CI/CD"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-new-service-part-11",
        children: "Part 11. Add a New service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-central-logging-part-12",
        children: "Part 12. Central Logging"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "tye",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#tye",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Tye"]
    }), "\n", _jsx(_components.p, {
      children: "Lets init the tye."
    }), "\n", _jsxs(_components.h3, {
      id: "install-tye",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-tye",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install tye"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet tool install -g Microsoft.Tye --version \"0.11.0-alpha.22111.1\"\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "init-tye",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#init-tye",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Init Tye"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "tye init --force\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will generate a ", _jsx(_components.code, {
        children: "tye.yaml"
      }), " file."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "name: tasky\r\nservices:\r\n- name: tasky-identityserver\r\n  project: apps/Tasky.IdentityServer/Tasky.IdentityServer.csproj\r\n  bindings:\r\n    - protocol: https\r\n      port: 7000\r\n- name: tasky-gateway\r\n  project: gateway/Tasky.Gateway/Tasky.Gateway.csproj\r\n  bindings:\r\n    - protocol: https\r\n      port: 7500\r\n- name: tasky-administrationservice-httpapi-host\r\n  project: services/administration/host/Tasky.AdministrationService.HttpApi.Host/Tasky.AdministrationService.HttpApi.Host.csproj\r\n  bindings:\r\n    - protocol: https\r\n      port: 7001\r\n- name: tasky-identityservice-httpapi-host\r\n  project: services/identity/host/Tasky.IdentityService.HttpApi.Host/Tasky.IdentityService.HttpApi.Host.csproj\r\n  bindings:\r\n    - protocol: https\r\n      port: 7002\r\n- name: tasky-saasservice-httpapi-host\r\n  project: services/saas/host/Tasky.SaaSService.HttpApi.Host/Tasky.SaaSService.HttpApi.Host.csproj\r\n  bindings:\r\n    - protocol: https\r\n      port: 7003\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "run-tye",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-tye",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run Tye"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "tye run --watch\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "yarp",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#yarp",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Yarp"]
    }), "\n", _jsxs(_components.p, {
      children: ["Yarp is our proxy server which will redirect the request to other services. So lets update the ", _jsx(_components.code, {
        children: "Tasky.Gateway"
      }), "."]
    }), "\n", _jsxs(_components.h3, {
      id: "install-nuget",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-nuget",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install nuget"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<PackageReference Include=\"Yarp.ReverseProxy\" Version=\"1.0.0\" />\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-programcs",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-programcs",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the Program.cs"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "var builder = WebApplication.CreateBuilder(args);\r\nbuilder.Services.AddReverseProxy()\r\n    .LoadFromConfig(builder.Configuration.GetSection(\"ReverseProxy\"));\r\nvar app = builder.Build();\r\napp.MapReverseProxy();\r\napp.Run();\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-appsettingsjson",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-appsettingsjson",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update appsettings.json"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "{\r\n  \"Logging\": {\r\n    \"LogLevel\": {\r\n      \"Default\": \"Information\",\r\n      \"Microsoft.AspNetCore\": \"Warning\"\r\n    }\r\n  },\r\n  \"AllowedHosts\": \"*\",\r\n  \"ReverseProxy\": {\r\n    \"Routes\": {\r\n      \"main\": {\r\n        \"ClusterId\": \"main\",\r\n        \"Match\": {\r\n          \"Path\": \"{**catch-all}\"\r\n        }\r\n      },\r\n      \"identity\": {\r\n        \"ClusterId\": \"identity\",\r\n        \"Match\": {\r\n          \"Path\": \"/api/identity/{*any}\"\r\n        }\r\n      },\r\n      \"account\": {\r\n        \"ClusterId\": \"account\",\r\n        \"Match\": {\r\n          \"Path\": \"/api/account/{*any}\"\r\n        }\r\n      },\r\n      \"saas\": {\r\n        \"ClusterId\": \"saas\",\r\n        \"Match\": {\r\n          \"Path\": \"/api/multi-tenancy/{*any}\"\r\n        }\r\n      }\r\n    },\r\n    \"Clusters\": {\r\n      \"main\": {\r\n        \"Destinations\": {\r\n          \"main\": {\r\n            \"Address\": \"https://localhost:7001\"\r\n          }\r\n        }\r\n      },\r\n      \"identity\": {\r\n        \"Destinations\": {\r\n          \"identity\": {\r\n            \"Address\": \"https://localhost:7002\"\r\n          }\r\n        }\r\n      },\r\n      \"account\": {\r\n        \"Destinations\": {\r\n          \"account\": {\r\n            \"Address\": \"https://localhost:7002\"\r\n          }\r\n        }\r\n      },\r\n      \"saas\": {\r\n        \"Destinations\": {\r\n          \"saas\": {\r\n            \"Address\": \"https://localhost:7003\"\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\n"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>DbMigration</title>
          <link>https://blog.antosubash.com/posts/netcore-microservice-with-abp-db-migration-part-6</link>
          <guid>https://blog.antosubash.com/posts/netcore-microservice-with-abp-db-migration-part-6</guid>
          <pubDate>Sat, 19 Mar 2022 04:00:00 GMT</pubDate>
          <description>In this post we will see how to create migration project for our microservice application</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    p: "p",
    a: "a",
    h2: "h2",
    span: "span",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.p, {
      children: ["This is sixth post of the series: ", _jsx(_components.a, {
        href: "/posts/abp-microservice-series",
        children: ".NET Microservice with ABP"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-init-part-1",
        children: "Part 1. Initial Setup"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-shared-project-part-2",
        children: "Part 2. Shared Project"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-administration-services-part-3",
        children: "Part 3. Administration Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-services-part-4",
        children: "Part 4. Identity Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-saas-services-part-5",
        children: "Part 5. SaaS Service"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 6. DB Migration (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-yarp-and-tye-part-7",
        children: "Part 7. Yarp and Tye"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-server-and-angular-part-8",
        children: "Part 8. Identity server and Angular App"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-distributed-event-bus-part-9",
        children: "Part 9. Distributed event bus"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-docker-and-ci-cd-part-10",
        children: "Part 10. Docker and CI/CD"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-new-service-part-11",
        children: "Part 11. Add a New service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-central-logging-part-12",
        children: "Part 12. Central Logging"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "add-the-references",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-the-references",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add the references"]
    }), "\n", _jsx(_components.p, {
      children: "For migrations we need to first add contracts and EF core projects as a reference in the db migrator. We need to do this for all the services."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "    <ItemGroup>\r\n        <ProjectReference Include=\"..\\..\\services\\AdministrationService\\src\\Tasky.AdministrationService.Application.Contracts\\Tasky.AdministrationService.Application.Contracts.csproj\"/>\r\n        <ProjectReference Include=\"..\\..\\services\\AdministrationService\\src\\Tasky.AdministrationService.EntityFrameworkCore\\Tasky.AdministrationService.EntityFrameworkCore.csproj\"/>\r\n        <ProjectReference Include=\"..\\..\\services\\identity\\src\\Tasky.IdentityService.Application.Contracts\\Tasky.IdentityService.Application.Contracts.csproj\"/>\r\n        <ProjectReference Include=\"..\\..\\services\\identity\\src\\Tasky.IdentityService.EntityFrameworkCore\\Tasky.IdentityService.EntityFrameworkCore.csproj\"/>\r\n        <ProjectReference Include=\"..\\..\\services\\SaaSService\\src\\Tasky.SaaSService.Application.Contracts\\Tasky.SaaSService.Application.Contracts.csproj\"/>\r\n        <ProjectReference Include=\"..\\..\\services\\SaaSService\\src\\Tasky.SaaSService.EntityFrameworkCore\\Tasky.SaaSService.EntityFrameworkCore.csproj\"/>\r\n    </ItemGroup>\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["We are adding ", _jsx(_components.code, {
        children: "EntityFrameworkCore"
      }), " and ", _jsx(_components.code, {
        children: "Contracts"
      }), " projects to the DbMigrations project."]
    }), "\n", _jsxs(_components.h2, {
      id: "create-dbmigrationservice",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-dbmigrationservice",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create ", _jsx(_components.code, {
        children: "DbMigrationService"
      })]
    }), "\n", _jsx(_components.p, {
      children: "Db migration service is where we can manage the migration and seeding of data of all the services in a single location."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using System;\r\nusing System.Collections.Generic;\r\nusing System.Threading;\r\nusing System.Threading.Tasks;\r\nusing Microsoft.EntityFrameworkCore;\r\nusing Microsoft.Extensions.DependencyInjection;\r\nusing Microsoft.Extensions.Logging;\r\nusing Tasky.AdministrationService.EntityFrameworkCore;\r\nusing Tasky.IdentityService.EntityFrameworkCore;\r\nusing Tasky.SaaSService.EntityFrameworkCore;\r\nusing Volo.Abp.Data;\r\nusing Volo.Abp.DependencyInjection;\r\nusing Volo.Abp.EntityFrameworkCore;\r\nusing Volo.Abp.Identity;\r\nusing Volo.Abp.MultiTenancy;\r\nusing Volo.Abp.TenantManagement;\r\nusing Volo.Abp.Uow;\r\n\r\nnamespace Tasky.DbMigrator;\r\n\r\npublic class TaskyDbMigrationService : ITransientDependency\r\n{\r\n    private readonly ICurrentTenant _currentTenant;\r\n    private readonly IDataSeeder _dataSeeder;\r\n    private readonly ILogger<TaskyDbMigrationService> _logger;\r\n    private readonly ITenantRepository _tenantRepository;\r\n    private readonly IUnitOfWorkManager _unitOfWorkManager;\r\n\r\n    public TaskyDbMigrationService(\r\n        ILogger<TaskyDbMigrationService> logger,\r\n        ITenantRepository tenantRepository,\r\n        IDataSeeder dataSeeder,\r\n        ICurrentTenant currentTenant,\r\n        IUnitOfWorkManager unitOfWorkManager)\r\n    {\r\n        _logger = logger;\r\n        _tenantRepository = tenantRepository;\r\n        _dataSeeder = dataSeeder;\r\n        _currentTenant = currentTenant;\r\n        _unitOfWorkManager = unitOfWorkManager;\r\n    }\r\n\r\n    public async Task MigrateAsync(CancellationToken cancellationToken)\r\n    {\r\n        await MigrateHostAsync(cancellationToken);\r\n        await MigrateTenantsAsync(cancellationToken);\r\n        _logger.LogInformation(\"Migration completed!\");\r\n    }\r\n\r\n    private async Task MigrateHostAsync(CancellationToken cancellationToken)\r\n    {\r\n        _logger.LogInformation(\"Migrating Host side...\");\r\n        await MigrateAllDatabasesAsync(null, cancellationToken);\r\n        await SeedDataAsync();\r\n    }\r\n\r\n    private async Task MigrateTenantsAsync(CancellationToken cancellationToken)\r\n    {\r\n        _logger.LogInformation(\"Migrating tenants...\");\r\n\r\n        var tenants =\r\n            await _tenantRepository.GetListAsync(includeDetails: true, cancellationToken: cancellationToken);\r\n        var migratedDatabaseSchemas = new HashSet<string>();\r\n        foreach (var tenant in tenants)\r\n        {\r\n            using (_currentTenant.Change(tenant.Id))\r\n            {\r\n                // Database schema migration\r\n                var connectionString = tenant.FindDefaultConnectionString();\r\n                if (!connectionString.IsNullOrWhiteSpace() && //tenant has a separate database\r\n                    !migratedDatabaseSchemas.Contains(connectionString)) //the database was not migrated yet\r\n                {\r\n                    _logger.LogInformation($\"Migrating tenant database: {tenant.Name} ({tenant.Id})\");\r\n                    await MigrateAllDatabasesAsync(tenant.Id, cancellationToken);\r\n                    migratedDatabaseSchemas.AddIfNotContains(connectionString);\r\n                }\r\n\r\n                //Seed data\r\n                _logger.LogInformation($\"Seeding tenant data: {tenant.Name} ({tenant.Id})\");\r\n                await SeedDataAsync();\r\n            }\r\n        }\r\n    }\r\n\r\n    private async Task MigrateAllDatabasesAsync(\r\n        Guid? tenantId,\r\n        CancellationToken cancellationToken)\r\n    {\r\n        using (var uow = _unitOfWorkManager.Begin(true))\r\n        {\r\n            if (tenantId == null)\r\n            {\r\n                /* SaaSService schema should only be available in the host side */\r\n                await MigrateDatabaseAsync<SaaSServiceDbContext>(cancellationToken);\r\n            }\r\n\r\n            await MigrateDatabaseAsync<AdministrationServiceDbContext>(cancellationToken);\r\n            await MigrateDatabaseAsync<IdentityServiceDbContext>(cancellationToken);\r\n\r\n            await uow.CompleteAsync(cancellationToken);\r\n        }\r\n\r\n        _logger.LogInformation(\r\n            $\"All databases have been successfully migrated ({(tenantId.HasValue ? $\"tenantId: {tenantId}\" : \"HOST\")}).\");\r\n    }\r\n\r\n    private async Task MigrateDatabaseAsync<TDbContext>(\r\n        CancellationToken cancellationToken)\r\n        where TDbContext : DbContext, IEfCoreDbContext\r\n    {\r\n        _logger.LogInformation($\"Migrating {typeof(TDbContext).Name.RemovePostFix(\"DbContext\")} database...\");\r\n\r\n        var dbContext = await _unitOfWorkManager.Current.ServiceProvider\r\n            .GetRequiredService<IDbContextProvider<TDbContext>>()\r\n            .GetDbContextAsync();\r\n\r\n        await dbContext\r\n            .Database\r\n            .MigrateAsync(cancellationToken);\r\n    }\r\n\r\n    private async Task SeedDataAsync()\r\n    {\r\n        await _dataSeeder.SeedAsync(\r\n            new DataSeedContext(_currentTenant.Id)\r\n                .WithProperty(IdentityDataSeedContributor.AdminEmailPropertyName, \"admin@abp.io\")\r\n                .WithProperty(IdentityDataSeedContributor.AdminPasswordPropertyName, \"1q2w3E*\")\r\n        );\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-appsettingsjson",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-appsettingsjson",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update appsettings.json"]
    }), "\n", _jsxs(_components.p, {
      children: ["The appsettings has a different structure form the normal structure you will usually see in the abp projects. We use this as a data source to seed the ", _jsx(_components.code, {
        children: "ApiScope"
      }), ", ", _jsx(_components.code, {
        children: "ApiResource"
      }), " and ", _jsx(_components.code, {
        children: "Identity server clients"
      }), "."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "{\r\n  \"ConnectionStrings\": {\r\n    \"SaaSService\": \"User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=TaskySaaSService;Pooling=false;\",\r\n    \"IdentityService\": \"User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=TaskyIdentityService;Pooling=false;\",\r\n    \"AdministrationService\": \"User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=TaskyAdministrationService;Pooling=false;\"\r\n  },\r\n  \"ApiScope\": [\r\n    \"AuthServer\",\r\n    \"SaaSService\",\r\n    \"IdentityService\",\r\n    \"AdministrationService\"\r\n  ],\r\n  \"ApiResource\": [\r\n    \"AuthServer\",\r\n    \"SaaSService\",\r\n    \"IdentityService\",\r\n    \"AdministrationService\"\r\n  ],\r\n  \"Clients\": [\r\n    {\r\n      \"ClientId\": \"Tasky_Web\",\r\n      \"ClientSecret\": \"1q2w3e*\",\r\n      \"RootUrls\": [\r\n        \"https://localhost:7004\"\r\n      ],\r\n      \"Scopes\": [\r\n        \"SaaSService\",\r\n        \"IdentityService\",\r\n        \"AdministrationService\"\r\n      ],\r\n      \"GrantTypes\": [\r\n        \"hybrid\"\r\n      ],\r\n      \"RedirectUris\": [\r\n        \"https://localhost:7004/signin-oidc\"\r\n      ],\r\n      \"PostLogoutRedirectUris\": [\r\n        \"https://localhost:7004/signout-callback-oidc\"\r\n      ],\r\n      \"AllowedCorsOrigins\": [\r\n        \"https://localhost:7004\"\r\n      ]\r\n    },\r\n    {\r\n      \"ClientId\": \"Tasky_App\",\r\n      \"ClientSecret\": \"1q2w3e*\",\r\n      \"RootUrls\": [\r\n        \"http://localhost:4200\"\r\n      ],\r\n      \"Scopes\": [\r\n        \"AuthServer\",\r\n        \"SaaSService\",\r\n        \"IdentityService\",\r\n        \"AdministrationService\"\r\n      ],\r\n      \"GrantTypes\": [\r\n        \"authorization_code\"\r\n      ],\r\n      \"RedirectUris\": [\r\n        \"http://localhost:4200\"\r\n      ],\r\n      \"PostLogoutRedirectUris\": [\r\n        \"http://localhost:4200\"\r\n      ],\r\n      \"AllowedCorsOrigins\": [\r\n        \"http://localhost:4200\"\r\n      ]\r\n    },\r\n    {\r\n      \"ClientId\": \"AdministrationService_Swagger\",\r\n      \"ClientSecret\": \"1q2w3e*\",\r\n      \"RootUrls\": [\r\n        \"https://localhost:7001\"\r\n      ],\r\n      \"Scopes\": [\r\n        \"SaaSService\",\r\n        \"IdentityService\",\r\n        \"AdministrationService\"\r\n      ],\r\n      \"GrantTypes\": [\r\n        \"authorization_code\"\r\n      ],\r\n      \"RedirectUris\": [\r\n        \"https://localhost:7001/swagger/oauth2-redirect.html\"\r\n      ],\r\n      \"PostLogoutRedirectUris\": [\r\n        \"https://localhost:7001/signout-callback-oidc\"\r\n      ],\r\n      \"AllowedCorsOrigins\": [\r\n        \"https://localhost:7001\"\r\n      ]\r\n    },\r\n    {\r\n      \"ClientId\": \"IdentityService_Swagger\",\r\n      \"ClientSecret\": \"1q2w3e*\",\r\n      \"RootUrls\": [\r\n        \"https://localhost:7002\"\r\n      ],\r\n      \"Scopes\": [\r\n        \"SaaSService\",\r\n        \"IdentityService\",\r\n        \"AdministrationService\"\r\n      ],\r\n      \"GrantTypes\": [\r\n        \"authorization_code\"\r\n      ],\r\n      \"RedirectUris\": [\r\n        \"https://localhost:7002/swagger/oauth2-redirect.html\"\r\n      ],\r\n      \"PostLogoutRedirectUris\": [\r\n        \"https://localhost:7002\"\r\n      ],\r\n      \"AllowedCorsOrigins\": [\r\n        \"https://localhost:7002\"\r\n      ]\r\n    },\r\n    {\r\n      \"ClientId\": \"SaaSService_Swagger\",\r\n      \"ClientSecret\": \"1q2w3e*\",\r\n      \"RootUrls\": [\r\n        \"https://localhost:7003\"\r\n      ],\r\n      \"Scopes\": [\r\n        \"SaaSService\",\r\n        \"IdentityService\",\r\n        \"AdministrationService\"\r\n      ],\r\n      \"GrantTypes\": [\r\n        \"authorization_code\"\r\n      ],\r\n      \"RedirectUris\": [\r\n        \"https://localhost:7003/swagger/oauth2-redirect.html\"\r\n      ],\r\n      \"PostLogoutRedirectUris\": [\r\n        \"https://localhost:7003\"\r\n      ],\r\n      \"AllowedCorsOrigins\": [\r\n        \"https://localhost:7003\"\r\n      ]\r\n    }\r\n  ]\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-identityserverdataseedcontributor-for-identity-server",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-identityserverdataseedcontributor-for-identity-server",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create ", _jsx(_components.code, {
        children: "IdentityServerDataSeedContributor"
      }), " for identity server"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using System.Threading.Tasks;\r\nusing Volo.Abp.Data;\r\nusing Volo.Abp.DependencyInjection;\r\n\r\nnamespace Tasky.DbMigrator;\r\n\r\npublic class IdentityServerDataSeedContributor : IDataSeedContributor, ITransientDependency\r\n{\r\n    private readonly IdentityServerDataSeeder _identityServerDataSeeder;\r\n\r\n    public IdentityServerDataSeedContributor(IdentityServerDataSeeder identityServerDataSeeder)\r\n    {\r\n        _identityServerDataSeeder = identityServerDataSeeder;\r\n    }\r\n\r\n\r\n    public async Task SeedAsync(DataSeedContext context)\r\n    {\r\n        await _identityServerDataSeeder.SeedAsync();\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-identityserverdataseeder-for-reading-json-and-create-resource",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-identityserverdataseeder-for-reading-json-and-create-resource",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create ", _jsx(_components.code, {
        children: "IdentityServerDataSeeder"
      }), " for reading json and create resource"]
    }), "\n", _jsxs(_components.p, {
      children: ["This service seeds the ", _jsx(_components.code, {
        children: "ApiScope"
      }), ", ", _jsx(_components.code, {
        children: "ApiResource"
      }), " and ", _jsx(_components.code, {
        children: "Identity server clients"
      }), " for the Identity server."]
    }), "\n", _jsxs(_components.p, {
      children: [_jsx(_components.code, {
        children: "ServiceClient"
      }), " is a class to parse the Identity server clients"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class ServiceClient\r\n{\r\n    public string ClientId { get; set; }\r\n    public string ClientSecret { get; set; }\r\n    public string[] RootUrls { get; set; }\r\n    public string[] Scopes { get; set; }\r\n    public string[] GrantTypes { get; set; }\r\n    public string[] RedirectUris { get; set; }\r\n    public string[] PostLogoutRedirectUris { get; set; }\r\n    public string[] AllowedCorsOrigins { get; set; }\r\n}\n"
      })
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using System;\r\nusing System.Collections.Generic;\r\nusing System.Linq;\r\nusing System.Threading.Tasks;\r\nusing IdentityServer4.Models;\r\nusing Microsoft.Extensions.Configuration;\r\nusing Volo.Abp.Authorization.Permissions;\r\nusing Volo.Abp.DependencyInjection;\r\nusing Volo.Abp.Guids;\r\nusing Volo.Abp.IdentityServer.ApiResources;\r\nusing Volo.Abp.IdentityServer.ApiScopes;\r\nusing Volo.Abp.IdentityServer.Clients;\r\nusing Volo.Abp.IdentityServer.IdentityResources;\r\nusing Volo.Abp.MultiTenancy;\r\nusing Volo.Abp.PermissionManagement;\r\nusing Volo.Abp.Uow;\r\nusing ApiResource = Volo.Abp.IdentityServer.ApiResources.ApiResource;\r\nusing ApiScope = Volo.Abp.IdentityServer.ApiScopes.ApiScope;\r\nusing Client = Volo.Abp.IdentityServer.Clients.Client;\r\n\r\nnamespace Tasky.DbMigrator;\r\n\r\npublic class IdentityServerDataSeeder : ITransientDependency\r\n{\r\n    private readonly IApiResourceRepository _apiResourceRepository;\r\n    private readonly IApiScopeRepository _apiScopeRepository;\r\n    private readonly IClientRepository _clientRepository;\r\n    private readonly IConfiguration _configuration;\r\n    private readonly ICurrentTenant _currentTenant;\r\n    private readonly IGuidGenerator _guidGenerator;\r\n    private readonly IIdentityResourceDataSeeder _identityResourceDataSeeder;\r\n    private readonly IPermissionDataSeeder _permissionDataSeeder;\r\n\r\n    public IdentityServerDataSeeder(\r\n        IClientRepository clientRepository,\r\n        IApiResourceRepository apiResourceRepository,\r\n        IApiScopeRepository apiScopeRepository,\r\n        IIdentityResourceDataSeeder identityResourceDataSeeder,\r\n        IGuidGenerator guidGenerator,\r\n        IPermissionDataSeeder permissionDataSeeder,\r\n        IConfiguration configuration,\r\n        ICurrentTenant currentTenant)\r\n    {\r\n        _clientRepository = clientRepository;\r\n        _apiResourceRepository = apiResourceRepository;\r\n        _apiScopeRepository = apiScopeRepository;\r\n        _identityResourceDataSeeder = identityResourceDataSeeder;\r\n        _guidGenerator = guidGenerator;\r\n        _permissionDataSeeder = permissionDataSeeder;\r\n        _configuration = configuration;\r\n        _currentTenant = currentTenant;\r\n    }\r\n\r\n    [UnitOfWork]\r\n    public async virtual Task SeedAsync()\r\n    {\r\n        using (_currentTenant.Change(null))\r\n        {\r\n            await _identityResourceDataSeeder.CreateStandardResourcesAsync();\r\n            await CreateApiResourcesAsync();\r\n            await CreateApiScopesAsync();\r\n            await CreateClientsAsync();\r\n        }\r\n    }\r\n\r\n    private async Task CreateClientsAsync()\r\n    {\r\n        var clients = _configuration.GetSection(\"Clients\").Get<List<ServiceClient>>();\r\n        var commonScopes = new[] {\r\n            \"email\",\r\n            \"openid\",\r\n            \"profile\",\r\n            \"role\",\r\n            \"phone\",\r\n            \"address\"\r\n        };\r\n\r\n        foreach (var client in clients)\r\n        {\r\n            await CreateClientAsync(\r\n                client.ClientId,\r\n                commonScopes.Union(client.Scopes),\r\n                client.GrantTypes,\r\n                client.ClientSecret.Sha256(),\r\n                requireClientSecret: false,\r\n                redirectUris: client.RedirectUris,\r\n                postLogoutRedirectUris: client.PostLogoutRedirectUris,\r\n                corsOrigins: client.AllowedCorsOrigins\r\n            );\r\n        }\r\n    }\r\n\r\n\r\n    private async Task CreateApiResourcesAsync()\r\n    {\r\n        var commonApiUserClaims = new[] {\r\n            \"email\",\r\n            \"email_verified\",\r\n            \"name\",\r\n            \"phone_number\",\r\n            \"phone_number_verified\",\r\n            \"role\"\r\n        };\r\n\r\n        var apiResources = _configuration.GetSection(\"ApiResource\").Get<string[]>();\r\n\r\n        foreach (var item in apiResources)\r\n        {\r\n            await CreateApiResourceAsync(item, commonApiUserClaims);\r\n        }\r\n    }\r\n\r\n    private async Task CreateApiScopesAsync()\r\n    {\r\n        var apiScopes = _configuration.GetSection(\"ApiScope\").Get<string[]>();\r\n        foreach (var item in apiScopes)\r\n        {\r\n            await CreateApiScopeAsync(item);\r\n        }\r\n    }\r\n\r\n    private async Task<ApiResource> CreateApiResourceAsync(string name, IEnumerable<string> claims)\r\n    {\r\n        var apiResource = await _apiResourceRepository.FindByNameAsync(name);\r\n        if (apiResource == null)\r\n        {\r\n            apiResource = await _apiResourceRepository.InsertAsync(\r\n                new ApiResource(\r\n                    _guidGenerator.Create(),\r\n                    name,\r\n                    name + \" API\"\r\n                ),\r\n                true\r\n            );\r\n        }\r\n\r\n        foreach (var claim in claims)\r\n        {\r\n            if (apiResource.FindClaim(claim) == null)\r\n            {\r\n                apiResource.AddUserClaim(claim);\r\n            }\r\n        }\r\n\r\n        return await _apiResourceRepository.UpdateAsync(apiResource);\r\n    }\r\n\r\n    private async Task<ApiScope> CreateApiScopeAsync(string name)\r\n    {\r\n        var apiScope = await _apiScopeRepository.FindByNameAsync(name);\r\n        if (apiScope == null)\r\n        {\r\n            apiScope = await _apiScopeRepository.InsertAsync(\r\n                new ApiScope(\r\n                    _guidGenerator.Create(),\r\n                    name,\r\n                    name + \" API\"\r\n                ),\r\n                true\r\n            );\r\n        }\r\n\r\n        return apiScope;\r\n    }\r\n\r\n    private async Task<Client> CreateClientAsync(\r\n        string name,\r\n        IEnumerable<string> scopes,\r\n        IEnumerable<string> grantTypes,\r\n        string secret = null,\r\n        IEnumerable<string> redirectUris = null,\r\n        IEnumerable<string> postLogoutRedirectUris = null,\r\n        string frontChannelLogoutUri = null,\r\n        bool requireClientSecret = true,\r\n        bool requirePkce = false,\r\n        IEnumerable<string> permissions = null,\r\n        IEnumerable<string> corsOrigins = null)\r\n    {\r\n        var client = await _clientRepository.FindByClientIdAsync(name);\r\n        if (client == null)\r\n        {\r\n            client = await _clientRepository.InsertAsync(\r\n                new Client(\r\n                    _guidGenerator.Create(),\r\n                    name\r\n                ) {\r\n                    ClientName = name,\r\n                    ProtocolType = \"oidc\",\r\n                    Description = name,\r\n                    AlwaysIncludeUserClaimsInIdToken = true,\r\n                    AllowOfflineAccess = true,\r\n                    AbsoluteRefreshTokenLifetime = 31536000, //365 days\r\n                    AccessTokenLifetime = 31536000, //365 days\r\n                    AuthorizationCodeLifetime = 300,\r\n                    IdentityTokenLifetime = 300,\r\n                    RequireConsent = false,\r\n                    FrontChannelLogoutUri = frontChannelLogoutUri,\r\n                    RequireClientSecret = requireClientSecret,\r\n                    RequirePkce = requirePkce\r\n                },\r\n                true\r\n            );\r\n        }\r\n\r\n        foreach (var scope in scopes)\r\n        {\r\n            if (client.FindScope(scope) == null)\r\n            {\r\n                client.AddScope(scope);\r\n            }\r\n        }\r\n\r\n        foreach (var grantType in grantTypes)\r\n        {\r\n            if (client.FindGrantType(grantType) == null)\r\n            {\r\n                client.AddGrantType(grantType);\r\n            }\r\n        }\r\n\r\n        if (!secret.IsNullOrEmpty())\r\n        {\r\n            if (client.FindSecret(secret) == null)\r\n            {\r\n                client.AddSecret(secret);\r\n            }\r\n        }\r\n\r\n        foreach (var redirectUrl in redirectUris)\r\n        {\r\n            if (client.FindRedirectUri(redirectUrl) == null)\r\n            {\r\n                client.AddRedirectUri(redirectUrl);\r\n            }\r\n        }\r\n\r\n        foreach (var postLogoutRedirectUri in postLogoutRedirectUris)\r\n        {\r\n            if (client.FindPostLogoutRedirectUri(postLogoutRedirectUri) == null)\r\n            {\r\n                client.AddPostLogoutRedirectUri(postLogoutRedirectUri);\r\n            }\r\n        }\r\n\r\n        if (permissions != null)\r\n        {\r\n            await _permissionDataSeeder.SeedAsync(\r\n                ClientPermissionValueProvider.ProviderName,\r\n                name,\r\n                permissions\r\n            );\r\n        }\r\n\r\n        if (corsOrigins != null)\r\n        {\r\n            foreach (var origin in corsOrigins)\r\n            {\r\n                if (!origin.IsNullOrWhiteSpace() && client.FindCorsOrigin(origin) == null)\r\n                {\r\n                    client.AddCorsOrigin(origin);\r\n                }\r\n            }\r\n        }\r\n\r\n        return await _clientRepository.UpdateAsync(client);\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-taskydbmigratormodule",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-taskydbmigratormodule",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the ", _jsx(_components.code, {
        children: "TaskyDbMigratorModule"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "typeof(AdministrationServiceEntityFrameworkCoreModule),\r\ntypeof(AdministrationServiceApplicationContractsModule),\r\ntypeof(IdentityServiceEntityFrameworkCoreModule),\r\ntypeof(IdentityServiceApplicationContractsModule),\r\ntypeof(SaaSServiceEntityFrameworkCoreModule),\r\ntypeof(SaaSServiceApplicationContractsModule)\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Repo: https://github.com/antosubash/AbpMicroservice"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>SaaS Services</title>
          <link>https://blog.antosubash.com/posts/netcore-microservice-with-abp-saas-services-part-5</link>
          <guid>https://blog.antosubash.com/posts/netcore-microservice-with-abp-saas-services-part-5</guid>
          <pubDate>Sat, 19 Mar 2022 03:00:00 GMT</pubDate>
          <description>In this post we will see how to do the create SaaS Service for our microservice application</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    p: "p",
    a: "a",
    h2: "h2",
    span: "span",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.p, {
      children: ["This is fifth post of the series: ", _jsx(_components.a, {
        href: "/posts/abp-microservice-series",
        children: ".NET Microservice with ABP"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-init-part-1",
        children: "Part 1. Initial Setup"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-shared-project-part-2",
        children: "Part 2. Shared Project"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-administration-services-part-3",
        children: "Part 3. Administration Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-services-part-4",
        children: "Part 4. Identity Service"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 5. SaaS Service (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-db-migration-part-6",
        children: "Part 6. DB Migration"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-yarp-and-tye-part-7",
        children: "Part 7. Yarp and Tye"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-server-and-angular-part-8",
        children: "Part 8. Identity server and Angular App"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-distributed-event-bus-part-9",
        children: "Part 9. Distributed event bus"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-docker-and-ci-cd-part-10",
        children: "Part 10. Docker and CI/CD"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-new-service-part-11",
        children: "Part 11. Add a New service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-central-logging-part-12",
        children: "Part 12. Central Logging"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to setup SaaS service. we only have tenant management module in this service."
    }), "\n", _jsxs(_components.h2, {
      id: "add-the-shared-project-as-a-reference-to-the-host",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-the-shared-project-as-a-reference-to-the-host",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add the shared project as a reference to the host"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<ProjectReference Include=\"..\\..\\..\\..\\shared\\Tasky.Shared.Hosting\\Tasky.Shared.Hosting.csproj\" />\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-connection-string",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-connection-string",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the connection string"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=TaskySaaSService;Pooling=false;"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-saasservicehttpapihostmodule",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-saasservicehttpapihostmodule",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the ", _jsx(_components.code, {
        children: "SaaSServiceHttpApiHostModule"
      })]
    }), "\n", _jsx(_components.p, {
      children: "Update the depends on."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[DependsOn(\r\n    typeof(TaskyHostingModule),\r\n    typeof(SaaSServiceApplicationModule),\r\n    typeof(SaaSServiceEntityFrameworkCoreModule),\r\n    typeof(SaaSServiceHttpApiModule),\r\n)]\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Remove the things which are configured in the shared project."
    }), "\n", _jsxs(_components.h2, {
      id: "create-the-dbcontextfactory-in-the-entityframeworkcore-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-dbcontextfactory-in-the-entityframeworkcore-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the ", _jsx(_components.code, {
        children: "DbContextFactory"
      }), " in the EntityFrameworkCore project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using System.IO;\r\nusing Microsoft.EntityFrameworkCore;\r\nusing Microsoft.EntityFrameworkCore.Design;\r\nusing Microsoft.Extensions.Configuration;\r\n\r\nnamespace Tasky.SaaSService.EntityFrameworkCore;\r\n\r\npublic class SaaSServiceDbContextFactory : IDesignTimeDbContextFactory<SaaSServiceDbContext>\r\n{\r\n    public SaaSServiceDbContext CreateDbContext(string[] args)\r\n    {\r\n        var builder = new DbContextOptionsBuilder<SaaSServiceDbContext>()\r\n            .UseNpgsql(GetConnectionStringFromConfiguration());\r\n\r\n        return new SaaSServiceDbContext(builder.Options);\r\n    }\r\n\r\n    private static string GetConnectionStringFromConfiguration()\r\n    {\r\n        return BuildConfiguration()\r\n            .GetConnectionString(SaaSServiceDbProperties.ConnectionStringName);\r\n    }\r\n\r\n    private static IConfigurationRoot BuildConfiguration()\r\n    {\r\n        var builder = new ConfigurationBuilder()\r\n            .SetBasePath(\r\n                Path.Combine(\r\n                    Directory.GetParent(Directory.GetCurrentDirectory())?.Parent!.FullName!,\r\n                    $\"host{Path.DirectorySeparatorChar}Tasky.SaaSService.HttpApi.Host\"\r\n                )\r\n            )\r\n            .AddJsonFile(\"appsettings.json\", false);\r\n\r\n        return builder.Build();\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-taskysaasserviceentityframeworkcore",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-taskysaasserviceentityframeworkcore",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the ", _jsx(_components.code, {
        children: "Tasky.SaaSService.EntityFrameworkCore"
      })]
    }), "\n", _jsx(_components.p, {
      children: "Update the nuget packages"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<PackageReference Include=\"Volo.Abp.EntityFrameworkCore\" Version=\"5.1.4\"/>\r\n<PackageReference Include=\"Volo.Abp.EntityFrameworkCore.PostgreSql\" Version=\"5.1.4\"/>\r\n<PackageReference Include=\"Microsoft.EntityFrameworkCore.Tools\" Version=\"6.0.1\"/>\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "SaaSServiceDbContext"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using Microsoft.EntityFrameworkCore;\r\nusing Volo.Abp.Data;\r\nusing Volo.Abp.EntityFrameworkCore;\r\nusing Volo.Abp.TenantManagement;\r\nusing Volo.Abp.TenantManagement.EntityFrameworkCore;\r\n\r\nnamespace Tasky.SaaSService.EntityFrameworkCore;\r\n\r\n[ConnectionStringName(SaaSServiceDbProperties.ConnectionStringName)]\r\npublic class SaaSServiceDbContext : AbpDbContext<SaaSServiceDbContext>, ITenantManagementDbContext, ISaaSServiceDbContext\r\n{\r\n    public SaaSServiceDbContext(DbContextOptions<SaaSDbContext> options)\r\n        : base(options)\r\n    {\r\n    }\r\n\r\n    public DbSet<Tenant> Tenants { get; set; }\r\n\r\n    public DbSet<TenantConnectionString> TenantConnectionStrings { get; set; }\r\n\r\n    protected override void OnModelCreating(ModelBuilder builder)\r\n    {\r\n        base.OnModelCreating(builder);\r\n\r\n        builder.ConfigureSaaSService();\r\n        builder.ConfigureTenantManagement();\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "SaaSServiceEntityFrameworkCoreModule"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using System;\r\nusing Microsoft.Extensions.DependencyInjection;\r\nusing Volo.Abp.EntityFrameworkCore;\r\nusing Volo.Abp.Modularity;\r\nusing Volo.Abp.TenantManagement.EntityFrameworkCore;\r\n\r\nnamespace Tasky.SaaSService.EntityFrameworkCore;\r\n\r\n[DependsOn(\r\n    typeof(SaaSServiceDomainModule),\r\n    typeof(AbpTenantManagementEntityFrameworkCoreModule),\r\n    typeof(AbpEntityFrameworkCoreModule),\r\n    typeof(AbpEntityFrameworkCorePostgreSqlModule)\r\n)]\r\npublic class SaaSServiceEntityFrameworkCoreModule : AbpModule\r\n{\r\n    public override void ConfigureServices(ServiceConfigurationContext context)\r\n    {\r\n        Configure<AbpDbContextOptions>(options =>\r\n        {\r\n            options.UseNpgsql();\r\n        });\r\n\r\n        AppContext.SetSwitch(\"Npgsql.EnableLegacyTimestampBehavior\", true);\r\n\r\n        context.Services.AddAbpDbContext<SaaSDbContext>(options =>\r\n        {\r\n            options.ReplaceDbContext<ITenantManagementDbContext>();\r\n            options.AddDefaultRepositories(true);\r\n        });\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Once this is created delete ", _jsx(_components.code, {
        children: "EntityFrameworkCore"
      }), " folder can be created."]
    }), "\n", _jsxs(_components.h2, {
      id: "migration",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#migration",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Migration"]
    }), "\n", _jsx(_components.p, {
      children: "To create migrations"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "dotnet ef migrations add Init"
      })
    }), "\n", _jsx(_components.p, {
      children: "To update database"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "dotnet ef database update"
      })
    }), "\n", _jsx(_components.p, {
      children: "Repo: https://github.com/antosubash/AbpMicroservice"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Identity Services</title>
          <link>https://blog.antosubash.com/posts/netcore-microservice-with-abp-identity-services-part-4</link>
          <guid>https://blog.antosubash.com/posts/netcore-microservice-with-abp-identity-services-part-4</guid>
          <pubDate>Sat, 19 Mar 2022 02:00:00 GMT</pubDate>
          <description>In this post we will see how to do the create Identity service for our microservice application</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    p: "p",
    a: "a",
    h2: "h2",
    span: "span",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.p, {
      children: ["This is forth post of the series: ", _jsx(_components.a, {
        href: "/posts/abp-microservice-series",
        children: ".NET Microservice with ABP"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-init-part-1",
        children: "Part 1. Initial Setup"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-shared-project-part-2",
        children: "Part 2. Shared Project"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-administration-services-part-3",
        children: "Part 3. Administration Service"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 4. Identity Service (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-saas-services-part-5",
        children: "Part 5. SaaS Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-db-migration-part-6",
        children: "Part 6. DB Migration"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-yarp-and-tye-part-7",
        children: "Part 7. Yarp and Tye"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-server-and-angular-part-8",
        children: "Part 8. Identity server and Angular App"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-distributed-event-bus-part-9",
        children: "Part 9. Distributed event bus"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-docker-and-ci-cd-part-10",
        children: "Part 10. Docker and CI/CD"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-new-service-part-11",
        children: "Part 11. Add a New service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-central-logging-part-12",
        children: "Part 12. Central Logging"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to configure Identity Service. In the identity service we have already add 2 modules Identity and IdentityServer. we need to configure the Identity service to use these modules."
    }), "\n", _jsxs(_components.h2, {
      id: "add-the-shared-project-as-a-reference-to-the-host",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-the-shared-project-as-a-reference-to-the-host",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add the shared project as a reference to the host"]
    }), "\n", _jsx(_components.p, {
      children: "We need to do the same thing we did in the admin service. Add the shared project as a reference and clean up host module."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<ProjectReference Include=\"..\\..\\..\\..\\shared\\Tasky.Shared.Hosting\\Tasky.Shared.Hosting.csproj\" />\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-connection-string",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-connection-string",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the connection string"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=TaskyIdentityService;Pooling=false;"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-identityservicehttpapihostmodule",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-identityservicehttpapihostmodule",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the ", _jsx(_components.code, {
        children: "IdentityServiceHttpApiHostModule"
      })]
    }), "\n", _jsx(_components.p, {
      children: "Update the depends on with the shared hosting module."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[DependsOn(\r\n    typeof(TaskyHostingModule),\r\n    typeof(IdentityServiceApplicationModule),\r\n    typeof(IdentityServiceEntityFrameworkCoreModule),\r\n    typeof(IdentityServiceHttpApiModule),\r\n)]\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Remove the things which are configured in the shared project."
    }), "\n", _jsxs(_components.h2, {
      id: "create-the-dbcontextfactory-in-the-entityframeworkcore-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-dbcontextfactory-in-the-entityframeworkcore-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the ", _jsx(_components.code, {
        children: "DbContextFactory"
      }), " in the EntityFrameworkCore project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using System.IO;\r\nusing Microsoft.EntityFrameworkCore;\r\nusing Microsoft.EntityFrameworkCore.Design;\r\nusing Microsoft.Extensions.Configuration;\r\n\r\nnamespace Tasky.IdentityService.EntityFrameworkCore;\r\n\r\npublic class IdentityServiceDbContextFactory : IDesignTimeDbContextFactory<IdentityServiceDbContext>\r\n{\r\n    public IdentityServiceDbContext CreateDbContext(string[] args)\r\n    {\r\n        var builder = new DbContextOptionsBuilder<IdentityServiceDbContext>()\r\n            .UseNpgsql(GetConnectionStringFromConfiguration());\r\n\r\n        return new IdentityServiceDbContext(builder.Options);\r\n    }\r\n\r\n    private static string GetConnectionStringFromConfiguration()\r\n    {\r\n        return BuildConfiguration()\r\n            .GetConnectionString(IdentityServiceDbProperties.ConnectionStringName);\r\n    }\r\n\r\n    private static IConfigurationRoot BuildConfiguration()\r\n    {\r\n        var builder = new ConfigurationBuilder()\r\n            .SetBasePath(\r\n                Path.Combine(\r\n                    Directory.GetParent(Directory.GetCurrentDirectory())?.Parent!.FullName!,\r\n                    $\"host{Path.DirectorySeparatorChar}Tasky.IdentityService.HttpApi.Host\"\r\n                )\r\n            )\r\n            .AddJsonFile(\"appsettings.json\", false);\r\n\r\n        return builder.Build();\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-identityservicedbcontext",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-identityservicedbcontext",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the ", _jsx(_components.code, {
        children: "IdentityServiceDbContext"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using Microsoft.EntityFrameworkCore;\r\nusing Volo.Abp.Data;\r\nusing Volo.Abp.EntityFrameworkCore;\r\nusing Volo.Abp.Identity;\r\nusing Volo.Abp.Identity.EntityFrameworkCore;\r\nusing Volo.Abp.IdentityServer.ApiResources;\r\nusing Volo.Abp.IdentityServer.ApiScopes;\r\nusing Volo.Abp.IdentityServer.Clients;\r\nusing Volo.Abp.IdentityServer.Devices;\r\nusing Volo.Abp.IdentityServer.EntityFrameworkCore;\r\nusing Volo.Abp.IdentityServer.Grants;\r\nusing Volo.Abp.IdentityServer.IdentityResources;\r\n\r\nnamespace Tasky.IdentityService.EntityFrameworkCore;\r\n\r\n[ConnectionStringName(IdentityServiceDbProperties.ConnectionStringName)]\r\npublic class IdentityServiceDbContext : AbpDbContext<IdentityServiceDbContext>, IIdentityDbContext,\r\n    IIdentityServerDbContext, IIdentityServiceDbContext\r\n{\r\n    public IdentityServiceDbContext(DbContextOptions<IdentityServiceDbContext> options)\r\n        : base(options)\r\n    {\r\n    }\r\n\r\n    public DbSet<IdentityUser> Users { get; set; }\r\n    public DbSet<IdentityRole> Roles { get; set; }\r\n    public DbSet<IdentityClaimType> ClaimTypes { get; set; }\r\n    public DbSet<OrganizationUnit> OrganizationUnits { get; set; }\r\n    public DbSet<IdentitySecurityLog> SecurityLogs { get; set; }\r\n    public DbSet<IdentityLinkUser> LinkUsers { get; set; }\r\n    public DbSet<ApiResource> ApiResources { get; set; }\r\n    public DbSet<ApiResourceSecret> ApiResourceSecrets { get; set; }\r\n    public DbSet<ApiResourceClaim> ApiResourceClaims { get; set; }\r\n    public DbSet<ApiResourceScope> ApiResourceScopes { get; set; }\r\n    public DbSet<ApiResourceProperty> ApiResourceProperties { get; set; }\r\n    public DbSet<ApiScope> ApiScopes { get; set; }\r\n    public DbSet<ApiScopeClaim> ApiScopeClaims { get; set; }\r\n    public DbSet<ApiScopeProperty> ApiScopeProperties { get; set; }\r\n    public DbSet<IdentityResource> IdentityResources { get; set; }\r\n    public DbSet<IdentityResourceClaim> IdentityClaims { get; set; }\r\n    public DbSet<IdentityResourceProperty> IdentityResourceProperties { get; set; }\r\n    public DbSet<Client> Clients { get; set; }\r\n    public DbSet<ClientGrantType> ClientGrantTypes { get; set; }\r\n    public DbSet<ClientRedirectUri> ClientRedirectUris { get; set; }\r\n    public DbSet<ClientPostLogoutRedirectUri> ClientPostLogoutRedirectUris { get; set; }\r\n    public DbSet<ClientScope> ClientScopes { get; set; }\r\n    public DbSet<ClientSecret> ClientSecrets { get; set; }\r\n    public DbSet<ClientClaim> ClientClaims { get; set; }\r\n    public DbSet<ClientIdPRestriction> ClientIdPRestrictions { get; set; }\r\n    public DbSet<ClientCorsOrigin> ClientCorsOrigins { get; set; }\r\n    public DbSet<ClientProperty> ClientProperties { get; set; }\r\n    public DbSet<PersistedGrant> PersistedGrants { get; set; }\r\n    public DbSet<DeviceFlowCodes> DeviceFlowCodes { get; set; }\r\n\r\n    protected override void OnModelCreating(ModelBuilder builder)\r\n    {\r\n        base.OnModelCreating(builder);\r\n\r\n        builder.ConfigureIdentityService();\r\n        builder.ConfigureIdentity();\r\n        builder.ConfigureIdentityServer();\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-taskyidentityserviceentityframeworkcore-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-taskyidentityserviceentityframeworkcore-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the ", _jsx(_components.code, {
        children: "Tasky.IdentityService.EntityFrameworkCore"
      }), " project"]
    }), "\n", _jsx(_components.p, {
      children: "Update the nuget packages with ef core packages. we will replace the module db context and configure the DbContext options in this module."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<PackageReference Include=\"Volo.Abp.EntityFrameworkCore\" Version=\"5.1.4\"/>\r\n<PackageReference Include=\"Volo.Abp.EntityFrameworkCore.PostgreSql\" Version=\"5.1.4\"/>\r\n<PackageReference Include=\"Microsoft.EntityFrameworkCore.Tools\" Version=\"6.0.1\"/>\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "IdentityServiceEntityFrameworkCoreModule"
      }), " file."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using System;\r\nusing Microsoft.Extensions.DependencyInjection;\r\nusing Volo.Abp.EntityFrameworkCore;\r\nusing Volo.Abp.Identity.EntityFrameworkCore;\r\nusing Volo.Abp.IdentityServer.EntityFrameworkCore;\r\nusing Volo.Abp.Modularity;\r\n\r\nnamespace Tasky.IdentityService.EntityFrameworkCore;\r\n\r\n[DependsOn(\r\n    typeof(IdentityServiceDomainModule),\r\n    typeof(AbpEntityFrameworkCoreModule),\r\n    typeof(AbpIdentityEntityFrameworkCoreModule),\r\n    typeof(AbpIdentityServerEntityFrameworkCoreModule)\r\n)]\r\npublic class IdentityServiceEntityFrameworkCoreModule : AbpModule\r\n{\r\n    public override void ConfigureServices(ServiceConfigurationContext context)\r\n    {\r\n        Configure<AbpDbContextOptions>(options =>\r\n        {\r\n            options.UseNpgsql();\r\n        });\r\n        AppContext.SetSwitch(\"Npgsql.EnableLegacyTimestampBehavior\", true);\r\n        context.Services.AddAbpDbContext<IdentityServiceDbContext>(options =>\r\n        {\r\n            options.ReplaceDbContext<IIdentityDbContext>();\r\n            options.ReplaceDbContext<IIdentityServerDbContext>();\r\n\r\n            options.AddDefaultRepositories(true);\r\n        });\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Once this is created delete ", _jsx(_components.code, {
        children: "EntityFrameworkCore"
      }), " folder can be created."]
    }), "\n", _jsxs(_components.h2, {
      id: "migration",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#migration",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Migration"]
    }), "\n", _jsx(_components.p, {
      children: "To create migrations"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "dotnet ef migrations add Init"
      })
    }), "\n", _jsx(_components.p, {
      children: "To update database"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "dotnet ef database update"
      })
    }), "\n", _jsx(_components.p, {
      children: "Repo: https://github.com/antosubash/AbpMicroservice"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Administration Services</title>
          <link>https://blog.antosubash.com/posts/netcore-microservice-with-abp-administration-services-part-3</link>
          <guid>https://blog.antosubash.com/posts/netcore-microservice-with-abp-administration-services-part-3</guid>
          <pubDate>Sat, 19 Mar 2022 01:00:00 GMT</pubDate>
          <description>In this post we will see how to do the create Administration service for our microservice application</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    p: "p",
    a: "a",
    h2: "h2",
    span: "span",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.p, {
      children: ["This is third post of the series: ", _jsx(_components.a, {
        href: "/posts/abp-microservice-series",
        children: ".NET Microservice with ABP"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-init-part-1",
        children: "Part 1. Initial Setup"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-shared-project-part-2",
        children: "Part 2. Shared Project"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 3. Administration Service (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-services-part-4",
        children: "Part 4. Identity Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-saas-services-part-5",
        children: "Part 5. SaaS Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-db-migration-part-6",
        children: "Part 6. DB Migration"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-yarp-and-tye-part-7",
        children: "Part 7. Yarp and Tye"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-server-and-angular-part-8",
        children: "Part 8. Identity server and Angular App"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-distributed-event-bus-part-9",
        children: "Part 9. Distributed event bus"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-docker-and-ci-cd-part-10",
        children: "Part 10. Docker and CI/CD"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-new-service-part-11",
        children: "Part 11. Add a New service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-central-logging-part-12",
        children: "Part 12. Central Logging"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "setup-administration-service",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#setup-administration-service",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Setup Administration service"]
    }), "\n", _jsx(_components.p, {
      children: "Adminstration service is where we uses Audit log, feature, settings and permission management modules. We will use a separate database to store everything in the administration service."
    }), "\n", _jsxs(_components.h2, {
      id: "add-the-shared-project-as-a-reference-to-the-host",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-the-shared-project-as-a-reference-to-the-host",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add the shared project as a reference to the host"]
    }), "\n", _jsx(_components.p, {
      children: "We need to add shared project as the reference to the Administration service. once this is added we can do some cleanup in the host module of the administration."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<ProjectReference Include=\"..\\..\\..\\..\\shared\\Tasky.Shared.Hosting\\Tasky.Shared.Hosting.csproj\" />\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-connection-string",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-connection-string",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the connection string"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "User ID=postgres;Password=postgres;Host=localhost;Port=5432;Database=AdministrationService;Pooling=false;"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-administrationservicehttpapihostmodule",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-administrationservicehttpapihostmodule",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the ", _jsx(_components.code, {
        children: "AdministrationServiceHttpApiHostModule"
      })]
    }), "\n", _jsx(_components.p, {
      children: "Update the depends on with the shared module. Once the shared module is added then we can removed most of the modules in the host module. Below is how the final depends on looks like."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[DependsOn(\r\n    typeof(TaskyHostingModule),\r\n    typeof(AdministrationServiceApplicationModule),\r\n    typeof(AdministrationServiceEntityFrameworkCoreModule),\r\n    typeof(AdministrationServiceHttpApiModule),\r\n)]\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Remove the things which are configured in the shared project."
    }), "\n", _jsxs(_components.h2, {
      id: "create-the-dbcontextfactory-in-the-entityframeworkcore-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-dbcontextfactory-in-the-entityframeworkcore-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the ", _jsx(_components.code, {
        children: "DbContextFactory"
      }), " in the EntityFrameworkCore project"]
    }), "\n", _jsxs(_components.p, {
      children: ["We need to create a ", _jsx(_components.code, {
        children: "Factory"
      }), " class for the ", _jsx(_components.code, {
        children: "DbContext"
      }), " so that we can create migration in the ", _jsx(_components.code, {
        children: "EfCore"
      }), " project. this is necessary to build the configuration form the host project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using System.IO;\r\nusing Microsoft.EntityFrameworkCore;\r\nusing Microsoft.EntityFrameworkCore.Design;\r\nusing Microsoft.Extensions.Configuration;\r\n\r\nnamespace Tasky.AdministrationService.EntityFrameworkCore;\r\n\r\npublic class AdministrationServiceDbContextFactory : IDesignTimeDbContextFactory<AdministrationServiceDbContext>\r\n{\r\n    public AdministrationServiceDbContext CreateDbContext(string[] args)\r\n    {\r\n        var builder = new DbContextOptionsBuilder<AdministrationServiceDbContext>()\r\n            .UseNpgsql(GetConnectionStringFromConfiguration());\r\n\r\n        return new AdministrationServiceDbContext(builder.Options);\r\n    }\r\n\r\n    private static string GetConnectionStringFromConfiguration()\r\n    {\r\n        return BuildConfiguration()\r\n            .GetConnectionString(AdministrationServiceDbProperties.ConnectionStringName);\r\n    }\r\n\r\n    private static IConfigurationRoot BuildConfiguration()\r\n    {\r\n        var builder = new ConfigurationBuilder()\r\n            .SetBasePath(\r\n                Path.Combine(\r\n                    Directory.GetParent(Directory.GetCurrentDirectory())?.Parent!.FullName!,\r\n                    $\"host{Path.DirectorySeparatorChar}Tasky.AdministrationService.HttpApi.Host\"\r\n                )\r\n            )\r\n            .AddJsonFile(\"appsettings.json\", false);\r\n\r\n        return builder.Build();\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-administrationservicedbcontext",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-administrationservicedbcontext",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the ", _jsx(_components.code, {
        children: "AdministrationServiceDbContext"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["In the ", _jsx(_components.code, {
        children: "DbContext"
      }), " we need to updated it with the DbContext of the modules. We have added 4 modules in the administration service and all modules have a db context. So we have to inherit from the db context of the modules. this is add the ", _jsx(_components.code, {
        children: "DBSet"
      }), " of the modules to the administration module."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using Microsoft.EntityFrameworkCore;\r\nusing Volo.Abp.Data;\r\nusing Volo.Abp.EntityFrameworkCore;\r\nusing Volo.Abp.AuditLogging.EntityFrameworkCore;\r\nusing Volo.Abp.FeatureManagement.EntityFrameworkCore;\r\nusing Volo.Abp.PermissionManagement.EntityFrameworkCore;\r\nusing Volo.Abp.SettingManagement.EntityFrameworkCore;\r\nusing Volo.Abp.AuditLogging;\r\nusing Volo.Abp.FeatureManagement;\r\nusing Volo.Abp.PermissionManagement;\r\nusing Volo.Abp.SettingManagement;\r\n\r\nnamespace Tasky.AdministrationService.EntityFrameworkCore;\r\n\r\n[ConnectionStringName(AdministrationServiceDbProperties.ConnectionStringName)]\r\npublic class AdministrationServiceDbContext : AbpDbContext<AdministrationServiceDbContext>,\r\n    IPermissionManagementDbContext,\r\n    ISettingManagementDbContext,\r\n    IFeatureManagementDbContext,\r\n    IAuditLoggingDbContext,\r\n    IAdministrationServiceDbContext\r\n{\r\n    /* Add DbSet for each Aggregate Root here. Example:\r\n     * public DbSet<Question> Questions { get; set; }\r\n     */\r\n\r\n    public AdministrationServiceDbContext(DbContextOptions<AdministrationServiceDbContext> options)\r\n        : base(options)\r\n    {\r\n    }\r\n\r\n    public DbSet<AuditLog> AuditLogs { get; set; }\r\n    public DbSet<FeatureValue> FeatureValues { get; set; }\r\n    public DbSet<PermissionGrant> PermissionGrants { get; set; }\r\n    public DbSet<Setting> Settings { get; set; }\r\n\r\n    protected override void OnModelCreating(ModelBuilder builder)\r\n    {\r\n        base.OnModelCreating(builder);\r\n\r\n        builder.ConfigureAdministrationService();\r\n        builder.ConfigurePermissionManagement();\r\n        builder.ConfigureSettingManagement();\r\n        builder.ConfigureAuditLogging();\r\n        builder.ConfigureFeatureManagement();\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-administrationserviceentityframeworkcoremodule",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-administrationserviceentityframeworkcoremodule",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the ", _jsx(_components.code, {
        children: "AdministrationServiceEntityFrameworkCoreModule"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["This is the final setup before creating the migration. we have to inform the ef core that we are using ", _jsx(_components.code, {
        children: "postgres"
      }), " as database. we can do that configuring ", _jsx(_components.code, {
        children: "AbpDbContextOptions"
      }), " and replace the db context of the modules with the administration db context."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using Microsoft.Extensions.DependencyInjection;\r\nusing Volo.Abp.EntityFrameworkCore;\r\nusing Volo.Abp.Modularity;\r\nusing Volo.Abp.AuditLogging.EntityFrameworkCore;\r\nusing Volo.Abp.FeatureManagement.EntityFrameworkCore;\r\nusing Volo.Abp.PermissionManagement.EntityFrameworkCore;\r\nusing Volo.Abp.SettingManagement.EntityFrameworkCore;\r\nusing System;\r\n\r\nnamespace Tasky.AdministrationService.EntityFrameworkCore;\r\n\r\n[DependsOn(\r\n    typeof(AdministrationServiceDomainModule),\r\n    typeof(AbpEntityFrameworkCoreModule)\r\n)]\r\n[DependsOn(typeof(AbpAuditLoggingEntityFrameworkCoreModule))]\r\n[DependsOn(typeof(AbpFeatureManagementEntityFrameworkCoreModule))]\r\n[DependsOn(typeof(AbpPermissionManagementEntityFrameworkCoreModule))]\r\n[DependsOn(typeof(AbpSettingManagementEntityFrameworkCoreModule))]\r\npublic class AdministrationServiceEntityFrameworkCoreModule : AbpModule\r\n{\r\n    public override void ConfigureServices(ServiceConfigurationContext context)\r\n    {\r\n        Configure<AbpDbContextOptions>(options =>\r\n        {\r\n            options.UseNpgsql();\r\n        });\r\n        \r\n        AppContext.SetSwitch(\"Npgsql.EnableLegacyTimestampBehavior\", true);\r\n        context.Services.AddAbpDbContext<AdministrationServiceDbContext>(options =>\r\n        {\r\n            options.ReplaceDbContext<IPermissionManagementDbContext>();\r\n            options.ReplaceDbContext<ISettingManagementDbContext>();\r\n            options.ReplaceDbContext<IFeatureManagementDbContext>();\r\n            options.ReplaceDbContext<IAuditLoggingDbContext>();\r\n\r\n            options.AddDefaultRepositories(true);\r\n        });\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "prepare-for-the-migration",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#prepare-for-the-migration",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Prepare for the migration"]
    }), "\n", _jsx(_components.p, {
      children: "Add the ef core design nuget for the migrations."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<PackageReference Include=\"Microsoft.EntityFrameworkCore.Design\" Version=\"6.0.1\">\r\n    <PrivateAssets>all</PrivateAssets>\r\n    <IncludeAssets>runtime; build; native; contentfiles; analyzers</IncludeAssets>\r\n</PackageReference>\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Once this is created delete ", _jsx(_components.code, {
        children: "EntityFrameworkCore"
      }), " folder can be created from the host project."]
    }), "\n", _jsxs(_components.h2, {
      id: "migration",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#migration",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Migration"]
    }), "\n", _jsx(_components.p, {
      children: "To create migrations"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "dotnet ef migrations add Init"
      })
    }), "\n", _jsx(_components.p, {
      children: "To update database"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "dotnet ef database update"
      })
    }), "\n", _jsx(_components.p, {
      children: "Repo: https://github.com/antosubash/AbpMicroservice"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Shared Project</title>
          <link>https://blog.antosubash.com/posts/netcore-microservice-with-abp-shared-project-part-2</link>
          <guid>https://blog.antosubash.com/posts/netcore-microservice-with-abp-shared-project-part-2</guid>
          <pubDate>Sat, 19 Mar 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to do the create a Shared project which will be used by all services</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    p: "p",
    a: "a",
    h2: "h2",
    span: "span",
    code: "code",
    pre: "pre"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.p, {
      children: ["This is second post of the series: ", _jsx(_components.a, {
        href: "/posts/abp-microservice-series",
        children: ".NET Microservice with ABP"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-init-part-1",
        children: "Part 1. Initial Setup"
      })
    }), "\n", _jsx(_components.p, {
      children: "Part 2. Shared Project (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-administration-services-part-3",
        children: "Part 3. Administration Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-services-part-4",
        children: "Part 4. Identity Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-saas-services-part-5",
        children: "Part 5. SaaS Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-db-migration-part-6",
        children: "Part 6. DB Migration"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-yarp-and-tye-part-7",
        children: "Part 7. Yarp and Tye"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-server-and-angular-part-8",
        children: "Part 8. Identity server and Angular App"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-distributed-event-bus-part-9",
        children: "Part 9. Distributed event bus"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-docker-and-ci-cd-part-10",
        children: "Part 10. Docker and CI/CD"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-new-service-part-11",
        children: "Part 11. Add a New service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-central-logging-part-12",
        children: "Part 12. Central Logging"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "setup-shared-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#setup-shared-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Setup Shared project"]
    }), "\n", _jsx(_components.p, {
      children: "We need the shared project so that we can share some start up code. This part is not necessary but it is good to have and shared module which will we can reuse."
    }), "\n", _jsxs(_components.h2, {
      id: "install-nuget",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-nuget",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install nuget"]
    }), "\n", _jsxs(_components.p, {
      children: ["The setup script in the part 1 of this series has created a empty class library project called ", _jsx(_components.code, {
        children: "Tasky.Shared.Hosting"
      }), ". we will add the following nuget packages to that project. These nuget packages are essential for all the microservice we are going to create. So we will install these in a shared project and add this shared project as a reference in all the services. This will we can save some time."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<PackageReference Include=\"Volo.Abp.Autofac\" Version=\"5.1.4\"/>\r\n<PackageReference Include=\"Volo.Abp.EventBus.RabbitMQ\" Version=\"5.1.4\"/>\r\n<PackageReference Include=\"Volo.Abp.Localization\" Version=\"5.1.4\"/>\r\n<PackageReference Include=\"Volo.Abp.MultiTenancy\" Version=\"5.1.4\"/>\r\n<PackageReference Include=\"Volo.Abp.AspNetCore.Mvc.UI.MultiTenancy\" Version=\"5.1.4\"/>\r\n<PackageReference Include=\"Serilog.AspNetCore\" Version=\"4.1.0\"/>\r\n<PackageReference Include=\"Serilog.Sinks.Async\" Version=\"1.5.0\"/>\r\n<PackageReference Include=\"IdentityModel\" Version=\"5.1.0\"/>\r\n<PackageReference Include=\"Microsoft.AspNetCore.Authentication.JwtBearer\" Version=\"6.0.0\"/>\r\n<PackageReference Include=\"Microsoft.AspNetCore.DataProtection.StackExchangeRedis\" Version=\"6.0.0\"/>\r\n<PackageReference Include=\"Volo.Abp.Caching.StackExchangeRedis\" Version=\"5.1.4\"/>\r\n<PackageReference Include=\"Volo.Abp.Http.Client.IdentityModel.Web\" Version=\"5.1.4\"/>\r\n<PackageReference Include=\"Volo.Abp.Identity.HttpApi.Client\" Version=\"5.1.4\"/>\r\n<PackageReference Include=\"Volo.Abp.AspNetCore.Serilog\" Version=\"5.1.4\"/>\r\n<PackageReference Include=\"Volo.Abp.Swashbuckle\" Version=\"5.1.4\"/>\r\n<PackageReference Include=\"Volo.Abp.EntityFrameworkCore\" Version=\"5.1.4\"/>\r\n<PackageReference Include=\"Volo.Abp.EntityFrameworkCore.PostgreSql\" Version=\"5.1.4\"/>\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "shared-module",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#shared-module",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Shared module"]
    }), "\n", _jsxs(_components.p, {
      children: ["Lets create a shared ", _jsx(_components.code, {
        children: "TaskyHostingModule"
      }), " which can be added as dependency for all of our services."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using Volo.Abp.AspNetCore.MultiTenancy;\r\nusing Volo.Abp.AspNetCore.Serilog;\r\nusing Volo.Abp.Autofac;\r\nusing Volo.Abp.Caching.StackExchangeRedis;\r\nusing Volo.Abp.Data;\r\nusing Volo.Abp.EntityFrameworkCore;\r\nusing Volo.Abp.EntityFrameworkCore.PostgreSql;\r\nusing Volo.Abp.EventBus.RabbitMq;\r\nusing Volo.Abp.Localization;\r\nusing Volo.Abp.Modularity;\r\nusing Volo.Abp.MultiTenancy;\r\nusing Volo.Abp.Swashbuckle;\r\n\r\nnamespace Tasky.Shared.Hosting;\r\n\r\n[DependsOn(\r\n    typeof(AbpAutofacModule),\r\n    typeof(AbpDataModule),\r\n    typeof(AbpCachingStackExchangeRedisModule),\r\n    typeof(AbpAspNetCoreSerilogModule),\r\n    typeof(AbpAspNetCoreMultiTenancyModule),\r\n    typeof(AbpSwashbuckleModule),\r\n    typeof(AbpEventBusRabbitMqModule),\r\n    typeof(AbpEntityFrameworkCoreModule),\r\n    typeof(AbpEntityFrameworkCorePostgreSqlModule)\r\n)]\r\npublic class TaskyHostingModule : AbpModule\r\n{\r\n    public override void ConfigureServices(ServiceConfigurationContext context)\r\n    {\r\n        Configure<AbpDbContextOptions>(options =>\r\n        {\r\n            options.UseNpgsql();\r\n        });\r\n\r\n        Configure<AbpMultiTenancyOptions>(options =>\r\n        {\r\n            options.IsEnabled = true;\r\n        });\r\n\r\n        Configure<AbpDbConnectionOptions>(options =>\r\n        {\r\n            options.Databases.Configure(\"SaaSService\", database =>\r\n            {\r\n                database.MappedConnections.Add(\"AbpTenantManagement\");\r\n                database.IsUsedByTenants = false;\r\n            });\r\n\r\n            options.Databases.Configure(\"AdministrationService\", database =>\r\n            {\r\n                database.MappedConnections.Add(\"AbpAuditLogging\");\r\n                database.MappedConnections.Add(\"AbpPermissionManagement\");\r\n                database.MappedConnections.Add(\"AbpSettingManagement\");\r\n                database.MappedConnections.Add(\"AbpFeatureManagement\");\r\n            });\r\n\r\n            options.Databases.Configure(\"IdentityService\", database =>\r\n            {\r\n                database.MappedConnections.Add(\"AbpIdentity\");\r\n                database.MappedConnections.Add(\"AbpIdentityServer\");\r\n            });\r\n        });\r\n\r\n        Configure<AbpLocalizationOptions>(options =>\r\n        {\r\n            options.Languages.Add(new LanguageInfo(\"ar\", \"ar\", \"العربية\"));\r\n            options.Languages.Add(new LanguageInfo(\"cs\", \"cs\", \"Čeština\"));\r\n            options.Languages.Add(new LanguageInfo(\"en\", \"en\", \"English\"));\r\n            options.Languages.Add(new LanguageInfo(\"en-GB\", \"en-GB\", \"English (UK)\"));\r\n            options.Languages.Add(new LanguageInfo(\"fi\", \"fi\", \"Finnish\"));\r\n            options.Languages.Add(new LanguageInfo(\"fr\", \"fr\", \"Français\"));\r\n            options.Languages.Add(new LanguageInfo(\"hi\", \"hi\", \"Hindi\", \"in\"));\r\n            options.Languages.Add(new LanguageInfo(\"is\", \"is\", \"Icelandic\", \"is\"));\r\n            options.Languages.Add(new LanguageInfo(\"it\", \"it\", \"Italiano\", \"it\"));\r\n            options.Languages.Add(new LanguageInfo(\"hu\", \"hu\", \"Magyar\"));\r\n            options.Languages.Add(new LanguageInfo(\"pt-BR\", \"pt-BR\", \"Português\"));\r\n            options.Languages.Add(new LanguageInfo(\"ro-RO\", \"ro-RO\", \"Română\"));\r\n            options.Languages.Add(new LanguageInfo(\"ru\", \"ru\", \"Русский\"));\r\n            options.Languages.Add(new LanguageInfo(\"sk\", \"sk\", \"Slovak\"));\r\n            options.Languages.Add(new LanguageInfo(\"tr\", \"tr\", \"Türkçe\"));\r\n            options.Languages.Add(new LanguageInfo(\"zh-Hans\", \"zh-Hans\", \"简体中文\"));\r\n            options.Languages.Add(new LanguageInfo(\"zh-Hant\", \"zh-Hant\", \"繁體中文\"));\r\n            options.Languages.Add(new LanguageInfo(\"de-DE\", \"de-DE\", \"Deutsch\"));\r\n            options.Languages.Add(new LanguageInfo(\"es\", \"es\", \"Español\"));\r\n        });\r\n    }\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This is the first setup of our microservice application. the package and the modules in this project will become the base of all the services."
    }), "\n", _jsx(_components.p, {
      children: "Repo: https://github.com/antosubash/AbpMicroservice"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Initial setup</title>
          <link>https://blog.antosubash.com/posts/netcore-microservice-with-abp-init-part-1</link>
          <guid>https://blog.antosubash.com/posts/netcore-microservice-with-abp-init-part-1</guid>
          <pubDate>Fri, 18 Mar 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to do the initial setup for a abp microservice application.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    p: "p",
    a: "a",
    h2: "h2",
    span: "span",
    strong: "strong",
    pre: "pre",
    code: "code",
    blockquote: "blockquote"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.p, {
      children: ["This is first post of the series: ", _jsx(_components.a, {
        href: "/posts/abp-microservice-series",
        children: ".NET Microservice with ABP"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "posts-in-the-series",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#posts-in-the-series",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Posts in the Series"]
    }), "\n", _jsx(_components.p, {
      children: "Part 1. Initial Setup (this post)"
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-shared-project-part-2",
        children: "Part 2. Shared Project"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-administration-services-part-3",
        children: "Part 3. Administration Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-services-part-4",
        children: "Part 4. Identity Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-saas-services-part-5",
        children: "Part 5. SaaS Service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-db-migration-part-6",
        children: "Part 6. DB Migration"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-yarp-and-tye-part-7",
        children: "Part 7. Yarp and Tye"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-identity-server-and-angular-part-8",
        children: "Part 8. Identity server and Angular App"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-distributed-event-bus-part-9",
        children: "Part 9. Distributed event bus"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-docker-and-ci-cd-part-10",
        children: "Part 10. Docker and CI/CD"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-new-service-part-11",
        children: "Part 11. Add a New service"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "/posts/netcore-microservice-with-abp-add-central-logging-part-12",
        children: "Part 12. Central Logging"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "initial-setup",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#initial-setup",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Initial Setup"]
    }), "\n", _jsx(_components.p, {
      children: "This is the first step in creating your ABP microservice application. We will create the projects structure and the required projects for your microservice setup."
    }), "\n", _jsx(_components.p, {
      children: "Most of the architecture is based on the EShopOnAbp Sample microservice application here https://github.com/abpframework/eShopOnAbp."
    }), "\n", _jsxs(_components.h2, {
      id: "startup-script",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#startup-script",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Startup script"]
    }), "\n", _jsxs(_components.p, {
      children: ["To simplify the project creation I have created a PowerShell script which will create the required projects and folders for use. You can copy and run this file to just create your base projects. The main reason to create this PowerShell script is the get started quickly. Setting up a microservice solution is a time-consuming process ", _jsx(_components.strong, {
        children: "this script will not create a working solution"
      }), ". This will only create required projects in the particular structure. I came up with this structure following the ", _jsx(_components.a, {
        href: "https://github.com/abpframework/eShopOnAbp",
        children: "EShopOnAbp"
      }), " application. you can update this script with your structure."]
    }), "\n", _jsx(_components.p, {
      children: "You can find the startup script here https://github.com/antosubash/abp-setup/blob/main/init.ps1"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "$name = $args[0]\r\n\r\ndotnet new web -n \"$name.IdentityServer\" -o \"apps\\$name.IdentityServer\"\r\ndotnet new web -n \"$name.Gateway\" -o \"gateway\\$name.Gateway\"\r\ndotnet new classlib -n \"$name.Shared.Hosting\" -o \"shared\\$name.Shared.Hosting\"\r\ndotnet new console -n \"$name.DbMigrator\" -o \"shared\\$name.DbMigrator\"\r\nabp new \"$name.AdministrationService\" -t module --no-ui -o services\\administration\r\nabp new \"$name.IdentityService\" -t module --no-ui -o services\\identity\r\nabp new \"$name.SaaSService\" -t module --no-ui -o services\\saas\r\ndotnet new sln -n \"$name\"\r\ndotnet sln \".\\$name.sln\" add (Get-ChildItem -r **/*.csproj)\r\nabp new \"$name\" -t app -u angular -dbms PostgreSQL -m none --separate-identity-server --database-provider ef -csf -o temp\r\nMove-Item -Path \".\\temp\\$name\\angular\\\" -Destination .\\apps\\angular\r\nMove-Item -Path \".\\temp\\$name\\aspnet-core\\src\\$name.DbMigrator\" -Destination .\\shared\\ -Force\r\nMove-Item -Path \".\\temp\\$name\\aspnet-core\\src\\$name.IdentityServer\" -Destination .\\apps\\ -Force\r\nRemove-Item -Recurse -Force .\\temp\\ \r\ndotnet sln \".\\$name.sln\" remove (Get-ChildItem -r **/*.Installer.csproj)\r\ndotnet sln \".\\$name.sln\" remove (Get-ChildItem -r **/*.Host.Shared.csproj)\r\ndotnet sln \".\\$name.sln\" remove (Get-ChildItem -r **/*.MongoDB.csproj)\r\ndotnet sln \".\\$name.sln\" remove (Get-ChildItem -r **/*.MongoDB.Tests.csproj)\r\ndotnet sln \".\\$name.sln\" remove (Get-ChildItem -r **/*.AdministrationService.IdentityServer.csproj)\r\ndotnet sln \".\\$name.sln\" remove (Get-ChildItem -r **/*.IdentityService.IdentityServer.csproj)\r\ndotnet sln \".\\$name.sln\" remove (Get-ChildItem -r **/*.SaaSService.IdentityServer.csproj)\r\nRemove-Item -Recurse -Force (Get-ChildItem -r **/*.SaaSService.IdentityServer)\r\nRemove-Item -Recurse -Force (Get-ChildItem -r **/*.IdentityService.IdentityServer)\r\nRemove-Item -Recurse -Force (Get-ChildItem -r **/*.AdministrationService.IdentityServer)\r\nRemove-Item -Recurse -Force (Get-ChildItem -r **/*.MongoDB.Tests)\r\nRemove-Item -Recurse -Force (Get-ChildItem -r **/*.MongoDB)\r\nRemove-Item -Recurse -Force (Get-ChildItem -r **/*.Host.Shared)\r\nRemove-Item -Recurse -Force (Get-ChildItem -r **/*.Installer)\r\nabp add-module Volo.AuditLogging -s \"services\\administration\\$name.AdministrationService.sln\" --skip-db-migrations\r\nabp add-module Volo.FeatureManagement -s \"services\\administration\\$name.AdministrationService.sln\" --skip-db-migrations\r\nabp add-module Volo.PermissionManagement -s \"services\\administration\\$name.AdministrationService.sln\" --skip-db-migrations\r\nabp add-module Volo.SettingManagement -s \"services\\administration\\$name.AdministrationService.sln\" --skip-db-migrations\r\n\r\nabp add-module Volo.Identity -s \"services\\identity\\$name.IdentityService.sln\" --skip-db-migrations\r\nabp add-module Volo.IdentityServer -s \"services\\identity\\$name.IdentityService.sln\" --skip-db-migrations\r\n\r\nabp add-module Volo.TenantManagement -s \"services\\saas\\$name.SaaSService.sln\" --skip-db-migrations\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "running-the-startup-script",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#running-the-startup-script",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Running the startup script"]
    }), "\n", _jsxs(_components.p, {
      children: ["To run the startup script just create a new powershell script in the location where you want to create the solution and create a file called ", _jsx(_components.code, {
        children: "init.ps1"
      }), " and copy and past the above mentioned scripts."]
    }), "\n", _jsx(_components.p, {
      children: "To run the script"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: ".\\init.ps1 YourProjectName\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will trigger the scripts and the project creation will start. Wait until the script is done and open the solution to see the created projects."
    }), "\n", _jsxs(_components.blockquote, {
      children: ["\n", _jsx(_components.p, {
        children: "This script will only create the project and the projects are not ready for running it."
      }), "\n"]
    }), "\n", _jsx(_components.p, {
      children: "If you want to know more about what the script is doing please check out the video above which will have an explanation of what the script is doing."
    }), "\n", _jsx(_components.p, {
      children: "Here is the sample repo with the working version of this solution: https://github.com/antosubash/AbpMicroservice"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Removing IdentityServer from ABP No Layer Template</title>
          <link>https://blog.antosubash.com/posts/abp-remove-identity-server-from-abp-no-layers-app</link>
          <guid>https://blog.antosubash.com/posts/abp-remove-identity-server-from-abp-no-layers-app</guid>
          <pubDate>Sun, 30 Jan 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to remove identity server from the No Layer ABP template</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx} = arguments[0];
function _createMdxContent(props) {
  return _jsx(_Fragment, {});
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Introduction to ABP No Layer Template</title>
          <link>https://blog.antosubash.com/posts/abp-no-layer-template</link>
          <guid>https://blog.antosubash.com/posts/abp-no-layer-template</guid>
          <pubDate>Sat, 29 Jan 2022 00:00:00 GMT</pubDate>
          <description>In this post we will explore the new experimental no layer template from the ABP framework</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "ABP team released a new experimental app template with the name \"app-nolayers\". This is a minimal single project ABP application. They have removed all the DDD projects and provided a simple starting point. This will be helpful for the new developers who are trying out the ABP framework. Developers can learn the ABP framework without the DDD complexities."
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-abp-cli",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-abp-cli",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the ABP CLI"]
    }), "\n", _jsx(_components.p, {
      children: "Make sure you have recent version cli before creating the app. you can also use the following command to update the cli."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet tool update -g Volo.Abp.Cli\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "creating-the-no-layers-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#creating-the-no-layers-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Creating the No Layers app"]
    }), "\n", _jsx(_components.p, {
      children: "To create the no layers app run the following command."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp new Acme.BookStore -t app-nolayers\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will create the Bookstore app as a single project application."
    }), "\n", _jsxs(_components.h2, {
      id: "run-the-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-the-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run the migrations"]
    }), "\n", _jsxs(_components.p, {
      children: ["Navigate to the ", _jsx(_components.code, {
        children: "Acme.BookStore"
      }), " folder. Since this is the no-layers application there is no migrations project. To run the migration add the \"--migrate-database\" cli argument"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run --migrate-database\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will add the migrations and seed the database for you. Database will add the ", _jsx(_components.code, {
        children: "admin"
      }), " user and the required permissions."]
    }), "\n", _jsxs(_components.h2, {
      id: "running-the-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#running-the-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Running the app"]
    }), "\n", _jsxs(_components.p, {
      children: ["To run the app use ", _jsx(_components.code, {
        children: "dotnet watch"
      }), " or ", _jsx(_components.code, {
        children: "dotnet run"
      }), "."]
    }), "\n", _jsx(_components.p, {
      children: "You will see a empty app running."
    }), "\n", _jsx(_components.p, {
      children: "This app has all the modules of the normal abp application. you have IdentityServer configured as well."
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Add tailwindcss to your ABP MVC UI</title>
          <link>https://blog.antosubash.com/posts/abp-add-tailwindcss-to-dotnet-mvc</link>
          <guid>https://blog.antosubash.com/posts/abp-add-tailwindcss-to-dotnet-mvc</guid>
          <pubDate>Tue, 11 Jan 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to add tailwind css to your ABP MVC UI.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    code: "code",
    h3: "h3",
    pre: "pre",
    ul: "ul",
    li: "li"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will explore how to add TailWind CSS to your ABP MVC application. We will configure tailwind and create a new landing page with tailwind. Tailwind comes with the JIT mode. so you will only use the css need not the whole library. This will result in smaller css file compared to another framework."
    }), "\n", _jsxs(_components.h2, {
      id: "prerequisites",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#prerequisites",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Prerequisites"]
    }), "\n", _jsxs(_components.p, {
      children: ["Make sure to install ", _jsx(_components.code, {
        children: "node"
      }), ", ", _jsx(_components.code, {
        children: "npm"
      }), ", ", _jsx(_components.code, {
        children: ".net6"
      }), " and ", _jsx(_components.code, {
        children: "abp"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "create-an-abp-app-and-run-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-an-abp-app-and-run-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create an abp App and Run Migrations"]
    }), "\n", _jsxs(_components.h3, {
      id: "create-the-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the App"]
    }), "\n", _jsx(_components.p, {
      children: "Run the following command to create the abp app."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp new AbpTailwindMvc\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "run-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run Migrations"]
    }), "\n", _jsxs(_components.p, {
      children: ["change directory to ", _jsx(_components.code, {
        children: "src/AbpTailwindMvc.DbMigrator"
      }), " and run the migration project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will create the migrations and seed the data for your project."
    }), "\n", _jsxs(_components.h2, {
      id: "install-tailwind",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-tailwind",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install Tailwind"]
    }), "\n", _jsxs(_components.p, {
      children: ["Navigate to ", _jsx(_components.code, {
        children: "src/AbpTailwindMvc.Web"
      }), " project and then init npm."]
    }), "\n", _jsxs(_components.h3, {
      id: "install-npm-packages",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-npm-packages",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install npm packages"]
    }), "\n", _jsx(_components.p, {
      children: "Lets add the required packages for the tailwind css."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "npm install -D tailwindcss postcss autoprefixer\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "initialize-tailwind",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#initialize-tailwind",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Initialize Tailwind"]
    }), "\n", _jsx(_components.p, {
      children: "To initialize tailwind run the following command."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "npx tailwindcss init --postcss\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will create tailwind config file ", _jsx(_components.code, {
        children: "tailwind.config.js"
      }), " and postcss config file ", _jsx(_components.code, {
        children: "postcss.config.js"
      })]
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-tailwind-config",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-tailwind-config",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the tailwind config"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-js",
        children: "module.exports = {\r\n  content: [\r\n    '!**/{bin,obj,node_modules}/**',\r\n    '**/*.{cshtml,html}',\r\n  ],\r\n  theme: {\r\n    extend: {},\r\n  },\r\n  corePlugins: {\r\n    preflight: false,\r\n  },\r\n  //prefix: 'tw-',\r\n  plugins: [],\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "We have make 2 changes in the default config."
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsxs(_components.li, {
        children: ["We have updated the content to look for ", _jsx(_components.code, {
          children: "cshtml"
        }), " and ", _jsx(_components.code, {
          children: "html"
        }), " files"]
      }), "\n", _jsx(_components.li, {
        children: "We have remove the preflight"
      }), "\n"]
    }), "\n", _jsxs(_components.h3, {
      id: "create-tailwind-css-files",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-tailwind-css-files",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create Tailwind css files"]
    }), "\n", _jsxs(_components.p, {
      children: ["We need to create 2 ", _jsx(_components.code, {
        children: "css"
      }), " files"]
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsxs(_components.li, {
        children: [_jsx(_components.code, {
          children: "/Style/tailwind.css"
        }), " // This is the input"]
      }), "\n", _jsxs(_components.li, {
        children: [_jsx(_components.code, {
          children: "/wwwroot/tailwind.css"
        }), " // This is the output"]
      }), "\n"]
    }), "\n", _jsxs(_components.p, {
      children: ["Update the input file with the ", _jsx(_components.code, {
        children: "imports"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-css",
        children: "@import \"tailwindcss/components\";\r\n@import \"tailwindcss/utilities\";\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-packagejson",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-packagejson",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the package.json"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will update the scripts section of the ", _jsx(_components.code, {
        children: "package.json"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-js",
        children: "\"scripts\": {\r\n\"test\": \"echo \\\"Error: no test specified\\\" && exit 1\",\r\n\"buildcss:dev\": \"npx tailwindcss --config tailwind.config.js --postcss postcss.config.js -i ./Style/tailwind.css -o ./wwwroot/tailwind.css\",\r\n\"buildcss:release\": \"npx tailwindcss --config tailwind.config.js --postcss postcss.config.js -i ./Style/tailwind.css -o ./wwwroot/tailwind.css --minify\",\r\n\"watch\": \"npx tailwindcss --config tailwind.config.js --postcss postcss.config.js -i ./Style/tailwind.css -o ./wwwroot/tailwind.css --watch\"\r\n},\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["We have add the 3 new scripts to the our ", _jsx(_components.code, {
        children: "package.json"
      })]
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsxs(_components.li, {
        children: [_jsx(_components.code, {
          children: "buildcss:dev"
        }), " this will build the css based on the tailwind config"]
      }), "\n", _jsxs(_components.li, {
        children: [_jsx(_components.code, {
          children: "buildcss:release"
        }), " this will build minified css based on the tailwind config"]
      }), "\n", _jsxs(_components.li, {
        children: [_jsx(_components.code, {
          children: "watch"
        }), " will watch for the new changes and create update the output file"]
      }), "\n"]
    }), "\n", _jsxs(_components.h3, {
      id: "add-tailwindcss-to-you-mvc-app-bundle",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-tailwindcss-to-you-mvc-app-bundle",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add tailwindcss to you MVC app bundle"]
    }), "\n", _jsxs(_components.p, {
      children: ["In the ", _jsx(_components.code, {
        children: "AbpTailwindMvcWebModule"
      }), " update the ", _jsx(_components.code, {
        children: "ConfigureBundles"
      }), " method"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "Configure<AbpBundlingOptions>(options =>\r\n            {\r\n                options.StyleBundles.Configure(\r\n                    BasicThemeBundles.Styles.Global,\r\n                    bundle =>\r\n                    {\r\n                        bundle.AddFiles(\"/global-styles.css\");\r\n                        bundle.AddFiles(\"/tailwind.css\");\r\n                    }\r\n                );\r\n            });\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-csproj",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-csproj",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update csproj"]
    }), "\n", _jsxs(_components.p, {
      children: ["We need to build the css before the project is launched. To do that we will update the ", _jsx(_components.code, {
        children: "csproj"
      }), " and create a build task."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<Target Name=\"BuildCSS\" BeforeTargets=\"Compile\">\r\n    <Exec Command=\"npm run buildcss:dev\" Condition=\" '$(Configuration)' == 'Debug' \" />\r\n    <Exec Command=\"npm run buildcss:release\" Condition=\" '$(Configuration)' == 'Release' \" />\r\n</Target>\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This command will run the npm command before the build so that we will have our css complied and ready to be displayed."
    }), "\n", _jsxs(_components.h3, {
      id: "usage",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#usage",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Usage"]
    }), "\n", _jsxs(_components.p, {
      children: ["To apply a background color use ", _jsx(_components.code, {
        children: "bg-gray-200"
      }), " you will see the color change."]
    }), "\n", _jsx(_components.p, {
      children: "Repo: https://github.com/antosubash/AbpTailwindMvcUI"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Generate typescript client from swagger / OpenApi</title>
          <link>https://blog.antosubash.com/posts/abp-generate-typescript-client-from-swagger-and-openapi</link>
          <guid>https://blog.antosubash.com/posts/abp-generate-typescript-client-from-swagger-and-openapi</guid>
          <pubDate>Sat, 08 Jan 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to use how to use the NSwag to generate a typescript client with ABP</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    h3: "h3",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to use NSwag to generate typescript client from swagger and open api. We will use abp as a sample app and generate typescript client."
    }), "\n", _jsxs(_components.h2, {
      id: "create-an-abp-app-and-run-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-an-abp-app-and-run-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create an abp App and Run Migrations"]
    }), "\n", _jsxs(_components.h3, {
      id: "create-the-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the App"]
    }), "\n", _jsx(_components.p, {
      children: "Run the following command to create the abp app."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp new AbpNSwag\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "run-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run Migrations"]
    }), "\n", _jsxs(_components.p, {
      children: ["change directory to ", _jsx(_components.code, {
        children: "src/AbpNSwag.DbMigrator"
      }), " and run the migration project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "fix-the-type-name-in-the-swagger",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#fix-the-type-name-in-the-swagger",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Fix the type name in the swagger"]
    }), "\n", _jsxs(_components.h3, {
      id: "create-type-extension",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-type-extension",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create type extension"]
    }), "\n", _jsx(_components.p, {
      children: "Change the custom schema id for NSwag generation"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using System;\r\nusing System.Linq;\r\nusing System.Reflection;\r\nusing System.Runtime.Serialization;\r\nusing System.Text;\r\n\r\nnamespace AbpNSwag\r\n{\r\n    public static class TypeExtensions\r\n    {\r\n        public static string FriendlyId(this Type type, bool fullyQualified = false)\r\n        {\r\n            var typeName = fullyQualified\r\n                ? type.FullNameSansTypeParameters().Replace(\"+\", \".\")\r\n                : type.Name;\r\n\r\n            if (type.IsGenericType)\r\n            {\r\n                var genericArgumentIds = type.GetGenericArguments()\r\n                    .Select(t => t.FriendlyId(fullyQualified))\r\n                    .ToArray();\r\n\r\n                return new StringBuilder(typeName)\r\n                    .Replace(string.Format(\"`{0}\", genericArgumentIds.Count()), string.Empty)\r\n                    .Append(string.Format(\"[{0}]\", string.Join(\",\", genericArgumentIds).TrimEnd(',')))\r\n                    .ToString();\r\n            }\r\n\r\n            return typeName;\r\n        }\r\n\r\n        public static string FullNameSansTypeParameters(this Type type)\r\n        {\r\n            var fullName = type.FullName;\r\n            if (string.IsNullOrEmpty(fullName))\r\n                fullName = type.Name;\r\n            var chopIndex = fullName.IndexOf(\"[[\");\r\n            return (chopIndex == -1) ? fullName : fullName.Substring(0, chopIndex);\r\n        }\r\n\r\n        public static string[] GetEnumNamesForSerialization(this Type enumType)\r\n        {\r\n            return enumType.GetFields(BindingFlags.Public | BindingFlags.NonPublic | BindingFlags.Static)\r\n                .Select(fieldInfo =>\r\n                {\r\n                    var memberAttribute = fieldInfo.GetCustomAttributes(false).OfType<EnumMemberAttribute>().FirstOrDefault();\r\n                    return (memberAttribute == null || string.IsNullOrWhiteSpace(memberAttribute.Value))\r\n                        ? fieldInfo.Name\r\n                        : memberAttribute.Value;\r\n                })\r\n                .ToArray();\r\n        }\r\n    }\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This file is copied from the here https://github.com/domaindrivendev/Swashbuckle.WebApi/blob/master/Swashbuckle.Core/Swagger/TypeExtensions.cs"
    }), "\n", _jsxs(_components.h3, {
      id: "change-the-custom-schema-id-and-operation-id",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#change-the-custom-schema-id-and-operation-id",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Change the custom schema id and operation id"]
    }), "\n", _jsxs(_components.p, {
      children: ["Update ", _jsx(_components.code, {
        children: "AddAbpSwaggerGenWithOAuth"
      }), " method call in your web project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "options.CustomSchemaIds(type => type.FriendlyId().Replace(\"[\", \"Of\").Replace(\"]\", \"\"));\r\noptions.CustomOperationIds(options => $\"{options.ActionDescriptor.RouteValues[\"controller\"]}{options.ActionDescriptor.RouteValues[\"action\"]}\");\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "this will fix the generic list problem and simplify the name in the swagger ui."
    }), "\n", _jsx(_components.p, {
      children: "Now we are ready to generate the typescript client."
    }), "\n", _jsxs(_components.h2, {
      id: "install-nswag",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-nswag",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install NSwag"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "npm install nswag -g\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "generate-typescript-client",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#generate-typescript-client",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Generate typescript client"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "nswag openapi2tsclient /input:https://localhost:44392/swagger/v1/swagger.json /output:generated/MyProjectModels.ts /typeScriptTemplate Axios\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will generate the ", _jsx(_components.code, {
        children: "Axios"
      }), " client for you to use."]
    }), "\n", _jsxs(_components.h2, {
      id: "other-generators",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#other-generators",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Other generators"]
    }), "\n", _jsxs(_components.p, {
      children: ["Other options is to use the ", _jsx(_components.code, {
        children: "openapi-typescript-codegen"
      }), " package. Install the package globally."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "npm install openapi-typescript-codegen -g\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "create the local copy of swagger json from here https://localhost:44392/swagger/v1/swagger.json now we can use this json file to generate type script client."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "openapi -i swagger.json -o api -c axios\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "this will generate axios client with proper structure."
    }), "\n", _jsx(_components.p, {
      children: "Repo : https://github.com/antosubash/AbpNSwag"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Add tailwindcss to your ABP Blazor UI</title>
          <link>https://blog.antosubash.com/posts/abp-add-tailwindcss-to-blazor-ui</link>
          <guid>https://blog.antosubash.com/posts/abp-add-tailwindcss-to-blazor-ui</guid>
          <pubDate>Wed, 05 Jan 2022 00:00:00 GMT</pubDate>
          <description>In this post we will see how to add tailwind css to your ABP Blazor UI.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    code: "code",
    h3: "h3",
    pre: "pre",
    ul: "ul",
    li: "li"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will explore how to add TailWind CSS to your ABP Blazor application. We will configure tailwind in a way that it will not conflict with your current bootstrap theme. Tailwind comes with the JIT mode. so you will only use the css need not the whole library. This will result in smaller css file compared to another framework."
    }), "\n", _jsxs(_components.h2, {
      id: "prerequisites",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#prerequisites",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Prerequisites"]
    }), "\n", _jsxs(_components.p, {
      children: ["Make sure to install ", _jsx(_components.code, {
        children: "node"
      }), ", ", _jsx(_components.code, {
        children: "npm"
      }), ", ", _jsx(_components.code, {
        children: ".net6"
      }), " and ", _jsx(_components.code, {
        children: "abp"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "create-an-abp-app-and-run-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-an-abp-app-and-run-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create an abp App and Run Migrations"]
    }), "\n", _jsxs(_components.h3, {
      id: "create-the-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the App"]
    }), "\n", _jsx(_components.p, {
      children: "Run the following command to create the abp app."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp new AbpTailwindBlazor -t app -u blazor --mobile none\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "run-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run Migrations"]
    }), "\n", _jsxs(_components.p, {
      children: ["change directory to ", _jsx(_components.code, {
        children: "src/AbpTailwindBlazor.DbMigrator"
      }), " and run the migration project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will create the migrations and seed the data for your project."
    }), "\n", _jsxs(_components.h2, {
      id: "install-tailwind",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-tailwind",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install Tailwind"]
    }), "\n", _jsxs(_components.p, {
      children: ["Navigate to ", _jsx(_components.code, {
        children: "src/AbpTailwindBlazor.Blazor"
      }), " project and then init npm."]
    }), "\n", _jsxs(_components.h3, {
      id: "init-npm",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#init-npm",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Init Npm"]
    }), "\n", _jsx(_components.p, {
      children: "To init npm run the following command."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "npm init --yes\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will create the ", _jsx(_components.code, {
        children: "package.json"
      }), " file with the default values."]
    }), "\n", _jsxs(_components.h3, {
      id: "install-npm-packages",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-npm-packages",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install npm packages"]
    }), "\n", _jsx(_components.p, {
      children: "Lets add the required packages for the tailwind css."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "npm install -D tailwindcss postcss autoprefixer\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "initialize-tailwind",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#initialize-tailwind",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Initialize Tailwind"]
    }), "\n", _jsx(_components.p, {
      children: "To initialize tailwind run the following command."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "npx tailwindcss init --postcss\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will create tailwind config file ", _jsx(_components.code, {
        children: "tailwind.config.js"
      }), " and postcss config file ", _jsx(_components.code, {
        children: "postcss.config.js"
      })]
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-tailwind-config",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-tailwind-config",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the tailwind config"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-js",
        children: "module.exports = {\r\n  content: [\r\n    '!**/{bin,obj,node_modules}/**',\r\n    '**/*.{razor,html}',\r\n  ],\r\n  theme: {\r\n    extend: {},\r\n  },\r\n  corePlugins: {\r\n    preflight: false,\r\n  },\r\n  prefix: 'tw-',\r\n  plugins: [],\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "We have make 3 changes in the default config."
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsxs(_components.li, {
        children: ["We have updated the content to look for ", _jsx(_components.code, {
          children: "razor"
        }), " and ", _jsx(_components.code, {
          children: "html"
        }), " files"]
      }), "\n", _jsx(_components.li, {
        children: "We have remove the preflight"
      }), "\n", _jsxs(_components.li, {
        children: ["We have add ", _jsx(_components.code, {
          children: "prefix"
        }), " to all the tailwind css"]
      }), "\n"]
    }), "\n", _jsxs(_components.h3, {
      id: "create-tailwind-css-files",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-tailwind-css-files",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create Tailwind css files"]
    }), "\n", _jsxs(_components.p, {
      children: ["We need to create 2 ", _jsx(_components.code, {
        children: "css"
      }), " files"]
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsxs(_components.li, {
        children: [_jsx(_components.code, {
          children: "/Style/tailwind.css"
        }), " // This is the input"]
      }), "\n", _jsxs(_components.li, {
        children: [_jsx(_components.code, {
          children: "/wwwroot/tailwind.css"
        }), " // This is the output"]
      }), "\n"]
    }), "\n", _jsxs(_components.p, {
      children: ["Update the input file with the ", _jsx(_components.code, {
        children: "imports"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-css",
        children: "@import \"tailwindcss/components\";\r\n@import \"tailwindcss/utilities\";\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-packagejson",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-packagejson",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the package.json"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will update the scripts section of the ", _jsx(_components.code, {
        children: "package.json"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-js",
        children: "\"scripts\": {\r\n\"test\": \"echo \\\"Error: no test specified\\\" && exit 1\",\r\n\"buildcss:dev\": \"npx tailwindcss --config tailwind.config.js --postcss postcss.config.js -i ./Style/tailwind.css -o ./wwwroot/tailwind.css\",\r\n\"buildcss:release\": \"npx tailwindcss --config tailwind.config.js --postcss postcss.config.js -i ./Style/tailwind.css -o ./wwwroot/tailwind.css --minify\",\r\n\"watch\": \"npx tailwindcss --config tailwind.config.js --postcss postcss.config.js -i ./Style/tailwind.css -o ./wwwroot/tailwind.css --watch\"\r\n},\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["We have add the 3 new scripts to the our ", _jsx(_components.code, {
        children: "package.json"
      })]
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsxs(_components.li, {
        children: [_jsx(_components.code, {
          children: "buildcss:dev"
        }), " this will build the css based on the tailwind config"]
      }), "\n", _jsxs(_components.li, {
        children: [_jsx(_components.code, {
          children: "buildcss:release"
        }), " this will build minified css based on the tailwind config"]
      }), "\n", _jsxs(_components.li, {
        children: [_jsx(_components.code, {
          children: "watch"
        }), " will watch for the new changes and create update the output file"]
      }), "\n"]
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-index-page",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-index-page",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the Index page"]
    }), "\n", _jsxs(_components.p, {
      children: ["The Index page is the ", _jsx(_components.code, {
        children: "index.html"
      }), " file inside the ", _jsx(_components.code, {
        children: "wwwroot"
      }), " folder."]
    }), "\n", _jsx(_components.p, {
      children: "We have add our generated css file to the blazor."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-html",
        children: "<link href=\"tailwind.css\" rel=\"stylesheet\"/>\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-csproj",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-csproj",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update csproj"]
    }), "\n", _jsxs(_components.p, {
      children: ["We need to build the css before the project is launched. To do that we will update the ", _jsx(_components.code, {
        children: "csproj"
      }), " and create a build task."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<Target Name=\"BuildCSS\" BeforeTargets=\"Compile\">\r\n    <Exec Command=\"npm run buildcss:dev\" Condition=\" '$(Configuration)' == 'Debug' \" />\r\n    <Exec Command=\"npm run buildcss:release\" Condition=\" '$(Configuration)' == 'Release' \" />\r\n</Target>\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This command will run the npm command before the build so that we will have our css complied and ready to be displayed."
    }), "\n", _jsxs(_components.h3, {
      id: "usage",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#usage",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Usage"]
    }), "\n", _jsxs(_components.p, {
      children: ["To use the tailwind css you should use the ", _jsx(_components.code, {
        children: "tw-"
      }), " prefix. so to apply a background color use ", _jsx(_components.code, {
        children: "tw-bg-gray-200"
      }), " you will see the color change."]
    }), "\n", _jsx(_components.p, {
      children: "Repo: https://github.com/antosubash/AbpTailwindBlazor"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Minimal Api with ABP - Swagger and CRUD - Part 3</title>
          <link>https://blog.antosubash.com/posts/abp-crud-with-minimal-api-p3</link>
          <guid>https://blog.antosubash.com/posts/abp-crud-with-minimal-api-p3</guid>
          <pubDate>Fri, 31 Dec 2021 00:00:00 GMT</pubDate>
          <description>In this post we will see how to use minimal api with the ABP application to create a CRUD app.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this we will continue with the last one and create a CRUD API with Minimal API."
    }), "\n", _jsxs(_components.p, {
      children: ["This is a continuation of ", _jsx(_components.a, {
        href: "https://blog.antosubash.com/posts/abp-with-minimal-api-p2",
        children: "Part 2"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "create-the-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet new web -n MinimalAbpCRUD\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Navigate to the ", _jsx(_components.code, {
        children: "MinimalAbpCRUD"
      }), " folder and add the required packages."]
    }), "\n", _jsxs(_components.h2, {
      id: "add-required-packages",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-required-packages",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add required packages"]
    }), "\n", _jsxs(_components.p, {
      children: ["To add the required packages use the ", _jsx(_components.code, {
        children: "dotnet add package"
      }), " command."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet add package Volo.Abp.Autofac\r\ndotnet add package Volo.Abp.AspNetCore.Mvc\r\ndotnet add package Swashbuckle.AspNetCore \r\ndotnet add package Volo.Abp.EntityFrameworkCore.Sqlite\r\ndotnet add package Microsoft.EntityFrameworkCore.Design\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-entity",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-entity",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create Entity"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will create a simple ", _jsx(_components.code, {
        children: "Book"
      }), " Entity."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class Book : AuditedAggregateRoot<Guid>\r\n{\r\n    public Book(Guid id, string name)\r\n    {\r\n        this.Id = id;\r\n        this.Name = name;\r\n    }\r\n    public string Name { get; set; }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-db-context",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-db-context",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create DB Context"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class MyDbContext : AbpDbContext<MyDbContext>\r\n{\r\n    public DbSet<Book> Books => Set<Book>();\r\n\r\n    public MyDbContext(DbContextOptions<MyDbContext> options)\r\n        : base(options)\r\n    {\r\n    }\r\n\r\n    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)\r\n    {\r\n        base.OnConfiguring(optionsBuilder);\r\n        optionsBuilder.UseSqlite();\r\n    }\r\n\r\n    protected override void OnModelCreating(ModelBuilder builder)\r\n    {\r\n        base.OnModelCreating(builder);\r\n        builder.Entity<Book>(b =>\r\n        {\r\n            b.ToTable(\"Books\");\r\n            b.ConfigureByConvention();\r\n            b.HasData(new Book(Guid.NewGuid(),\"My Book\"));\r\n        });\r\n    }\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This db context will configure the entity and also seed the database with one data."
    }), "\n", _jsxs(_components.h2, {
      id: "create-the-minimal-module",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-minimal-module",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the minimal module"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[DependsOn(\r\n    typeof(AbpAspNetCoreMvcModule),\r\n    typeof(AbpAutofacModule),\r\n    typeof(AbpEntityFrameworkCoreSqliteModule)\r\n)]\r\npublic class MinimalModule : AbpModule\r\n{\r\n    public override void ConfigureServices(ServiceConfigurationContext context)\r\n    {  \r\n        context.Services.AddEndpointsApiExplorer();\r\n        context.Services.AddSwaggerGen();   \r\n        context.Services.AddAbpDbContext<MyDbContext>(options =>\r\n        {\r\n            options.AddDefaultRepositories(includeAllEntities: true);\r\n        }); \r\n        Configure<AbpDbContextOptions>(options =>\r\n        {\r\n            options.UseSqlite();\r\n        });\r\n    }\r\n\r\n    public override void OnApplicationInitialization(ApplicationInitializationContext context)\r\n    {\r\n        var app = context.GetApplicationBuilder();\r\n        var env = context.GetEnvironment();\r\n        if (env.IsDevelopment())\r\n        {\r\n            app.UseSwagger();\r\n            app.UseSwaggerUI();\r\n        }\r\n        app.UseHttpsRedirection();\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-the-minimal-api",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-minimal-api",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the minimal api"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "var builder = WebApplication.CreateBuilder(args);\r\nbuilder.Host.AddAppSettingsSecretsJson().UseAutofac();\r\nbuilder.Services.ReplaceConfiguration(builder.Configuration);\r\nbuilder.Services.AddApplication<MinimalModule>();\r\nvar app = builder.Build();\r\n\r\napp.MapGet(\"/book\", async ([FromServices] IRepository<Book, Guid> repository) =>\r\n{\r\n    return await repository.GetListAsync();\r\n});\r\n\r\napp.MapPost(\"/book\", async (string name, [FromServices] IRepository<Book, Guid> repository) =>\r\n{\r\n    var newBook = await repository.InsertAsync(new Book(Guid.NewGuid(),name));\r\n    return Results.Created($\"/book/{newBook.Id}\", newBook);\r\n});\r\n\r\napp.MapPut(\"/book/{id}\", async (Guid id, string name, [FromServices] IRepository<Book, Guid> repository) =>\r\n{\r\n    var book = await repository.GetAsync(id);\r\n    book.Name = name;\r\n    return await repository.UpdateAsync(book);\r\n});\r\n\r\napp.MapDelete(\"/book/{id}\", async (Guid id, [FromServices] IRepository<Book, Guid> repository) =>\r\n{\r\n    var book = await repository.GetAsync(id);\r\n    await repository.DeleteAsync(id);\r\n});\r\n\r\napp.InitializeApplication();\r\napp.Run();\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "add-connection-string",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-connection-string",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add connection string"]
    }), "\n", _jsxs(_components.p, {
      children: ["update the ", _jsx(_components.code, {
        children: "appsettings.json"
      }), " with the ", _jsx(_components.code, {
        children: "ConnectionStrings"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-js",
        children: "\"ConnectionStrings\": {\r\n    \"Default\": \"Filename=./db.sqlite\"\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-migration",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-migration",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create migration"]
    }), "\n", _jsx(_components.p, {
      children: "Now our app is ready lets create migrations for the DBcontext."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef migrations add init\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "apply-migrations-to-db",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#apply-migrations-to-db",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Apply migrations to DB"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef database update\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "run-the-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-the-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run the App"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "view-the-book",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#view-the-book",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "View the Book"]
    }), "\n", _jsxs(_components.p, {
      children: ["Once the application is launched navigate to ", _jsx(_components.code, {
        children: "/swagger"
      }), " you will see swagger UI."]
    }), "\n", _jsx(_components.p, {
      children: "Repo : https://github.com/antosubash/AbpMinimalApiCRUD"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Minimal Api with ABP - EF Core - Part 2</title>
          <link>https://blog.antosubash.com/posts/abp-with-minimal-api-p2</link>
          <guid>https://blog.antosubash.com/posts/abp-with-minimal-api-p2</guid>
          <pubDate>Thu, 30 Dec 2021 00:00:00 GMT</pubDate>
          <description>In this post we will see how to use minimal api with the ABP application and configure EF core.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this we will continue with the last one and add Ef core to our Minimal ABP module."
    }), "\n", _jsxs(_components.p, {
      children: ["This is a continuation of ", _jsx(_components.a, {
        href: "https://blog.antosubash.com/posts/abp-with-minimal-api-p1",
        children: "Part 1"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "create-the-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet new web -n MinimalEFWithAbp\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Navigate to the ", _jsx(_components.code, {
        children: "MinimalEFWithAbp"
      }), " folder and add the required packages."]
    }), "\n", _jsxs(_components.h2, {
      id: "add-required-packages",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-required-packages",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add required packages"]
    }), "\n", _jsxs(_components.p, {
      children: ["To add the required packages use the ", _jsx(_components.code, {
        children: "dotnet add package"
      }), " command."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet add package Volo.Abp.Autofac\r\ndotnet add package Volo.Abp.AspNetCore.Mvc\r\ndotnet add package Volo.Abp.EntityFrameworkCore.Sqlite\r\ndotnet add package Microsoft.EntityFrameworkCore.Design\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-entity",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-entity",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create Entity"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will create a simple ", _jsx(_components.code, {
        children: "Book"
      }), " Entity."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class Book : AuditedAggregateRoot<Guid>\r\n{\r\n    public Book(Guid id, string name)\r\n    {\r\n        this.Id = id;\r\n        this.Name = name;\r\n    }\r\n    public string Name { get; set; }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-db-context",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-db-context",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create DB Context"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class MyDbContext : AbpDbContext<MyDbContext>\r\n{\r\n    public DbSet<Book> Books => Set<Book>();\r\n\r\n    public MyDbContext(DbContextOptions<MyDbContext> options)\r\n        : base(options)\r\n    {\r\n    }\r\n\r\n    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)\r\n    {\r\n        base.OnConfiguring(optionsBuilder);\r\n        optionsBuilder.UseSqlite();\r\n    }\r\n\r\n    protected override void OnModelCreating(ModelBuilder builder)\r\n    {\r\n        base.OnModelCreating(builder);\r\n        builder.Entity<Book>(b =>\r\n        {\r\n            b.ToTable(\"Books\");\r\n            b.ConfigureByConvention();\r\n            b.HasData(new Book(Guid.NewGuid(),\"My Book\"));\r\n        });\r\n    }\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This db context will configure the entity and also seed the database with one data."
    }), "\n", _jsxs(_components.h2, {
      id: "create-the-minimal-module",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-minimal-module",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the minimal module"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[DependsOn(\r\n    typeof(AbpAspNetCoreMvcModule),\r\n    typeof(AbpAutofacModule),\r\n    typeof(AbpEntityFrameworkCoreSqliteModule)\r\n)]\r\npublic class MinimalModule : AbpModule\r\n{\r\n    public override void ConfigureServices(ServiceConfigurationContext context)\r\n    {     \r\n        context.Services.AddAbpDbContext<MyDbContext>(options =>\r\n        {\r\n            options.AddDefaultRepositories(includeAllEntities: true);\r\n        }); \r\n        Configure<AbpDbContextOptions>(options =>\r\n        {\r\n            options.UseSqlite();\r\n        });\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-the-minimal-api",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-minimal-api",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the minimal api"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "var builder = WebApplication.CreateBuilder(args);\r\nbuilder.Host.AddAppSettingsSecretsJson()\r\n    .UseAutofac();\r\nbuilder.Services.ReplaceConfiguration(builder.Configuration);\r\nbuilder.Services.AddApplication<MinimalModule>();\r\nvar app = builder.Build();\r\n\r\napp.MapGet(\"/book\", async ([FromServices] IRepository<Book, Guid> repository) =>\r\n{\r\n    return await repository.GetListAsync();\r\n});\r\n\r\napp.InitializeApplication();\r\napp.Run();\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["We have one ", _jsx(_components.code, {
        children: "GET"
      }), " request which will return the data from the db."]
    }), "\n", _jsxs(_components.h2, {
      id: "add-connection-string",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-connection-string",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add connection string"]
    }), "\n", _jsxs(_components.p, {
      children: ["update the ", _jsx(_components.code, {
        children: "appsettings.json"
      }), " with the ", _jsx(_components.code, {
        children: "ConnectionStrings"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-js",
        children: "\"ConnectionStrings\": {\r\n    \"Default\": \"Filename=./db.sqlite\"\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-migration",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-migration",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create migration"]
    }), "\n", _jsx(_components.p, {
      children: "Now our app is ready lets create migrations for the DBcontext."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef migrations add init\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "apply-migrations-to-db",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#apply-migrations-to-db",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Apply migrations to DB"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef database update\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "run-the-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-the-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run the App"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "view-the-book",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#view-the-book",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "View the Book"]
    }), "\n", _jsxs(_components.p, {
      children: ["Once the application is launched navigate to ", _jsx(_components.code, {
        children: "/book"
      }), " you will see the seeded book as a json response."]
    }), "\n", _jsx(_components.p, {
      children: "Repo : https://github.com/antosubash/AbpMinimalApiWithEFCore"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Minimal Api with ABP - Hello World - Part 1</title>
          <link>https://blog.antosubash.com/posts/abp-with-minimal-api-p1</link>
          <guid>https://blog.antosubash.com/posts/abp-with-minimal-api-p1</guid>
          <pubDate>Wed, 29 Dec 2021 00:00:00 GMT</pubDate>
          <description>In this post we will see how to use minimal api with the ABP application.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    pre: "pre",
    code: "code",
    h3: "h3"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "Minimal api in .Net 6 provides a new way for creating http api. Minimal API provides simplicity and removes lot of boilerplate. We will see how to use the minimal api with ABP."
    }), "\n", _jsxs(_components.h2, {
      id: "hello-world",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#hello-world",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Hello world"]
    }), "\n", _jsx(_components.p, {
      children: "First lets create a empty c# project."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet new web -n HelloWorld\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will create a empty hello world project."
    }), "\n", _jsx(_components.p, {
      children: "Let add the abp packages."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet add package Volo.Abp.Autofac\r\ndotnet add package Volo.Abp.AspNetCore.Mvc\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "minimal-module",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#minimal-module",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Minimal Module"]
    }), "\n", _jsx(_components.p, {
      children: "lets create a very simple module."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[DependsOn(\r\n    typeof(AbpAspNetCoreMvcModule),\r\n    typeof(AbpAutofacModule)\r\n)]\r\npublic class MinimalModule : AbpModule\r\n{\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This module depends on ", _jsx(_components.code, {
        children: "AbpAspNetCoreMvcModule"
      }), " and ", _jsx(_components.code, {
        children: "AbpAutofacModule"
      }), ". The configure service method is used to register the assembly of ", _jsx(_components.code, {
        children: "MinimalModule"
      }), " for dependency injection."]
    }), "\n", _jsxs(_components.h3, {
      id: "hello-service",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#hello-service",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Hello service"]
    }), "\n", _jsx(_components.p, {
      children: "lets create a simple service which will say hello world."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class HelloService : ITransientDependency\r\n{\r\n    public string SayHi()\r\n    {\r\n        return \"Hi from service\";\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "minimal-application",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#minimal-application",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Minimal Application"]
    }), "\n", _jsx(_components.p, {
      children: "Lets create the minimal application"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using Volo.Abp;\r\nusing Microsoft.AspNetCore.Mvc;\r\nusing Volo.Abp.AspNetCore.Mvc;\r\nusing Volo.Abp.Autofac;\r\nusing Volo.Abp.Modularity;\r\nusing Volo.Abp.DependencyInjection;\r\nvar builder = WebApplication.CreateBuilder(args);\r\nbuilder.Host.UseAutofac();\r\nbuilder.Services.ReplaceConfiguration(builder.Configuration);\r\nbuilder.Services.AddApplication<MinimalModule>();\r\n\r\nvar app = builder.Build();\r\n\r\napp.MapGet(\"/hi\", ([FromServices] HelloService helloService) =>\r\n{\r\n    return helloService.SayHi();\r\n});\r\n\r\napp.InitializeApplication();\r\napp.Run();\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This application has only one end point ", _jsx(_components.code, {
        children: "/hi"
      }), " which prints hello world. We are Injecting the hello world service we created and then we are calling the ", _jsx(_components.code, {
        children: "SayHi"
      }), " method from the service."]
    }), "\n", _jsx(_components.p, {
      children: "To run the app."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Repo: https://github.com/antosubash/AbpMinimalApiHelloWorld"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Add a new Module and convert it to a microservice in ABP</title>
          <link>https://blog.antosubash.com/posts/abp-module-to-microservice</link>
          <guid>https://blog.antosubash.com/posts/abp-module-to-microservice</guid>
          <pubDate>Sat, 27 Nov 2021 00:00:00 GMT</pubDate>
          <description>In this post we will see how to create a modular abp application and convert it to microservice. We will add a new module to tiered abp app and then use the separate database to store the modules data and then convert the module to a microservice..</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    code: "code",
    pre: "pre",
    h3: "h3"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to create a modular abp application and convert it to microservice. We will add a new module to tiered abp app and then use the separate database to store the modules data and then convert the module to a microservice."
    }), "\n", _jsxs(_components.p, {
      children: ["In this sample we will create Tiered app which is called ", _jsx(_components.code, {
        children: "MainApp"
      }), ". Then we will add a module called ", _jsx(_components.code, {
        children: "ProjectService"
      }), "."]
    }), "\n", _jsxs(_components.h2, {
      id: "creating-the-abp-application-and-run-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#creating-the-abp-application-and-run-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Creating the abp application and run migrations"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp new MainApp -t app -u mvc --tiered\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "run-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run Migrations"]
    }), "\n", _jsx(_components.p, {
      children: "Change directory to src/MainApp.DbMigrator and run the migration project"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will apply the migrations to the db and we can run the ", _jsx(_components.code, {
        children: "MainApp.Web"
      }), " project. This will host the UI and API.."]
    }), "\n", _jsxs(_components.h2, {
      id: "add-a-new-module",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-a-new-module",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add a new Module"]
    }), "\n", _jsxs(_components.p, {
      children: ["Now we will add a new module to our MainApp. Move back to the ", _jsx(_components.code, {
        children: "root"
      }), " folder of your project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp add-module ProjectService --new\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will create a ProjectService and it will be available in the modules folder."
    }), "\n", _jsxs(_components.h2, {
      id: "add-and-configure-the-host-to-the-module",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-and-configure-the-host-to-the-module",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add and configure the host to the module"]
    }), "\n", _jsx(_components.p, {
      children: "We need to add a host for our module. first we have to navigate to the the src folder of the Module."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "cd .\\modules\\ProjectService\\src\\\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now lets create a Web Api project to host our module."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet new webapi -n ProjectService.HttpApi.Host\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now open the ProjectService solution and the newly created Host project to the solution."
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "appsettings.json"
      }), " with the following"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "{\r\n  \"App\": {\r\n    \"SelfUrl\": \"{Host Url}\",\r\n    \"CorsOrigins\": \"https://*.MainApp.com\"\r\n  },\r\n  \"AuthServer\": {\r\n    \"Authority\": \"{ Identity Server Url }\",\r\n    \"RequireHttpsMetadata\": \"true\",\r\n    \"SwaggerClientId\": \"ProjectService_Swagger\",\r\n    \"SwaggerClientSecret\": \"1q2w3e*\"\r\n  },\r\n  \"ConnectionStrings\": {\r\n    \"ProjectService\": \"Server=(LocalDb)\\\\MSSQLLocalDB;Database=ProjectService;Trusted_Connection=True\"\r\n  },\r\n  \"Redis\": {\r\n    \"Configuration\": \"127.0.0.1\"\r\n  },\r\n  \"Logging\": {\r\n    \"LogLevel\": {\r\n      \"Default\": \"Information\",\r\n      \"Microsoft\": \"Warning\",\r\n      \"Microsoft.Hosting.Lifetime\": \"Information\"\r\n    }\r\n  }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Add the following packages to the ", _jsx(_components.code, {
        children: "ProjectService.HttpApi.Host"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<ItemGroup>\r\n    <PackageReference Include=\"Serilog.AspNetCore\" Version=\"4.1.0\" />\r\n    <PackageReference Include=\"Volo.Abp.EntityFrameworkCore\" Version=\"5.0.0-rc.1\" />\r\n    <PackageReference Include=\"Volo.Abp.AspNetCore.MultiTenancy\" Version=\"5.0.0-rc.1\" />\r\n    <PackageReference Include=\"Volo.Abp.Autofac\" Version=\"5.0.0-rc.1\" />\r\n    <PackageReference Include=\"Volo.Abp.Core\" Version=\"5.0.0-rc.1\" />\r\n    <PackageReference Include=\"Volo.Abp.EntityFrameworkCore.SqlServer\" Version=\"5.0.0-rc.1\" />\r\n    <PackageReference Include=\"Volo.Abp.Swashbuckle\" Version=\"5.0.0-rc.1\" />\r\n    <PackageReference Include=\"Volo.Abp.AspNetCore.Authentication.JwtBearer\" Version=\"5.0.0-rc.1\" />\r\n    <PackageReference Include=\"Volo.Abp.AspNetCore.Serilog\" Version=\"5.0.0-rc.1\" />\r\n    <PackageReference Include=\"Serilog.Extensions.Logging\" Version=\"3.0.1\" />\r\n    <PackageReference Include=\"Serilog.Sinks.Async\" Version=\"1.4.0\" />\r\n    <PackageReference Include=\"Serilog.Sinks.File\" Version=\"4.1.0\" />\r\n    <PackageReference Include=\"Serilog.Sinks.Console\" Version=\"3.1.1\" />\r\n</ItemGroup>\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "These are the essential packages for our host."
    }), "\n", _jsxs(_components.p, {
      children: ["Add ", _jsx(_components.code, {
        children: "ProjectService.Application"
      }), ", ", _jsx(_components.code, {
        children: "ProjectService.EntityFrameworkCore"
      }), ", ", _jsx(_components.code, {
        children: "ProjectService.HttpApi"
      }), " projects as a reference to your ", _jsx(_components.code, {
        children: "ProjectService.HttpApi.Host"
      })]
    }), "\n", _jsx(_components.p, {
      children: "We are adding the projects reference because the host project module will depend on the module from these projects."
    }), "\n", _jsxs(_components.p, {
      children: ["Create a ", _jsx(_components.code, {
        children: "ProjectServiceHostModule"
      }), " in the newly created ", _jsx(_components.code, {
        children: "ProjectService.HttpApi.Host"
      }), ". This will be a abp module where we will setup the host."]
    }), "\n", _jsxs(_components.p, {
      children: ["Here is the sample for the ", _jsx(_components.code, {
        children: "ProductService"
      }), "."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using Microsoft.AspNetCore.Authentication.JwtBearer;\r\nusing Microsoft.AspNetCore.Builder;\r\nusing Microsoft.AspNetCore.Cors;\r\nusing Microsoft.Extensions.Configuration;\r\nusing Microsoft.Extensions.DependencyInjection;\r\nusing Microsoft.Extensions.Hosting;\r\nusing Microsoft.OpenApi.Models;\r\nusing ProjectService.EntityFrameworkCore;\r\nusing System;\r\nusing System.Collections.Generic;\r\nusing System.Linq;\r\nusing Volo.Abp;\r\nusing Volo.Abp.AspNetCore.MultiTenancy;\r\nusing Volo.Abp.AspNetCore.Mvc;\r\nusing Volo.Abp.AspNetCore.Serilog;\r\nusing Volo.Abp.Autofac;\r\nusing Volo.Abp.Modularity;\r\nusing Volo.Abp.Swashbuckle;\r\n\r\nnamespace ProjectService.HttpApi.Host\r\n{\r\n\r\n    [DependsOn(\r\n    typeof(ProjectServiceHttpApiModule),\r\n    typeof(ProjectServiceApplicationModule),\r\n    typeof(ProjectServiceEntityFrameworkCoreModule),\r\n    typeof(AbpAspNetCoreMultiTenancyModule),\r\n    typeof(AbpAutofacModule),\r\n    typeof(AbpAspNetCoreSerilogModule),\r\n    typeof(AbpSwashbuckleModule)\r\n    )]\r\n    public class ProjectServiceHostModule : AbpModule\r\n    {\r\n        public override void ConfigureServices(ServiceConfigurationContext context)\r\n        {\r\n            var configuration = context.Services.GetConfiguration();\r\n            context.Services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)\r\n                .AddJwtBearer(options =>\r\n                {\r\n                    options.Authority = configuration[\"AuthServer:Authority\"];\r\n                    options.RequireHttpsMetadata = Convert.ToBoolean(configuration[\"AuthServer:RequireHttpsMetadata\"]);\r\n                    options.Audience = \"ProjectService\";\r\n                });\r\n\r\n            context.Services.AddAbpSwaggerGenWithOAuth(\r\n                configuration[\"AuthServer:Authority\"],\r\n                new Dictionary<string, string>\r\n                {\r\n                    {\"ProjectService\", \"ProjectService API\"}\r\n                },\r\n                options =>\r\n                {\r\n                    options.SwaggerDoc(\"v1\", new OpenApiInfo { Title = \"ProjectService API\", Version = \"v1\" });\r\n                    options.DocInclusionPredicate((docName, description) => true);\r\n                    options.CustomSchemaIds(type => type.FullName);\r\n                });\r\n\r\n            Configure<AbpAspNetCoreMvcOptions>(options =>\r\n            {\r\n                options.ConventionalControllers.Create(typeof(ProjectServiceApplicationModule).Assembly);\r\n            });\r\n\r\n            context.Services.AddCors(options =>\r\n            {\r\n                options.AddDefaultPolicy(builder =>\r\n                {\r\n                    builder\r\n                        .WithOrigins(\r\n                            configuration[\"App:CorsOrigins\"]\r\n                                .Split(\",\", StringSplitOptions.RemoveEmptyEntries)\r\n                                .Select(o => o.Trim().RemovePostFix(\"/\"))\r\n                                .ToArray()\r\n                        )\r\n                        .WithAbpExposedHeaders()\r\n                        .SetIsOriginAllowedToAllowWildcardSubdomains()\r\n                        .AllowAnyHeader()\r\n                        .AllowAnyMethod()\r\n                        .AllowCredentials();\r\n                });\r\n            });\r\n        }\r\n\r\n        public override void OnApplicationInitialization(ApplicationInitializationContext context)\r\n        {\r\n            var app = context.GetApplicationBuilder();\r\n            var env = context.GetEnvironment();\r\n\r\n            if (env.IsDevelopment())\r\n            {\r\n                app.UseDeveloperExceptionPage();\r\n            }\r\n\r\n            app.UseCorrelationId();\r\n            app.UseCors();\r\n            app.UseAbpRequestLocalization();\r\n            app.UseStaticFiles();\r\n            app.UseRouting();\r\n            app.UseAuthentication();\r\n            app.UseAbpClaimsMap();\r\n            app.UseMultiTenancy();\r\n            app.UseAuthorization();\r\n            app.UseSwagger();\r\n            app.UseAbpSwaggerUI(options => {\r\n                options.SwaggerEndpoint(\"/swagger/v1/swagger.json\", \"ProjectService Service API\");\r\n                var configuration = context.ServiceProvider.GetRequiredService<IConfiguration>();\r\n                options.OAuthClientId(configuration[\"AuthServer:SwaggerClientId\"]); \r\n                options.OAuthClientSecret(configuration[\"AuthServer:SwaggerClientSecret\"]); \r\n            });\r\n            app.UseAbpSerilogEnrichers();\r\n            app.UseAuditing();\r\n            app.UseUnitOfWork();\r\n            app.UseConfiguredEndpoints();\r\n        }\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["In this module the depends on section configures the modules that it depends on in the ", _jsx(_components.code, {
        children: "DependsOn"
      }), " section and we will configure the JWT auth and the swagger UI for the host."]
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "Program.cs"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using System;\r\nusing System.IO;\r\nusing Microsoft.AspNetCore.Hosting;\r\nusing Microsoft.Extensions.Configuration;\r\nusing Microsoft.Extensions.Hosting;\r\nusing Serilog;\r\nusing Serilog.Events;\r\n\r\nnamespace ProjectService\r\n{\r\n    public class Program\r\n    {\r\n        public static int Main(string[] args)\r\n        {\r\n            Log.Logger = new LoggerConfiguration()\r\n#if DEBUG\r\n                .MinimumLevel.Debug()\r\n#else\r\n                .MinimumLevel.Information()\r\n#endif\r\n                .MinimumLevel.Override(\"Microsoft\", LogEventLevel.Information)\r\n                .MinimumLevel.Override(\"Microsoft.EntityFrameworkCore\", LogEventLevel.Warning)\r\n                .Enrich.FromLogContext()\r\n                .WriteTo.Async(c => c.File(\"Logs/logs.txt\"))\r\n#if DEBUG\r\n                .WriteTo.Async(c => c.Console())\r\n#endif\r\n                .CreateLogger();\r\n\r\n            try\r\n            {\r\n                Log.Information(\"Starting ProjectService.Host.\");\r\n                CreateHostBuilder(args).Build().Run();\r\n                return 0;\r\n            }\r\n            catch (Exception ex)\r\n            {\r\n                Log.Fatal(ex, \"Host terminated unexpectedly!\");\r\n                return 1;\r\n            }\r\n            finally\r\n            {\r\n                Log.CloseAndFlush();\r\n            }\r\n        }\r\n\r\n        internal static IHostBuilder CreateHostBuilder(string[] args) =>\r\n            Host.CreateDefaultBuilder(args)\r\n                .ConfigureAppConfiguration(build =>\r\n                {\r\n                    build.AddJsonFile(\"appsettings.secrets.json\", optional: true);\r\n                })\r\n                .ConfigureWebHostDefaults(webBuilder =>\r\n                {\r\n                    webBuilder.UseStartup<Startup>();\r\n                })\r\n                .UseAutofac()\r\n                .UseSerilog();\r\n    }\r\n\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Program file is updated to use the serilog with enrichers."
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "Startup.cs"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using Microsoft.AspNetCore.Builder;\r\nusing Microsoft.AspNetCore.Hosting;\r\nusing Microsoft.Extensions.DependencyInjection;\r\nusing Microsoft.Extensions.Logging;\r\nusing ProjectService.HttpApi.Host;\r\n\r\nnamespace ProjectService\r\n{\r\n    public class Startup\r\n    {\r\n        public void ConfigureServices(IServiceCollection services)\r\n        {\r\n            services.AddApplication<ProjectServiceHostModule>();\r\n        }\r\n\r\n        public void Configure(IApplicationBuilder app, IWebHostEnvironment env, ILoggerFactory loggerFactory)\r\n        {\r\n            app.InitializeApplication();\r\n        }\r\n    }\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "In the startup file we are configuring our newly created Host module."
    }), "\n", _jsxs(_components.p, {
      children: ["Create a ", _jsx(_components.code, {
        children: "HomeController.cs"
      }), " in the ", _jsx(_components.code, {
        children: "Controller"
      }), " folder and update wit the following text."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using Microsoft.AspNetCore.Mvc;\r\nusing Volo.Abp.AspNetCore.Mvc;\r\n\r\nnamespace ProjectService.HttpApi.Host.Controllers\r\n{\r\n    public class HomeController : AbpController\r\n    {\r\n        public ActionResult Index()\r\n        {\r\n            return Redirect(\"~/swagger\");\r\n        }\r\n    }\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now our default route will be swagger."
    }), "\n", _jsx(_components.p, {
      children: "We are mostly done with the host and now we can create the AppService."
    }), "\n", _jsxs(_components.h2, {
      id: "add-new-entity-to-the-projectservice",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-new-entity-to-the-projectservice",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add new Entity to the ProjectService"]
    }), "\n", _jsxs(_components.p, {
      children: ["We are going to create a simple ", _jsx(_components.code, {
        children: "Project"
      }), " entity and create a AppService for that project. This section of the tutorial is based on the ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Tutorials/Todo/Index?UI=MVC&DB=EF",
        children: "Quick Start Guide"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["We will create a new Entity inside the ", _jsx(_components.code, {
        children: "ProjectService.Domain"
      }), " called ", _jsx(_components.code, {
        children: "Project"
      }), "."]
    }), "\n", _jsxs(_components.h2, {
      id: "create-an-entity",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-an-entity",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create an Entity"]
    }), "\n", _jsxs(_components.p, {
      children: ["Learn more about the ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Entities",
        children: "Entity"
      }), " in the abp docs."]
    }), "\n", _jsxs(_components.p, {
      children: ["First step is to create an Entity. Create the Entity in the ", _jsx(_components.code, {
        children: "ProjectService.Domain"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class Project : Entity<Guid>\r\n{\r\n    public string Name { get; set; }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "add-entity-to-efcore",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-entity-to-efcore",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add Entity to EfCore"]
    }), "\n", _jsxs(_components.p, {
      children: ["Learn more about the ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Entity-Framework-Core",
        children: "ef core"
      }), " in the abp docs."]
    }), "\n", _jsxs(_components.p, {
      children: ["Next is to add Entity to the EF Core. you will find the DbContext in the ", _jsx(_components.code, {
        children: "ProjectService.EntityFrameworkCore"
      }), " project. Add the DbSet to the DbContext"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public DbSet<Project> Projects { get; set; }\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "configure-entity-in-efcore",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#configure-entity-in-efcore",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Configure Entity in EfCore"]
    }), "\n", _jsx(_components.p, {
      children: "Make sure you have the updated the ef core global tool"
    }), "\n", _jsxs(_components.p, {
      children: ["Configuration is done in the ", _jsx(_components.code, {
        children: "DbContextModelCreatingExtensions"
      }), " class. This should be available in the ", _jsx(_components.code, {
        children: "ProjectService.EntityFrameworkCore"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "builder.Entity<Project>(b =>\r\n{\r\n    //Configure table & schema name\r\n    b.ToTable(ProjectServiceDbProperties.DbTablePrefix + \"Projects\", ProjectServiceDbProperties.Schema);\r\n\r\n    b.ConfigureByConvention();\r\n});\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "prepare-for-the-migration",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#prepare-for-the-migration",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Prepare for the migration"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet tool update --global dotnet-ef\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Add necessary packages to the ", _jsx(_components.code, {
        children: "ProjectService.EntityFrameworkCore"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<PackageReference Include=\"Microsoft.EntityFrameworkCore.Design\" Version=\"6.0.0\">\r\n    <PrivateAssets>all</PrivateAssets>\r\n    <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>\r\n</PackageReference>\r\n<PackageReference Include=\"Volo.Abp.EntityFrameworkCore\" Version=\"5.0.0-rc.1\" />\r\n<PackageReference Include=\"Volo.Abp.EntityFrameworkCore.SqlServer\" Version=\"5.0.0-rc.1\" />\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["We need to create a ", _jsx(_components.code, {
        children: "ProjectServiceDbContextFactory"
      }), " to support migrations. ", _jsx(_components.a, {
        href: "https://docs.microsoft.com/en-us/ef/core/cli/dbcontext-creation?tabs=dotnet-core-cli",
        children: "Check here for more info about this"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class ProjectServiceDbContextFactory : IDesignTimeDbContextFactory<ProjectServiceDbContext>\r\n{\r\n    public ProjectServiceDbContext CreateDbContext(string[] args)\r\n    {\r\n        var builder = new DbContextOptionsBuilder<ProjectServiceDbContext>()\r\n            .UseSqlServer(GetConnectionStringFromConfiguration());\r\n        return new ProjectServiceDbContext(builder.Options);\r\n    }\r\n\r\n    private static string GetConnectionStringFromConfiguration()\r\n    {\r\n        return BuildConfiguration()\r\n            .GetConnectionString(ProjectServiceDbProperties.ConnectionStringName);\r\n    }\r\n\r\n    private static IConfigurationRoot BuildConfiguration()\r\n    {\r\n        var builder = new ConfigurationBuilder()\r\n            .SetBasePath(\r\n                Path.Combine(\r\n                    Directory.GetCurrentDirectory(),\r\n                    $\"..{Path.DirectorySeparatorChar}ProjectService.HttpApi.Host\"\r\n                )\r\n            )\r\n            .AddJsonFile(\"appsettings.json\", optional: false);\r\n\r\n        return builder.Build();\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This is needed for ef core migration to work. We are building the configuration by taking the ", _jsx(_components.code, {
        children: "appsetting.json"
      }), " from the ", _jsx(_components.code, {
        children: "ProjectService.HttpApi.Host"
      }), "."]
    }), "\n", _jsxs(_components.h2, {
      id: "adding-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#adding-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Adding Migrations"]
    }), "\n", _jsxs(_components.p, {
      children: ["Now the ", _jsx(_components.code, {
        children: "DbContextFactory"
      }), " is configured we can add the migrations."]
    }), "\n", _jsxs(_components.p, {
      children: ["Go the ", _jsx(_components.code, {
        children: "ProjectService.EntityFrameworkCore"
      }), " project in the terminal and create migrations."]
    }), "\n", _jsx(_components.p, {
      children: "To create migration run this command:"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef migrations add created_projects\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Verify the migrations created in the migrations folder."
    }), "\n", _jsx(_components.p, {
      children: "To update the database run this command"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef database update\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-entity-dto",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-entity-dto",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a Entity Dto"]
    }), "\n", _jsxs(_components.p, {
      children: ["Dto are placed in ", _jsx(_components.code, {
        children: "ProjectService.Application.Contracts"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class ProjectDto: EntityDto<Guid>\r\n{\r\n    public string Name { get; set; }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-appservice-interface",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-appservice-interface",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a AppService interface"]
    }), "\n", _jsxs(_components.p, {
      children: ["create ", _jsx(_components.code, {
        children: "IProjectAppService"
      }), " interface in the ", _jsx(_components.code, {
        children: "ProjectService.Application.Contracts"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public interface IProjectAppService: IApplicationService\r\n{\r\n    Task<List<ProjectDto>> GetListAsync();\r\n    Task<ProjectDto> CreateAsync(string text);\r\n    Task DeleteAsync(Guid id);\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-an-application-services",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-an-application-services",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create an Application Services"]
    }), "\n", _jsxs(_components.p, {
      children: ["Learn more about the ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Application-Services",
        children: "Application Services"
      }), " in the abp docs."]
    }), "\n", _jsxs(_components.p, {
      children: ["Application service are created in the ", _jsx(_components.code, {
        children: "ProjectService.Application"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[Authorize]\r\npublic class ProjectAppService : ProjectServiceAppService, IProjectAppService\r\n{\r\n    private readonly IRepository<Project, Guid> projectRepository;\r\n\r\n    public ProjectAppService(IRepository<Project, Guid> projectRepository)\r\n    {\r\n        this.projectRepository = projectRepository;\r\n    }\r\n\r\n    public async Task<ProjectDto> CreateAsync(string text)\r\n    {\r\n        var projectItem = await projectRepository.InsertAsync(\r\n                            new Project { Name = text }\r\n                            );\r\n\r\n        return new ProjectDto\r\n        {\r\n            Id = projectItem.Id,\r\n            Name = projectItem.Name\r\n        };\r\n    }\r\n\r\n    public async Task DeleteAsync(Guid id)\r\n    {\r\n        await projectRepository.DeleteAsync(id);\r\n    }\r\n\r\n    public async Task<List<ProjectDto>> GetListAsync()\r\n    {\r\n        var items = await projectRepository.GetListAsync();\r\n        return items\r\n            .Select(item => new ProjectDto\r\n            {\r\n                Id = item.Id,\r\n                Name = item.Name\r\n            }).ToList();\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-entityframeworkcoremodule",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-entityframeworkcoremodule",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the EntityFrameworkCoreModule"]
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "ConfigureServices"
      }), " method in the ", _jsx(_components.code, {
        children: "ProjectServiceEntityFrameworkCoreModule"
      }), " file."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "context.Services.AddAbpDbContext<ProjectServiceDbContext>(options =>\r\n{\r\n    options.AddDefaultRepositories(includeAllEntities: true);\r\n});\r\n\r\nConfigure<AbpDbContextOptions>(options =>\r\n{\r\n    options.UseSqlServer();\r\n});\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-api-scope-api-resource-and-swagger-client-in-identityserver",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-api-scope-api-resource-and-swagger-client-in-identityserver",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create API Scope, API Resource and Swagger Client in IdentityServer"]
    }), "\n", _jsxs(_components.p, {
      children: ["We need to do this in the ", _jsx(_components.code, {
        children: "MainApp"
      }), ". We have to update the ", _jsx(_components.code, {
        children: "IdentityServerDataSeedContributor"
      }), " in the ", _jsx(_components.code, {
        children: "MainApp.Domain"
      }), "."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "private async Task CreateApiScopesAsync()\r\n{\r\n    await CreateApiScopeAsync(\"MainApp\");\r\n    await CreateApiScopeAsync(\"ProjectService\");\r\n}\r\n\r\nprivate async Task CreateApiResourcesAsync()\r\n{\r\n    var commonApiUserClaims = new[]\r\n    {\r\n        \"email\",\r\n        \"email_verified\",\r\n        \"name\",\r\n        \"phone_number\",\r\n        \"phone_number_verified\",\r\n        \"role\"\r\n    };\r\n\r\n    await CreateApiResourceAsync(\"MainApp\", commonApiUserClaims);\r\n    await CreateApiResourceAsync(\"ProjectService\", commonApiUserClaims);\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now lets update the create the swagger client for the new service."
    }), "\n", _jsxs(_components.p, {
      children: ["In the ", _jsx(_components.code, {
        children: "MainApp.DbMigrator"
      }), " project update the ", _jsx(_components.code, {
        children: "appsettings.json"
      }), " with the new swagger client."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "\"ProjectService_Swagger\": {\r\n    \"ClientId\": \"ProjectService_Swagger\",\r\n    \"ClientSecret\": \"1q2w3e*\",\r\n    \"RootUrl\": \"{ Your Service url }\"\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "commonScopes"
      }), " in the ", _jsx(_components.code, {
        children: "CreateClientsAsync"
      }), " method"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "var commonScopes = new[]\r\n{\r\n    \"email\",\r\n    \"openid\",\r\n    \"profile\",\r\n    \"role\",\r\n    \"phone\",\r\n    \"address\",\r\n    \"MainApp\",\r\n    \"ProjectService\"\r\n};\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will add the newly created scope to all the clients."
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "CreateClientsAsync"
      }), " method to create the swagger client in the ", _jsx(_components.code, {
        children: "IdentityServerDataSeedContributor"
      }), " in the ", _jsx(_components.code, {
        children: "MainApp.Domain"
      }), "."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "var swaggerClientIdProjectService = configurationSection[\"ProjectService_Swagger:ClientId\"];\r\nif (!swaggerClientIdProjectService.IsNullOrWhiteSpace())\r\n{\r\n    var swaggerRootUrl = configurationSection[\"ProjectService_Swagger:RootUrl\"].TrimEnd('/');\r\n\r\n    await CreateClientAsync(\r\n        name: swaggerClientIdProjectService,\r\n        scopes: commonScopes,\r\n        grantTypes: new[] { \"authorization_code\" },\r\n        secret: configurationSection[\"ProjectService_Swagger:ClientSecret\"]?.Sha256(),\r\n        requireClientSecret: false,\r\n        redirectUri: $\"{swaggerRootUrl}/swagger/oauth2-redirect.html\",\r\n        corsOrigins: new[] { swaggerRootUrl.RemovePostFix(\"/\") }\r\n    );\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "run-migrations-again-for-the-mainapp",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-migrations-again-for-the-mainapp",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run Migrations again for the MainApp"]
    }), "\n", _jsxs(_components.p, {
      children: ["Change directory to ", _jsx(_components.code, {
        children: "MainApp.DbMigrator"
      }), " and run the migration project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will run the ", _jsx(_components.code, {
        children: "DbMigrator"
      }), " project. The ", _jsx(_components.code, {
        children: "DbMigrator"
      }), " will seed the database with the New Scope, API and Client in our Identity Server."]
    }), "\n", _jsxs(_components.p, {
      children: ["Once the migration is done lets update the ", _jsx(_components.code, {
        children: "CorsOrigins"
      }), " in the IdentityServer."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "\"App\": {\r\n    \"SelfUrl\": \"https://localhost:44373\",\r\n    \"ClientUrl\": \"http://localhost:4200\",\r\n    \"CorsOrigins\": \"https://*.MainApp.com,http://localhost:4200,https://localhost:44307,https://localhost:44358,https://localhost:44372,{ Project Service url }\", // update the entry here\r\n    \"RedirectAllowedUrls\": \"http://localhost:4200,https://localhost:44307\"\r\n},\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "communicating-with-the-microservice",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#communicating-with-the-microservice",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Communicating with the Microservice"]
    }), "\n", _jsx(_components.p, {
      children: "Now we have the application running lets see how we can communicate between services."
    }), "\n", _jsxs(_components.p, {
      children: ["To communicate with the we need to use the ", _jsx(_components.code, {
        children: "Client Proxy"
      }), " ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/API/Dynamic-CSharp-API-Clients",
        children: "Check docs here"
      })]
    }), "\n", _jsxs(_components.h3, {
      id: "add-the-contract-project-reference",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-the-contract-project-reference",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add the Contract project reference"]
    }), "\n", _jsxs(_components.p, {
      children: ["We need to add ", _jsx(_components.code, {
        children: "ProjectService.Application.Contracts"
      }), " project as project reference to ", _jsx(_components.code, {
        children: "MainApp.HttpApi.Client"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<ProjectReference Include=\"..\\..\\modules\\ProjectService\\src\\ProjectService.Application.Contracts\\ProjectService.Application.Contracts.csproj\" />\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "MainAppHttpApiClientModule"
      }), " dependency and add the ", _jsx(_components.code, {
        children: "ProjectService"
      }), " as a client proxy."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "typeof(ProjectServiceApplicationContractsModule)\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "ConfigureServices"
      }), " service in the ", _jsx(_components.code, {
        children: "MainAppHttpApiClientModule.cs"
      }), " file in the ", _jsx(_components.code, {
        children: "MainApp.HttpApi.Client"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "//Create dynamic client proxies\r\ncontext.Services.AddHttpClientProxies(\r\n    typeof(ProjectServiceApplicationContractsModule).Assembly,\r\n    \"ProjectService\"\r\n);\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Now lets add Remote Service Endpoints to the ", _jsx(_components.code, {
        children: "appsettings.json"
      }), " in ", _jsx(_components.code, {
        children: "MainApp.Web"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "\"RemoteServices\": {\r\n    \"Default\": {\r\n        \"BaseUrl\": \"https://localhost:44358/\"\r\n    },\r\n    \"ProjectService\": {\r\n        \"BaseUrl\": \"https://localhost:44372/\"\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-scope-of-the-web-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-scope-of-the-web-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the scope of the Web App"]
    }), "\n", _jsxs(_components.p, {
      children: ["To connect to the project service we need to add the ", _jsx(_components.code, {
        children: "ProjectService"
      }), " scope as a scope to the ", _jsx(_components.code, {
        children: "AddAbpOpenIdConnect"
      }), " method inside the ", _jsx(_components.code, {
        children: "ConfigureAuthentication"
      }), " method in the ", _jsx(_components.code, {
        children: "MainAppWebModule"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: ".AddAbpOpenIdConnect(\"oidc\", options =>\r\n{\r\n    options.Authority = configuration[\"AuthServer:Authority\"];\r\n    options.RequireHttpsMetadata = Convert.ToBoolean(configuration[\"AuthServer:RequireHttpsMetadata\"]);\r\n    options.ResponseType = OpenIdConnectResponseType.CodeIdToken;\r\n\r\n    options.ClientId = configuration[\"AuthServer:ClientId\"];\r\n    options.ClientSecret = configuration[\"AuthServer:ClientSecret\"];\r\n\r\n    options.SaveTokens = true;\r\n    options.GetClaimsFromUserInfoEndpoint = true;\r\n\r\n    options.Scope.Add(\"role\");\r\n    options.Scope.Add(\"email\");\r\n    options.Scope.Add(\"phone\");\r\n    options.Scope.Add(\"MainApp\");\r\n    options.Scope.Add(\"ProjectService\"); // This is for the new project service\r\n});\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-ui-to-display-the-projects",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-ui-to-display-the-projects",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a UI to display the projects"]
    }), "\n", _jsxs(_components.p, {
      children: ["Create a project page to display the project list in the ", _jsx(_components.code, {
        children: "MainApp.Web"
      }), "."]
    }), "\n", _jsxs(_components.p, {
      children: ["Create a ", _jsx(_components.code, {
        children: "Projects.cshtml"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-html",
        children: "@page\r\n@model MainApp.Web.Pages.ProjectsModel\r\n<div class=\"container\">\r\n    <H1>List of projects</H1>\r\n    @if(Model.Projects != null && Model.Projects.Count > 0){\r\n        @foreach (var item in Model?.Projects) {\r\n            <div class=\"card\">\r\n                <div class=\"card-body\">\r\n                    <h5 class=\"card-title\">@item.Name</h5>\r\n                </div>\r\n            </div>\r\n        }  \r\n    }\r\n</div>\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Create a ", _jsx(_components.code, {
        children: "Projects.cshtml.cs"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class ProjectsModel : MainAppPageModel\r\n    {\r\n        private readonly ILogger<ProjectsModel> logger;\r\n\r\n        public List<ProjectDto> Projects { get; set; }\r\n        private IProjectAppService projectAppService { get; set; }\r\n        public ProjectsModel(IProjectAppService projectAppService, ILogger<ProjectsModel> logger)\r\n        {\r\n            this.projectAppService = projectAppService;\r\n            this.logger = logger;\r\n            Projects = new List<ProjectDto>();\r\n        }\r\n\r\n        public void OnGet()\r\n        {\r\n            try\r\n            {\r\n                var projects = projectAppService.GetListAsync().Result;\r\n                Projects = projects;\r\n            }\r\n            catch (Exception e)\r\n            {\r\n                logger.LogError(e.Message);\r\n            }\r\n        }\r\n    }\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Lets add the newly created page to the Main menu."
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "ConfigureMainMenuAsync"
      }), " method in the ", _jsx(_components.code, {
        children: "MainAppMenuContributor.cs"
      }), " file."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "context.Menu.Items.Insert(\r\n    3,\r\n    new ApplicationMenuItem(\r\n        MainAppMenus.Home,\r\n        l[\"Projects\"],\r\n        \"~/Projects\",\r\n        icon: \"fas fa-list\",\r\n        order: 0\r\n    )\r\n);\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now lets run the application."
    }), "\n", _jsxs(_components.h2, {
      id: "running-the-application",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#running-the-application",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Running the application"]
    }), "\n", _jsxs(_components.p, {
      children: ["Since we have run 4 services lets init ", _jsx(_components.code, {
        children: "tye"
      }), " so that it will be easier."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "tye init\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This command will create the ", _jsx(_components.code, {
        children: "tye.yaml"
      }), " file which will have the project without out ports binding. Update the ports from your solution. Here is the sample ", _jsx(_components.code, {
        children: "tye.yaml"
      }), "."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "name: mainapp\r\nservices:\r\n- name: mainapp-web\r\n  project: src/MainApp.Web/MainApp.Web.csproj\r\n  bindings:\r\n  - port: 44343 //update your ports here\r\n    protocol: https\r\n- name: mainapp-identityserver\r\n  project: src/MainApp.IdentityServer/MainApp.IdentityServer.csproj\r\n  bindings:\r\n  - port: 44373 //update your ports here\r\n    protocol: https\r\n- name: mainapp-httpapi-host\r\n  project: src/MainApp.HttpApi.Host/MainApp.HttpApi.Host.csproj\r\n  bindings:\r\n  - port: 44358 //update your ports here\r\n    protocol: https\r\n- name: project-service\r\n  project: modules/ProjectService/src/ProjectService.HttpApi.Host/ProjectService.HttpApi.Host.csproj\r\n  bindings:\r\n  - port: 44372 //update your ports here\r\n    protocol: https\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now run the tye command."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "tye run\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will run all the projects. Navigate to the ", _jsx(_components.code, {
        children: "ProjectService"
      }), " and do the swagger authorization to login and call the project api to create new project."]
    }), "\n", _jsxs(_components.p, {
      children: ["To View the project visit the ", _jsx(_components.code, {
        children: "MainApp.Web"
      }), " project and click ", _jsx(_components.code, {
        children: "Projects"
      }), " menu to see the list of the project you just created."]
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Create content with code in Orchard Core - Part 3</title>
          <link>https://blog.antosubash.com/posts/orchard-core-create-content-with-code</link>
          <guid>https://blog.antosubash.com/posts/orchard-core-create-content-with-code</guid>
          <pubDate>Sat, 27 Nov 2021 00:00:00 GMT</pubDate>
          <description>In this post we will see how to create content types using the code in Orchard Core.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    pre: "pre",
    code: "code",
    img: "img"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to create content types using the code in Orchard Core. We will see how to create content types with different parts and fields. We will also see how to create content items using the code."
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-cms",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-cms",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a CMS"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet new occms -n MyCms\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "add-a-module-to-the-cms-with-part",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-a-module-to-the-cms-with-part",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add a module to the cms with part"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet new ocmodulecms --name MyCms.Projects\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-solution-and-add-the-projects",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-solution-and-add-the-projects",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a solution and add the projects"]
    }), "\n", _jsx(_components.p, {
      children: "To create a solution"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet new sln -n ContentWithCode\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "To add projects to the solution."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet sln add .\\MyCms\\MyCms.csproj\r\ndotnet sln add .\\MyCms.Projects\\MyCms.Projects.csproj\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "To add Module as a reference to the project"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet add .\\MyCms\\MyCms.csproj reference .\\MyCms.Projects\\MyCms.Projects.csproj\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "add-migration",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-migration",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add migration"]
    }), "\n", _jsxs(_components.p, {
      children: ["Create the migrations class ", _jsx(_components.code, {
        children: "Migrations.cs"
      }), " file in our module ", _jsx(_components.code, {
        children: "MyCms.Projects"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "using OrchardCore.ContentManagement.Metadata;\r\nusing OrchardCore.ContentManagement.Metadata.Settings;\r\nusing OrchardCore.Data.Migration;\r\n\r\nnamespace MyCms.Projects\r\n{\r\n    public class Migrations : DataMigration\r\n    {\r\n        IContentDefinitionManager _contentDefinitionManager;\r\n\r\n        public Migrations(IContentDefinitionManager contentDefinitionManager)\r\n        {\r\n            _contentDefinitionManager = contentDefinitionManager;\r\n        }\r\n\r\n        public int Create()\r\n        {\r\n            _contentDefinitionManager.AlterTypeDefinition(\"Project\", type => type\r\n                .Draftable()\r\n                .Versionable()\r\n                .Creatable()\r\n                .Securable()\r\n                .Listable()\r\n                .WithPart(\"Project\")\r\n            );\r\n\r\n            _contentDefinitionManager.AlterPartDefinition(\"Project\", part => part\r\n                .WithField(\"Name\", field => field\r\n                    .OfType(\"TextField\")\r\n                    .WithDisplayName(\"Name\")\r\n                )\r\n                .WithField(\"StartDate\", field => field\r\n                    .OfType(\"DateField\")\r\n                    .WithDisplayName(\"Start date\")\r\n                )\r\n                .WithField(\"Image\", field => field\r\n                    .OfType(\"MediaField\")\r\n                    .WithDisplayName(\"Main image\")\r\n                )\r\n                .WithField(\"Cost\", field => field\r\n                    .OfType(\"NumericField\")\r\n                    .WithDisplayName(\"Cost\")\r\n                )\r\n            );\r\n\r\n            return 1;\r\n        }\r\n    }\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Update the start up file to add the migration."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "services.AddScoped<IDataMigration,Migrations>();\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-headless-orchard-cms",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-headless-orchard-cms",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a Headless Orchard CMS"]
    }), "\n", _jsxs(_components.p, {
      children: ["Run the ", _jsx(_components.code, {
        children: "MyCms"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "dotnet run\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["You will see a Setup screen in the ", _jsx(_components.code, {
        children: "Recipe"
      }), " dropdown choose the ", _jsx(_components.code, {
        children: "Headless Site"
      })]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/orchard/part3/orchardcore3.1.png",
        alt: "Setup"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Once the setup is complete then enable the ", _jsx(_components.code, {
        children: "MyCms.Projects"
      }), " module."]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/orchard/part3/orchardcore3.2.png",
        alt: "Features"
      })
    }), "\n", _jsx(_components.p, {
      children: "Go to Features and you will see the list of all the features. Search for \"MyCms.Projects\" and enable it."
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/orchard/part3/orchardcore3.3.png",
        alt: "Enable"
      })
    }), "\n", _jsx(_components.p, {
      children: "Once the module is enabled then we can start creating our content."
    }), "\n", _jsxs(_components.p, {
      children: ["Go to ", _jsx(_components.code, {
        children: "Content Items"
      }), " page you will see a ", _jsx(_components.code, {
        children: "New Projects"
      }), " menu now."]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/orchard/part3/orchardcore3.4.png",
        alt: "New Projects"
      })
    }), "\n", _jsx(_components.p, {
      children: "You will be able to create a new project now."
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.img, {
        src: "/assets/posts/orchard/part3/orchardcore3.6.png",
        alt: "Create Projects"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Authentication using OpenId in React/NextJs App With Orchard Core - Part 2</title>
          <link>https://blog.antosubash.com/posts/orchard-core-openid-nextjs</link>
          <guid>https://blog.antosubash.com/posts/orchard-core-openid-nextjs</guid>
          <pubDate>Thu, 18 Nov 2021 00:00:00 GMT</pubDate>
          <description>In this post we will see how to do authentication using OpenId for a React App using Orchard Core.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    code: "code",
    pre: "pre",
    h3: "h3"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to do authentication using OpenId for a React App using Orchard Core."
    }), "\n", _jsxs(_components.h2, {
      id: "prerequisites",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#prerequisites",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Prerequisites"]
    }), "\n", _jsxs(_components.p, {
      children: ["To create the CMS and and a sample content follow the ", _jsx(_components.a, {
        href: "https://blog.antosubash.com/posts/orchard-core-getting-started-p1",
        children: "Getting started"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-openid-client",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-openid-client",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a OpenId Client"]
    }), "\n", _jsxs(_components.p, {
      children: ["Navigate to the ", _jsx(_components.code, {
        children: "https://localhost:5001/Admin"
      }), " and login as a admin."]
    }), "\n", _jsxs(_components.p, {
      children: ["Navigate to ", _jsx(_components.code, {
        children: "Security -> OpenID Connect -> Scopes -> Add an scope"
      }), "."]
    }), "\n", _jsxs(_components.p, {
      children: ["Create two scopes ", _jsx(_components.code, {
        children: "role"
      }), " and ", _jsx(_components.code, {
        children: "openid"
      }), "."]
    }), "\n", _jsxs(_components.p, {
      children: ["Navigate to ", _jsx(_components.code, {
        children: "Security -> OpenID Connect -> Applications -> Add an Application"
      }), "."]
    }), "\n", _jsx(_components.p, {
      children: "Create a client with"
    }), "\n", _jsx(_components.p, {
      children: "Client id : client1"
    }), "\n", _jsx(_components.p, {
      children: "Display Name : client1"
    }), "\n", _jsx(_components.p, {
      children: "Type : Public client"
    }), "\n", _jsx(_components.p, {
      children: "Flows : Allow Authorization Code Flow"
    }), "\n", _jsx(_components.p, {
      children: "Redirect Uris : http://localhost:3000"
    }), "\n", _jsx(_components.p, {
      children: "Consent type: Explicit consent"
    }), "\n", _jsx(_components.p, {
      children: "Allowed scopes: openid, role"
    }), "\n", _jsx(_components.p, {
      children: "Click Save"
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-cors-policy",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-cors-policy",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the CORS policy"]
    }), "\n", _jsx(_components.p, {
      children: "Create a new policy to and set is as default. All credentials and any origin, headers and methods."
    }), "\n", _jsxs(_components.p, {
      children: ["Update the CORS in CMS ", _jsx(_components.code, {
        children: "Startup.cs"
      }), " file under ", _jsx(_components.code, {
        children: "ConfigureServices"
      }), " function."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public void ConfigureServices(IServiceCollection services)\r\n{\r\n    services.AddCors(o => o.AddDefaultPolicy(builder =>\r\n    {\r\n        builder\r\n            .AllowAnyOrigin()\r\n            .AllowAnyMethod()\r\n            .AllowAnyHeader();\r\n    }));\r\n    services.AddOrchardCms();\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-nextjs-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-nextjs-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a NextJS App"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "yarn create next-app --typescript\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "add-npm-packages",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-npm-packages",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add npm packages"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "yarn add oidc-client-ts react-oidc-context @apollo/client\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "add-env-file",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-env-file",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add .env file"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "NEXT_PUBLIC_BASE_URL=https://localhost:5001\r\nNEXT_PUBLIC_GRAPHQL_URL=https://localhost:5001/api/graphql\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-login-component",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-login-component",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create login component"]
    }), "\n", _jsxs(_components.p, {
      children: ["Inside the ", _jsx(_components.code, {
        children: "components"
      }), " folder create ", _jsx(_components.code, {
        children: "Login.tsx"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-ts",
        children: "import React from 'react'\r\nimport { useAuth } from 'react-oidc-context';\r\n\r\nconst Login = () => {\r\n    const auth = useAuth();\r\n    if (auth.isLoading) {\r\n      return <div>Loading...</div>;\r\n    }\r\n\r\n    if (auth.error) {\r\n      return <div>Oops... {auth.error.message}</div>;\r\n    }\r\n\r\n    if (auth.isAuthenticated) {\r\n      return (\r\n        <div>\r\n          Hello {auth.user?.profile.sub}{\" \"}\r\n          <button onClick={auth.removeUser}>Log out</button>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return <button onClick={auth.signinRedirect}>Log in</button>;\r\n}\r\n\r\nexport default Login\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-languages-component",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-languages-component",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create Languages component"]
    }), "\n", _jsxs(_components.p, {
      children: ["Inside the ", _jsx(_components.code, {
        children: "components"
      }), " folder create ", _jsx(_components.code, {
        children: "Languages.tsx"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-jsx",
        children: "import React from \"react\";\r\nimport { gql, useQuery } from \"@apollo/client\";\r\n\r\ninterface Props {}\r\n\r\nconst LanguagesQuery = gql`\r\n  query Languages {\r\n    language {\r\n      code\r\n      createdUtc\r\n      displayText\r\n      modifiedUtc\r\n      name\r\n    }\r\n  }\r\n`;\r\n\r\nconst Languages = (props: Props) => {\r\n  const { loading, error, data } = useQuery(LanguagesQuery);\r\n\r\n  if (loading) return <p>Loading...</p>;\r\n  if (error) return <p>Error :(</p>;\r\n\r\n  return data.language.map((lang: any) => (\r\n    <div key={lang.code}>\r\n      <p>{lang.name}</p>\r\n    </div>\r\n  ));\r\n};\r\n\r\nexport default Languages;\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-apollo-client",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-apollo-client",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create apollo client"]
    }), "\n", _jsxs(_components.p, {
      children: ["Create a file ", _jsx(_components.code, {
        children: "apollo-client.ts"
      }), " inside the ", _jsx(_components.code, {
        children: "lib"
      }), " folder."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-ts",
        children: "import { ApolloClient, createHttpLink, InMemoryCache } from \"@apollo/client\";\r\nimport { setContext } from \"@apollo/client/link/context\";\r\nimport { User } from \"oidc-client-ts\";\r\n\r\nconst httpLink = createHttpLink({\r\n  uri: process.env.NEXT_PUBLIC_GRAPHQL_URL,\r\n});\r\n\r\nconst authLink = setContext((_, { headers }) => {\r\n  // get the authentication token from local storage if it exists\r\n  const oidcStorage = sessionStorage.getItem(\r\n    `oidc.user:${process.env.NEXT_PUBLIC_BASE_URL}:client1`\r\n  );\r\n  const token = User.fromStorageString(oidcStorage!).access_token;\r\n  // return the headers to the context so httpLink can read them\r\n  return {\r\n    headers: {\r\n      ...headers,\r\n      authorization: token ? `Bearer ${token}` : \"\",\r\n    },\r\n  };\r\n});\r\nconst client = new ApolloClient({\r\n  link: authLink.concat(httpLink),\r\n  cache: new InMemoryCache(),\r\n});\r\nexport default client;\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-_apptsx",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-_apptsx",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update _app.tsx"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-ts",
        children: "import '../styles/globals.css'\r\nimport type { AppProps } from 'next/app'\r\nimport { AuthProvider } from \"react-oidc-context\";\r\nimport { ApolloProvider } from \"@apollo/client\";\r\nimport client from '../lib/apollo-client';\r\nfunction MyApp({ Component, pageProps }: AppProps) {\r\n  const oidcConfig = {\r\n    authority: \"https://localhost:5001\",\r\n    client_id: \"client1\",\r\n    redirect_uri: \"http://localhost:3000\",\r\n    response_type: \"code\",\r\n    scopes: \"openid email\"\r\n  };\r\n  const onSignin = () => {\r\n    location.href = \"/\";\r\n  };\r\n  return (\r\n    <AuthProvider {...oidcConfig} onSigninCallback={onSignin}>\r\n      <ApolloProvider client={client}>\r\n        <Component {...pageProps} />\r\n      </ApolloProvider>\r\n    </AuthProvider>\r\n  );\r\n}\r\n\r\nexport default MyApp\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "update-the-index-page",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-index-page",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the index page"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-ts",
        children: "import type { NextPage } from 'next'\r\nimport Login from './../components/Login';\r\nimport Languages from './../components/Languages'\r\n\r\nconst Home: NextPage = () => {\r\n    return (\r\n      <div>\r\n        <Login />\r\n        <Languages></Languages>\r\n      </div>\r\n    ); \r\n}\r\n\r\nexport default Home\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "run-both-cms-and-next-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-both-cms-and-next-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run both CMS and Next app"]
    }), "\n", _jsx(_components.p, {
      children: "Navigate to the CMS project and run"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Navigate to the NextJS project and run"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "yarn // To install the npm packages\r\nyarn dev // To run the app\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Repo : https://github.com/antosubash/OrchardCoreReactAuth"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Add a new Module to the Tiered ABP App with separate database for the module</title>
          <link>https://blog.antosubash.com/posts/abp-add-new-module-with-seperate-db</link>
          <guid>https://blog.antosubash.com/posts/abp-add-new-module-with-seperate-db</guid>
          <pubDate>Wed, 03 Nov 2021 00:00:00 GMT</pubDate>
          <description>In this post we will see how to develop a modular with tiered abp application. We will add a new module to tiered abp app and then use the separate database to store the modules data and the identity data.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "add-a-new-module-to-the-tiered-abp-app-with-a-separate-database-for-the-module",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-a-new-module-to-the-tiered-abp-app-with-a-separate-database-for-the-module",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add a new Module to the Tiered ABP App with a separate database for the module"]
    }), "\n", _jsx(_components.p, {
      children: "In this post, we will see how to develop a modular with a tiered ABP application. We will add a new module to the tiered ABP app and then use the separate database to store the module's data and identity data."
    }), "\n", _jsxs(_components.h2, {
      id: "creating-the-abp-application-and-running-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#creating-the-abp-application-and-running-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Creating the ABP application and running migrations"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp new MainApp -t app -u mvc --tiered \n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "run-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run Migrations"]
    }), "\n", _jsx(_components.p, {
      children: "Change directory to src/MainApp.DbMigrator and run the migration project"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will apply the migrations to the DB and we can run the ", _jsx(_components.code, {
        children: "MainApp.Web"
      }), " project. This will host the UI and API.."]
    }), "\n", _jsxs(_components.h2, {
      id: "add-a-new-module",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-a-new-module",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add a new Module"]
    }), "\n", _jsx(_components.p, {
      children: "Now we will add a new module to our MainApp"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp add-module ModuleA --new --add-to-solution-file\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This command will create a new module and add the new module to the solution."
    }), "\n", _jsx(_components.p, {
      children: "Now you can run all their host and see the API and UI available in the app."
    }), "\n", _jsxs(_components.h2, {
      id: "add-a-new-entity-to-the-modulea",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-a-new-entity-to-the-modulea",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add a new Entity to the ModuleA"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will create a new Entity inside the ", _jsx(_components.code, {
        children: "MainApp.ModuleA.Domain"
      }), " called ", _jsx(_components.code, {
        children: "TodoOne"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "1-create-an-entity",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#1-create-an-entity",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "1. Create an ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Entities",
        children: "Entity"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["The first step is to create an Entity. Create the Entity in the ", _jsx(_components.code, {
        children: "MainApp.ModuleA.Domain"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class TodoOne : Entity<Guid>\r\n{\r\n    public string Content { get; set; }\r\n    public bool IsDone { get; set; }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "2-add-entity-to-ef-core",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#2-add-entity-to-ef-core",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "2. Add Entity to ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Entity-Framework-Core",
        children: "ef core"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["Next is to add Entity to the EF Core. we will find the DbContext in the ", _jsx(_components.code, {
        children: "MainApp.ModuleA.EntityFrameworkCore"
      }), " project. Add the DbSet to the DbContext"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public DbSet<TodoOne> TodoOnes { get; set; }\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "3-configure-entity-in-ef-core",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#3-configure-entity-in-ef-core",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "3. Configure Entity in ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Entity-Framework-Core#configurebyconvention-method",
        children: "ef core"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["Configuration is done in the ", _jsx(_components.code, {
        children: "DbContextModelCreatingExtensions"
      }), " class. This should be available in the ", _jsx(_components.code, {
        children: "MainApp.ModuleA.EntityFrameworkCore"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "builder.Entity<TodoOne>(b =>\r\n{\r\n    b.ToTable(options.TablePrefix + \"TodoOnes\", options.Schema);\r\n    b.ConfigureByConvention(); //auto configure for the base class props\r\n});\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "4-adding-migrations-for-the-modulea",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#4-adding-migrations-for-the-modulea",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "4. Adding Migrations for the ModuleA"]
    }), "\n", _jsx(_components.p, {
      children: "Now that the Entity is configured we can add the migrations."
    }), "\n", _jsxs(_components.p, {
      children: ["Create ", _jsx(_components.code, {
        children: "EntityFrameworkCore\\ModuleA"
      }), " folder in the ", _jsx(_components.code, {
        children: "MainApp.HttpApi.Host"
      }), " project."]
    }), "\n", _jsxs(_components.p, {
      children: ["Create a ", _jsx(_components.code, {
        children: "ModuleAHttpApiHostMigrationsDbContext.cs"
      }), " file in the ", _jsx(_components.code, {
        children: "EntityFrameworkCore\\ModuleA"
      }), " folder"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class ModuleAHttpApiHostMigrationsDbContext : AbpDbContext<ModuleAHttpApiHostMigrationsDbContext>\r\n{\r\n    public ModuleAHttpApiHostMigrationsDbContext(DbContextOptions<ModuleAHttpApiHostMigrationsDbContext> options) : base(options)\r\n    {\r\n    }\r\n\r\n    protected override void OnModelCreating(ModelBuilder modelBuilder)\r\n    {\r\n        base.OnModelCreating(modelBuilder);\r\n\r\n        modelBuilder.ConfigureModuleA();\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Create a ", _jsx(_components.code, {
        children: "ModuleAHttpApiHostMigrationsDbContextFactory.cs"
      }), " file in the ", _jsx(_components.code, {
        children: "EntityFrameworkCore\\ModuleA"
      }), " folder"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class ModuleAHttpApiHostMigrationsDbContextFactory : IDesignTimeDbContextFactory<ModuleAHttpApiHostMigrationsDbContext>\r\n{\r\n    public ModuleAHttpApiHostMigrationsDbContext CreateDbContext(string[] args)\r\n    {\r\n        var configuration = BuildConfiguration();\r\n\r\n        var builder = new DbContextOptionsBuilder<ModuleAHttpApiHostMigrationsDbContext>()\r\n            .UseSqlServer(configuration.GetConnectionString(\"ModuleA\"));\r\n        return new ModuleAHttpApiHostMigrationsDbContext(builder.Options);\r\n    }\r\n\r\n    private static IConfigurationRoot BuildConfiguration()\r\n    {\r\n        var builder = new ConfigurationBuilder()\r\n            .SetBasePath(Directory.GetCurrentDirectory())\r\n            .AddJsonFile(\"appsettings.json\", optional: false);\r\n\r\n        return builder.Build();\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the connection string in ", _jsx(_components.code, {
        children: "appsettings.json"
      }), " in the ", _jsx(_components.code, {
        children: "MainApp.HttpApi.Host"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "  \"ConnectionStrings\": {\r\n    \"Default\": \"Server=(LocalDb)\\\\MSSQLLocalDB;Database=MainApp;Trusted_Connection=True\",\r\n    \"ModuleA\": \"Server=(LocalDb)\\\\MSSQLLocalDB;Database=ModuleA;Trusted_Connection=True\",\r\n  },\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "To create migration run this command:"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef migrations add created_todoone --context ModuleAHttpApiHostMigrationsDbContext --output-dir Migrations/ModuleA\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Verify the migrations created in the migrations folder."
    }), "\n", _jsx(_components.p, {
      children: "To update the database run this command"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef database update --context ModuleAHttpApiHostMigrationsDbContext\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "5-create-an-entity-dto",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#5-create-an-entity-dto",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "5. Create an Entity Dto"]
    }), "\n", _jsxs(_components.p, {
      children: ["Dto are placed in ", _jsx(_components.code, {
        children: "MainApp.ModuleA.Application.Contracts"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class TodoOneDto : EntityDto<Guid>\r\n{\r\n    public string Content { get; set; }\r\n    public bool IsDone { get; set; }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "6-map-entity-to-dto",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#6-map-entity-to-dto",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "6. Map Entity to Dto"]
    }), "\n", _jsxs(_components.p, {
      children: ["Abp uses AutoMapper to map Entity to Dto. you can find the ", _jsx(_components.code, {
        children: "ApplicationAutoMapperProfile"
      }), " file which is used by the AutoMapper in the ", _jsx(_components.code, {
        children: "MainApp.ModuleA.Application"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "CreateMap<TodoOne, TodoOneDto>();\r\nCreateMap<TodoOneDto, TodoOne>();\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "7-create-an-application-services",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#7-create-an-application-services",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "7. Create an ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Application-Services",
        children: "Application Services"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["Application services are created in the ", _jsx(_components.code, {
        children: "MainApp.ModuleA.Application"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class TodoOneAppService : ModuleAAppService\r\n{\r\n    private readonly IRepository<TodoOne, Guid> todoOneRepository;\r\n\r\n    public TodoOneAppService(IRepository<TodoOne, Guid> todoOneRepository)\r\n    {\r\n        this.todoOneRepository = todoOneRepository;\r\n    }\r\n\r\n    public async Task<List<TodoOneDto>> GetAll()\r\n    {\r\n        return ObjectMapper.Map<List<TodoOne>, List<TodoOneDto>>(await todoOneRepository.GetListAsync());\r\n    }\r\n\r\n    public async Task<TodoOneDto> CreateAsync(TodoOneDto todoOneDto)\r\n    {\r\n        var TodoOne = ObjectMapper.Map<TodoOneDto, TodoOne>(todoOneDto);\r\n        var createdTodoOne = await todoOneRepository.InsertAsync(TodoOne);\r\n        return ObjectMapper.Map<TodoOne, TodoOneDto>(createdTodoOne);\r\n    }\r\n\r\n    public async Task<TodoOneDto> UpdateAsync(TodoOneDto todoOneDto)\r\n    {\r\n        var TodoOne = ObjectMapper.Map<TodoOneDto, TodoOne>(todoOneDto);\r\n        var createdTodoOne = await todoOneRepository.UpdateAsync(TodoOne);\r\n        return ObjectMapper.Map<TodoOne, TodoOneDto>(createdTodoOne);\r\n    }\r\n\r\n    public async Task<bool> DeleteAsync(Guid id)\r\n    {\r\n        var TodoOne = await todoOneRepository.FirstOrDefaultAsync(x=> x.Id == id);\r\n        if(TodoOne != null)\r\n        {\r\n            await todoOneRepository.DeleteAsync(TodoOne);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "8-update-addabpdbcontext-method-in-the-moduleaentityframeworkcoremodule",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#8-update-addabpdbcontext-method-in-the-moduleaentityframeworkcoremodule",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "8. Update ", _jsx(_components.code, {
        children: "AddAbpDbContext"
      }), " method in the ", _jsx(_components.code, {
        children: "ModuleAEntityFrameworkCoreModule"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "options.AddDefaultRepositories(includeAllEntities: true);\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "9-update-the-configureautoapicontrollers-in-the-mainapphttpapihostmodule-in-the-mainapphttpapihost",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#9-update-the-configureautoapicontrollers-in-the-mainapphttpapihostmodule-in-the-mainapphttpapihost",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "9. Update the ", _jsx(_components.code, {
        children: "ConfigureAutoApiControllers"
      }), " in the ", _jsx(_components.code, {
        children: "MainAppHttpApiHostModule"
      }), " in the ", _jsx(_components.code, {
        children: "MainApp.HttpApi.Host"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "Configure<AbpAspNetCoreMvcOptions>(options =>\r\n            {\r\n                options.ConventionalControllers.Create(typeof(ModuleAApplicationModule).Assembly);\r\n            });\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Repo: https://github.com/antosubash/NewModuleWithTieredAbpApp"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Add a new Module to the ABP App</title>
          <link>https://blog.antosubash.com/posts/abp-add-new-module</link>
          <guid>https://blog.antosubash.com/posts/abp-add-new-module</guid>
          <pubDate>Tue, 02 Nov 2021 00:00:00 GMT</pubDate>
          <description>In this post we will see how to develop a modular abp application. We will add a new module to default abp app and then use the same database to store the modules data and the identity data.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "add-a-new-module-to-the-abp-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-a-new-module-to-the-abp-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add a new Module to the ABP App"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to develop a modular abp application. We will add a new module to default abp app and then use the same database to store the modules data and the identity data."
    }), "\n", _jsxs(_components.h2, {
      id: "creating-the-abp-application-and-run-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#creating-the-abp-application-and-run-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Creating the abp application and run migrations"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp new MainApp\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "run-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run Migrations"]
    }), "\n", _jsx(_components.p, {
      children: "Change directory to src/MainApp.DbMigrator and run the migration project"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["This will apply the migrations to the db and we can run the ", _jsx(_components.code, {
        children: "MainApp.Web"
      }), " project. This will host the UI and API.."]
    }), "\n", _jsxs(_components.h2, {
      id: "add-a-new-module",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-a-new-module",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add a new Module"]
    }), "\n", _jsxs(_components.p, {
      children: ["Now we will add a new module to our MainApp. Navigate to the solution folder of the ", _jsx(_components.code, {
        children: "MainApp"
      }), " and run the following command"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp add-module ModuleA --new --add-to-solution-file\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This command will create a new module and add the new module to the solution."
    }), "\n", _jsxs(_components.p, {
      children: ["Now you can run the ", _jsx(_components.code, {
        children: "MainApp.Web"
      }), " and see the Api and UI available in the app."]
    }), "\n", _jsxs(_components.h2, {
      id: "add-new-entity-to-the-modulea",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-new-entity-to-the-modulea",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add new Entity to the ModuleA"]
    }), "\n", _jsxs(_components.p, {
      children: ["We will create a new Entity inside the ", _jsx(_components.code, {
        children: "MainApp.ModuleA.Domain"
      }), " called ", _jsx(_components.code, {
        children: "TodoOne"
      }), "."]
    }), "\n", _jsxs(_components.h2, {
      id: "1-create-an-entity",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#1-create-an-entity",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "1. Create an ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Entities",
        children: "Entity"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["First step is to create an Entity. Create the Entity in the ", _jsx(_components.code, {
        children: "MainApp.ModuleA.Domain"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class TodoOne : Entity<Guid>\r\n{\r\n    public string Content { get; set; }\r\n    public bool IsDone { get; set; }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "2-add-entity-to-ef-core",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#2-add-entity-to-ef-core",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "2. Add Entity to ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Entity-Framework-Core",
        children: "ef core"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["Next is to add Entity to the EF Core. you will find the DbContext in the ", _jsx(_components.code, {
        children: "MainApp.ModuleA.EntityFrameworkCore"
      }), " project. Add the DbSet to the DbContext"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public DbSet<TodoOne> TodoOnes { get; set; }\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "3-configure-entity-in-ef-core",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#3-configure-entity-in-ef-core",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "3. Configure Entity in ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Entity-Framework-Core#configurebyconvention-method",
        children: "ef core"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["Configuration is done in the ", _jsx(_components.code, {
        children: "DbContextModelCreatingExtensions"
      }), " class inside the ", _jsx(_components.code, {
        children: "ConfigureModuleA"
      }), " method. This should be available in the ", _jsx(_components.code, {
        children: "MainApp.ModuleA.EntityFrameworkCore"
      }), " project. ", _jsx(_components.code, {
        children: "ConfigureModuleA"
      }), " is invoked in the ", _jsx(_components.code, {
        children: "MainAppDbContext"
      }), "."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "builder.Entity<TodoOne>(b =>\r\n{\r\n    b.ToTable(options.TablePrefix + \"TodoOnes\", options.Schema);\r\n    b.ConfigureByConvention(); //auto configure for the base class props\r\n});\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "4-adding-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#4-adding-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "4. Adding Migrations"]
    }), "\n", _jsx(_components.p, {
      children: "Now the Entity is configured we can add the migrations."
    }), "\n", _jsxs(_components.p, {
      children: ["Go the ", _jsx(_components.code, {
        children: "MainApp.EntityFrameworkCore"
      }), " project in the terminal and create migrations."]
    }), "\n", _jsx(_components.p, {
      children: "To create migration run this command:"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef migrations add created_todoone\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Verify the migrations created in the migrations folder."
    }), "\n", _jsx(_components.p, {
      children: "To update the database run this command"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef database update\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "5-create-a-entity-dto",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#5-create-a-entity-dto",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "5. Create a Entity Dto"]
    }), "\n", _jsxs(_components.p, {
      children: ["Dto are placed in ", _jsx(_components.code, {
        children: "MainApp.ModuleA.Application.Contracts"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class TodoOneDto : EntityDto<Guid>\r\n{\r\n    public string Content { get; set; }\r\n    public bool IsDone { get; set; }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "6-map-entity-to-dto",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#6-map-entity-to-dto",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "6. Map Entity to Dto"]
    }), "\n", _jsxs(_components.p, {
      children: ["Abp uses AutoMapper to map Entity to Dto. you can find the ", _jsx(_components.code, {
        children: "ApplicationAutoMapperProfile"
      }), " file which is used by the AutoMapper in the ", _jsx(_components.code, {
        children: "MainApp.ModuleA.Application"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "CreateMap<TodoOne, TodoOneDto>();\r\nCreateMap<TodoOneDto, TodoOne>();\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "7-create-an-application-services",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#7-create-an-application-services",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "7. Create an ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Application-Services",
        children: "Application Services"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["Application service are created in the ", _jsx(_components.code, {
        children: "MainApp.ModuleA.Application"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class TodoOneAppService : ModuleAAppService\r\n{\r\n    private readonly IRepository<TodoOne, Guid> todoOneRepository;\r\n\r\n    public TodoOneAppService(IRepository<TodoOne, Guid> todoOneRepository)\r\n    {\r\n        this.todoOneRepository = todoOneRepository;\r\n    }\r\n\r\n    public async Task<List<TodoOneDto>> GetAll()\r\n    {\r\n        return ObjectMapper.Map<List<TodoOne>, List<TodoOneDto>>(await todoOneRepository.GetListAsync());\r\n    }\r\n\r\n    public async Task<TodoOneDto> CreateAsync(TodoOneDto todoOneDto)\r\n    {\r\n        var TodoOne = ObjectMapper.Map<TodoOneDto, TodoOne>(todoOneDto);\r\n        var createdTodoOne = await todoOneRepository.InsertAsync(TodoOne);\r\n        return ObjectMapper.Map<TodoOne, TodoOneDto>(createdTodoOne);\r\n    }\r\n\r\n    public async Task<TodoOneDto> UpdateAsync(TodoOneDto todoOneDto)\r\n    {\r\n        var TodoOne = ObjectMapper.Map<TodoOneDto, TodoOne>(todoOneDto);\r\n        var createdTodoOne = await todoOneRepository.UpdateAsync(TodoOne);\r\n        return ObjectMapper.Map<TodoOne, TodoOneDto>(createdTodoOne);\r\n    }\r\n\r\n    public async Task<bool> DeleteAsync(Guid id)\r\n    {\r\n        var TodoOne = await todoOneRepository.FirstOrDefaultAsync(x=> x.Id == id);\r\n        if(TodoOne != null)\r\n        {\r\n            await todoOneRepository.DeleteAsync(TodoOne);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "8-update-addabpdbcontext-method-in-the-moduleaentityframeworkcoremodule",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#8-update-addabpdbcontext-method-in-the-moduleaentityframeworkcoremodule",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "8. Update ", _jsx(_components.code, {
        children: "AddAbpDbContext"
      }), " method in the ", _jsx(_components.code, {
        children: "ModuleAEntityFrameworkCoreModule"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "options.AddDefaultRepositories(includeAllEntities: true);\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "9-update-the-configureservices-in-the-moduleawebmodule-in-the-moduleaweb",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#9-update-the-configureservices-in-the-moduleawebmodule-in-the-moduleaweb",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "9. Update the ", _jsx(_components.code, {
        children: "ConfigureServices"
      }), " in the ", _jsx(_components.code, {
        children: "ModuleAWebModule"
      }), " in the ", _jsx(_components.code, {
        children: "ModuleA.Web"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "Configure<AbpAspNetCoreMvcOptions>(options =>\r\n            {\r\n                options.ConventionalControllers.Create(typeof(ModuleAApplicationModule).Assembly);\r\n            });\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "10-test-you-api",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#10-test-you-api",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "10. Test you api"]
    }), "\n", _jsxs(_components.p, {
      children: ["Run the ", _jsx(_components.code, {
        children: "MainApp.Web"
      }), " project and navigate to ", _jsx(_components.code, {
        children: "https://localhost:<port>/swagger/"
      }), " you will see the todo apis. You can test your API there."]
    }), "\n", _jsx(_components.p, {
      children: "Repo: https://github.com/antosubash/NewModuleWithAbp"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Orchard core. Getting started - Part 1</title>
          <link>https://blog.antosubash.com/posts/orchard-core-getting-started-p1</link>
          <guid>https://blog.antosubash.com/posts/orchard-core-getting-started-p1</guid>
          <pubDate>Mon, 01 Nov 2021 00:00:00 GMT</pubDate>
          <description>In this post we will see how to get started with the orchard core.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    pre: "pre",
    code: "code",
    h3: "h3"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to get started with the orchard core."
    }), "\n", _jsxs(_components.h2, {
      id: "installing-the-orchard-cms-templates",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#installing-the-orchard-cms-templates",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Installing the Orchard CMS templates"]
    }), "\n", _jsx(_components.p, {
      children: "Once the .NET Core SDK has been installed, type the following command to install the templates for creating Orchard Core web applications"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet new -i OrchardCore.ProjectTemplates::1.1.0\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "creating-the-cms",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#creating-the-cms",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Creating the CMS"]
    }), "\n", _jsx(_components.p, {
      children: "To create the cms run the following command."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet new occms -n MyCms\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Change directory into the ", _jsx(_components.code, {
        children: "MyCms"
      }), " folder and run the project."]
    }), "\n", _jsxs(_components.h3, {
      id: "running-the-application",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#running-the-application",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Running the application"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet watch run\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Your application should now be running and listening on the following ports:"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Now listening on: https://localhost:5001\r\nNow listening on: http://localhost:5000\r\nApplication started. Press Ctrl+C to shut down.\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Open a browser and navigate to https://localhost:5001 to display the setup screen."
    }), "\n", _jsxs(_components.p, {
      children: ["we will create the website using the ", _jsx(_components.code, {
        children: "Headless"
      }), " recipe. The Headless recipe is intended to get you started when using Orchard Core as an API, and Content Management System, with Administrator access to the host."]
    }), "\n", _jsxs(_components.p, {
      children: ["Complete the setup form and select the ", _jsx(_components.code, {
        children: "Headless"
      }), " recipe and SQLite for the database."]
    }), "\n", _jsxs(_components.p, {
      children: ["Submit the form. A few seconds later you should be looking at a ", _jsx(_components.code, {
        children: "Headless"
      }), " Site."]
    }), "\n", _jsx(_components.p, {
      children: "In order to configure it and start writing content you can go to https://localhost:5001/admin"
    }), "\n", _jsxs(_components.h2, {
      id: "create-content",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-content",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create content"]
    }), "\n", _jsxs(_components.p, {
      children: ["In the admin page open the ", _jsx(_components.code, {
        children: "Content => Content Definition => Content Types => Create new type"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["In the ", _jsx(_components.code, {
        children: "New Content Type"
      }), " page provide the ", _jsx(_components.code, {
        children: "Display name"
      }), " and the ", _jsx(_components.code, {
        children: "Technical Name"
      }), "."]
    }), "\n", _jsxs(_components.p, {
      children: ["In the ", _jsx(_components.code, {
        children: "Add Parts page"
      }), " Click ", _jsx(_components.code, {
        children: "Save"
      }), "."]
    }), "\n", _jsxs(_components.p, {
      children: ["In the ", _jsx(_components.code, {
        children: "Edit Content Type"
      }), " page ", _jsx(_components.code, {
        children: "Add Parts => Title => Save"
      }), " then ", _jsx(_components.code, {
        children: "Fields => IsDone => Boolean Field => Save"
      })]
    }), "\n", _jsx(_components.p, {
      children: "Then save the Content type."
    }), "\n", _jsx(_components.p, {
      children: "Now visit content items to create a new content."
    }), "\n", _jsxs(_components.h2, {
      id: "display-content",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#display-content",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Display content"]
    }), "\n", _jsxs(_components.p, {
      children: ["create a ", _jsx(_components.code, {
        children: "Pages"
      }), " folder and create ", _jsx(_components.code, {
        children: "todo.cshtml"
      }), " file inside the ", _jsx(_components.code, {
        children: "Pages"
      }), " folder"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-html",
        children: "@page \"/todos\"\r\n@inject OrchardCore.IOrchardHelper Orchard\r\n@{\r\n    var todos = await Orchard.GetRecentContentItemsByContentTypeAsync(\"Todos\");\r\n}\r\n@Orchard.ConsoleLog(todos)\r\n<h1>List all Todos</h1>\r\n@foreach (var todo in todos) {\r\n    <p>\r\n        @todo.DisplayText\r\n    </p>\r\n    <p>\r\n        @todo.Content.Todos.IsDone.Value\r\n    </p>\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Now navigate to https://localhost:5001/todos to see the created todos."
    }), "\n", _jsx(_components.p, {
      children: "Sample repo : https://github.com/antosubash/Anto.OrchardCore.CMS"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Changing theme for your ABP app. Part 10</title>
          <link>https://blog.antosubash.com/posts/abp-change-theme-p10</link>
          <guid>https://blog.antosubash.com/posts/abp-change-theme-p10</guid>
          <pubDate>Tue, 26 Oct 2021 00:00:00 GMT</pubDate>
          <description>In this post we will explore how to change the theme for your ABP application.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    h3: "h3",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will explore how to change the theme for your ABP application.."
    }), "\n", _jsxs(_components.h2, {
      id: "create-an-abp-app-and-run-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-an-abp-app-and-run-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create an abp App and Run Migrations"]
    }), "\n", _jsxs(_components.h3, {
      id: "create-the-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the App"]
    }), "\n", _jsx(_components.p, {
      children: "Run the following command to create the abp app."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp new ThemeChange\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "run-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run Migrations"]
    }), "\n", _jsxs(_components.p, {
      children: ["change directory to ", _jsx(_components.code, {
        children: "src/ThemeChange.DbMigrator"
      }), " and run the migration project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will create the migrations and seed the data for your project."
    }), "\n", _jsxs(_components.h2, {
      id: "add-the-basic-theme-module-to-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-the-basic-theme-module-to-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add the basic theme module to app"]
    }), "\n", _jsx(_components.p, {
      children: "Run the following command in your solution folder."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp add-module Volo.BasicTheme --with-source-code --add-to-solution-file\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will add the basic theme to your solution and download the source for that theme."
    }), "\n", _jsxs(_components.p, {
      children: ["Now remove the nuget package reference from the ", _jsx(_components.code, {
        children: "ThemeChange.Web"
      }), " project for ", _jsx(_components.code, {
        children: "Volo.Abp.AspNetCore.Mvc.UI.Theme.Basic"
      }), "."]
    }), "\n", _jsxs(_components.p, {
      children: ["Add project reference from to the  ", _jsx(_components.code, {
        children: "Volo.Abp.AspNetCore.Mvc.UI.Theme.Basic"
      }), " to the ", _jsx(_components.code, {
        children: "ThemeChange.Web"
      }), "."]
    }), "\n", _jsxs(_components.h2, {
      id: "change-the-bootstrap-theme",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#change-the-bootstrap-theme",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Change the bootstrap theme"]
    }), "\n", _jsxs(_components.p, {
      children: ["We are going to use the ", _jsx(_components.a, {
        href: "https://github.com/creativetimofficial/material-kit",
        children: "Material kit"
      }), ". It is a free and Open Source UI Kit for Bootstrap 4. Download the minified css from the ", _jsx(_components.a, {
        href: "https://github.com/creativetimofficial/material-kit/blob/master/assets/css/material-kit.min.css",
        children: "assets/css/material-kit.min.css"
      }), " and place it in the ", _jsx(_components.code, {
        children: "wwwroot/styles/material-kit.min.css"
      }), " in the ", _jsx(_components.code, {
        children: "ThemeChange.Web"
      })]
    }), "\n", _jsxs(_components.h3, {
      id: "remove-the-default-bootstrap-theme",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#remove-the-default-bootstrap-theme",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Remove the default bootstrap theme"]
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "ConfigureBundle"
      }), " method in the ", _jsx(_components.code, {
        children: "BasicThemeGlobalStyleContributor"
      }), " in the ", _jsx(_components.code, {
        children: "Volo.Abp.AspNetCore.Mvc.UI.Theme.Basic"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public override void ConfigureBundle(BundleConfigurationContext context)\r\n{\r\n    context.Files.Add(\"/themes/basic/layout.css\");\r\n    context.Files.Remove(\"/libs/bootstrap/css/bootstrap.css\");\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "ConfigureBundles"
      }), " method in the ", _jsx(_components.code, {
        children: "ThemeChangeWebModule"
      }), " in the ", _jsx(_components.code, {
        children: "ThemeChange.Web"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "Configure<AbpBundlingOptions>(options =>\r\n{\r\n    options.StyleBundles.Configure(\r\n        BasicThemeBundles.Styles.Global,\r\n        bundle =>\r\n        {\r\n            bundle.AddFiles(\"/global-styles.css\");\r\n            bundle.AddFiles(\"/styles/material-kit.min.css\");\r\n        }\r\n    );\r\n});\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "changing-the-layout",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#changing-the-layout",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Changing the layout"]
    }), "\n", _jsxs(_components.p, {
      children: ["Layouts are available in the ", _jsx(_components.code, {
        children: "Themes\\basic\\Layouts"
      }), " folder in the ", _jsx(_components.code, {
        children: "Volo.Abp.AspNetCore.Mvc.UI.Theme.Basic"
      }), " project"]
    }), "\n", _jsxs(_components.p, {
      children: ["We are going to change the ", _jsx(_components.code, {
        children: "Account.cshtml"
      }), " layout. Take a backup of that file."]
    }), "\n", _jsxs(_components.p, {
      children: ["Here is the updated cshtml. Based on the sample from this ", _jsx(_components.a, {
        href: "https://github.com/creativetimofficial/material-kit/blob/master/pages/sign-in.html",
        children: "Signin Page"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "@using Microsoft.Extensions.Localization\r\n@using Microsoft.Extensions.Options\r\n@using Volo.Abp.AspNetCore.MultiTenancy\r\n@using Volo.Abp.AspNetCore.Mvc.UI.Components.LayoutHook\r\n@using Volo.Abp.AspNetCore.Mvc.UI.MultiTenancy.Localization\r\n@using Volo.Abp.AspNetCore.Mvc.UI.Theme.Basic.Bundling\r\n@using Volo.Abp.AspNetCore.Mvc.UI.Theme.Basic.Themes.Basic.Components.MainNavbar\r\n@using Volo.Abp.AspNetCore.Mvc.UI.Theme.Basic.Themes.Basic.Components.PageAlerts\r\n@using Volo.Abp.AspNetCore.Mvc.UI.Theming\r\n@using Volo.Abp.AspNetCore.Mvc.UI.Widgets.Components.WidgetScripts\r\n@using Volo.Abp.AspNetCore.Mvc.UI.Widgets.Components.WidgetStyles\r\n@using Volo.Abp.MultiTenancy\r\n@using Volo.Abp.Localization\r\n@using Volo.Abp.Ui.Branding\r\n@inject IBrandingProvider BrandingProvider\r\n@inject IOptions<AbpMultiTenancyOptions> MultiTenancyOptions\r\n@inject ICurrentTenant CurrentTenant\r\n@inject IStringLocalizer<AbpUiMultiTenancyResource> MultiTenancyStringLocalizer\r\n@inject ITenantResolveResultAccessor TenantResolveResultAccessor\r\n\r\n@{\r\n    Layout = null;\r\n    var containerClass = ViewBag.FluidLayout == true ? \"container-fluid\" : \"container\"; //TODO: Better and type-safe options\r\n    var rtl = CultureHelper.IsRtl ? \"rtl\" : string.Empty;\r\n}\r\n\r\n<!DOCTYPE html>\r\n\r\n<html lang=\"@CultureInfo.CurrentCulture.Name\" dir=\"@rtl\">\r\n<head>\r\n    @await Component.InvokeLayoutHookAsync(LayoutHooks.Head.First, StandardLayouts.Account)\r\n\r\n    <meta charset=\"utf-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\">\r\n    <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\r\n\r\n    <title>@(ViewBag.Title == null ? BrandingProvider.AppName : ViewBag.Title)</title>\r\n\r\n    @if (ViewBag.Description != null)\r\n    {\r\n        <meta name=\"description\" content=\"@(ViewBag.Description as string)\" />\r\n    }\r\n    <abp-style-bundle name=\"@BasicThemeBundles.Styles.Global\" />\r\n      <link href=\"https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700\" rel=\"stylesheet\" />\r\n    @await RenderSectionAsync(\"styles\", false)\r\n\r\n    @await Component.InvokeAsync(typeof(WidgetStylesViewComponent))\r\n\r\n    @await Component.InvokeLayoutHookAsync(LayoutHooks.Head.Last, StandardLayouts.Account)\r\n</head>\r\n<body class=\"sign-in-basic\">\r\n  <nav class=\"navbar navbar-expand-lg position-absolute top-0 z-index-3 w-100 shadow-none my-3  navbar-transparent \">\r\n    <div class=\"container\">\r\n      <a class=\"navbar-brand  text-white \" href=\"/\" rel=\"tooltip\" title=\"Theme Change\" data-placement=\"bottom\">\r\n        ThemeChange\r\n      </a>\r\n      <button class=\"navbar-toggler shadow-none ms-2\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#navigation\" aria-controls=\"navigation\" aria-expanded=\"false\" aria-label=\"Toggle navigation\">\r\n        <span class=\"navbar-toggler-icon mt-2\">\r\n          <span class=\"navbar-toggler-bar bar1\"></span>\r\n          <span class=\"navbar-toggler-bar bar2\"></span>\r\n          <span class=\"navbar-toggler-bar bar3\"></span>\r\n        </span>\r\n      </button>\r\n      <div class=\"collapse navbar-collapse w-100 pt-3 pb-2 py-lg-0 ms-lg-12 ps-lg-5\" id=\"navigation\">\r\n      </div>\r\n    </div>\r\n  </nav>\r\n  <div class=\"page-header align-items-start min-vh-100\" style=\"background-image: url('https://images.unsplash.com/photo-1497294815431-9365093b7331?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1950&q=80');\" loading=\"lazy\">\r\n    <span class=\"mask bg-gradient-dark opacity-6\"></span>\r\n    <div class=\"container my-auto\">\r\n      <div class=\"row\">\r\n        <div class=\"col-lg-4 col-md-8 col-12 mx-auto\">\r\n          <div class=\"card z-index-0 fadeIn3 fadeInBottom\">\r\n            <div class=\"card-header p-0 position-relative mt-n4 mx-3 z-index-2\">\r\n              <div class=\"bg-gradient-primary shadow-primary border-radius-lg py-3 pe-1\">\r\n                <h4 class=\"text-white font-weight-bolder text-center mt-2 mb-0\">Sign in</h4>\r\n                <div class=\"row mt-3\">\r\n                  <div class=\"col-2 text-center ms-auto\">\r\n                    <a class=\"btn btn-link px-3\" href=\"javascript:;\">\r\n                      <i class=\"fa fa-facebook text-white text-lg\"></i>\r\n                    </a>\r\n                  </div>\r\n                  <div class=\"col-2 text-center px-1\">\r\n                    <a class=\"btn btn-link px-3\" href=\"javascript:;\">\r\n                      <i class=\"fa fa-github text-white text-lg\"></i>\r\n                    </a>\r\n                  </div>\r\n                  <div class=\"col-2 text-center me-auto\">\r\n                    <a class=\"btn btn-link px-3\" href=\"javascript:;\">\r\n                      <i class=\"fa fa-google text-white text-lg\"></i>\r\n                    </a>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"card-body\">\r\n                @if (MultiTenancyOptions.Value.IsEnabled &&\r\n                  (TenantResolveResultAccessor.Result?.AppliedResolvers?.Contains(CookieTenantResolveContributor.ContributorName) == true ||\r\n                   TenantResolveResultAccessor.Result?.AppliedResolvers?.Contains(QueryStringTenantResolveContributor.ContributorName) == true))\r\n                {\r\n                    <div class=\"card shadow-sm rounded mb-3\">\r\n                        <div class=\"card-body px-5\">\r\n                            <div class=\"row\">\r\n                                <div class=\"col\">\r\n                                    <span style=\"font-size: .8em;\" class=\"text-uppercase text-muted\">@MultiTenancyStringLocalizer[\"Tenant\"]</span><br />\r\n                                    <h6 class=\"m-0 d-inline-block\">\r\n                                        @if (CurrentTenant.Id == null)\r\n                                        {\r\n                                            <span>\r\n                                                @MultiTenancyStringLocalizer[\"NotSelected\"]\r\n                                            </span>\r\n                                        }\r\n                                        else\r\n                                        {\r\n                                            <strong>@(CurrentTenant.Name ?? CurrentTenant.Id.Value.ToString())</strong>\r\n                                        }\r\n                                    </h6>\r\n                                </div>\r\n                                <div class=\"col-auto\">\r\n                                    <a id=\"AbpTenantSwitchLink\" href=\"javascript:;\" class=\"btn btn-sm mt-3 btn-outline-primary\">@MultiTenancyStringLocalizer[\"Switch\"]</a>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                }\r\n                @(await Component.InvokeAsync<PageAlertsViewComponent>())\r\n                @await Component.InvokeLayoutHookAsync(LayoutHooks.PageContent.First, StandardLayouts.Account)\r\n                @RenderBody()\r\n                @await Component.InvokeLayoutHookAsync(LayoutHooks.PageContent.Last, StandardLayouts.Account)\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <footer class=\"footer position-absolute bottom-2 py-2 w-100\">\r\n      <div class=\"container\">\r\n        <div class=\"row align-items-center justify-content-lg-between\">\r\n          <div class=\"col-12 col-md-6 my-auto\">\r\n            <div class=\"copyright text-center text-sm text-white text-lg-start\">\r\n              © <script>\r\n                document.write(new Date().getFullYear())\r\n              </script>,\r\n              made with <i class=\"fa fa-heart\" aria-hidden=\"true\"></i> by\r\n              <a href=\"https://www.creative-tim.com\" class=\"font-weight-bold text-white\" target=\"_blank\">Creative Tim</a>\r\n              for a better web.\r\n            </div>\r\n          </div>\r\n          <div class=\"col-12 col-md-6\">\r\n            <ul class=\"nav nav-footer justify-content-center justify-content-lg-end\">\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </footer>\r\n  </div>\r\n    <abp-script-bundle name=\"@BasicThemeBundles.Scripts.Global\" />\r\n    <script src=\"~/Abp/ApplicationConfigurationScript\"></script>\r\n    <script src=\"~/Abp/ServiceProxyScript\"></script>\r\n\r\n    @await RenderSectionAsync(\"scripts\", false)\r\n    @await Component.InvokeAsync(typeof(WidgetScriptsViewComponent))\r\n    @await Component.InvokeLayoutHookAsync(LayoutHooks.Body.Last, StandardLayouts.Account)\r\n</body>\r\n</html>\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Repo Link: https://github.com/antosubash/ThemeChange"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Deploy ABP Framework dotnet core tiered app to docker swarm. Part 9</title>
          <link>https://blog.antosubash.com/posts/abp-deploy-with-docker</link>
          <guid>https://blog.antosubash.com/posts/abp-deploy-with-docker</guid>
          <pubDate>Tue, 28 Sep 2021 00:00:00 GMT</pubDate>
          <description>In this post we will see how to deploy your dotnet core app with docker container.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    pre: "pre",
    code: "code",
    strong: "strong",
    h3: "h3",
    ul: "ul",
    li: "li"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to deploy your dotnet core app with docker container."
    }), "\n", _jsxs(_components.h2, {
      id: "create-abp-tired-application",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-abp-tired-application",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create ABP Tired application"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp new AbpDocker -t app -u mvc --tiered -dbms PostgreSQL\n"
      })
    }), "\n", _jsx(_components.p, {
      children: _jsxs(_components.strong, {
        children: ["Once the app is created update the connection string in all the project and run the ", _jsx(_components.code, {
          children: "DbMigration"
        }), " project to setup the migrations and database seeding."]
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-same-site-cookies-extension",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-same-site-cookies-extension",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a same site cookies extension"]
    }), "\n", _jsx(_components.p, {
      children: "you can find the code for that here: https://community.abp.io/articles/patch-for-chrome-login-issue-identityserver4-samesite-cookie-problem-weypwp3n"
    }), "\n", _jsx(_components.p, {
      children: "Here is the code"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public static class SameSiteCookiesServiceCollectionExtensions\r\n{\r\n    public static IServiceCollection AddSameSiteCookiePolicy(this IServiceCollection services)\r\n    {\r\n        services.Configure<CookiePolicyOptions>(options =>\r\n        {\r\n            options.MinimumSameSitePolicy = SameSiteMode.Lax;\r\n            options.OnAppendCookie = cookieContext =>\r\n                CheckSameSite(cookieContext.Context, cookieContext.CookieOptions);\r\n            options.OnDeleteCookie = cookieContext =>\r\n                CheckSameSite(cookieContext.Context, cookieContext.CookieOptions);\r\n        });\r\n\r\n        return services;\r\n    }\r\n\r\n    private static void CheckSameSite(HttpContext httpContext, CookieOptions options)\r\n    {\r\n        if (options.SameSite == SameSiteMode.None)\r\n        {\r\n            var userAgent = httpContext.Request.Headers[\"User-Agent\"].ToString();\r\n            if (!httpContext.Request.IsHttps || DisallowsSameSiteNone(userAgent))\r\n            {\r\n                // For .NET Core < 3.1 set SameSite = (SameSiteMode)(-1)\r\n                options.SameSite = SameSiteMode.Lax;\r\n            }\r\n        }\r\n    }\r\n\r\n    private static bool DisallowsSameSiteNone(string userAgent)\r\n    {\r\n        // Cover all iOS based browsers here. This includes:\r\n        // - Safari on iOS 12 for iPhone, iPod Touch, iPad\r\n        // - WkWebview on iOS 12 for iPhone, iPod Touch, iPad\r\n        // - Chrome on iOS 12 for iPhone, iPod Touch, iPad\r\n        // All of which are broken by SameSite=None, because they use the iOS networking stack\r\n        if (userAgent.Contains(\"CPU iPhone OS 12\") || userAgent.Contains(\"iPad; CPU OS 12\"))\r\n        {\r\n            return true;\r\n        }\r\n\r\n        // Cover Mac OS X based browsers that use the Mac OS networking stack. This includes:\r\n        // - Safari on Mac OS X.\r\n        // This does not include:\r\n        // - Chrome on Mac OS X\r\n        // Because they do not use the Mac OS networking stack.\r\n        if (userAgent.Contains(\"Macintosh; Intel Mac OS X 10_14\") &&\r\n            userAgent.Contains(\"Version/\") && userAgent.Contains(\"Safari\"))\r\n        {\r\n            return true;\r\n        }\r\n\r\n        // Cover Chrome 50-69, because some versions are broken by SameSite=None,\r\n        // and none in this range require it.\r\n        // Note: this covers some pre-Chromium Edge versions,\r\n        // but pre-Chromium Edge does not require SameSite=None.\r\n        if (userAgent.Contains(\"Chrome/5\") || userAgent.Contains(\"Chrome/6\"))\r\n        {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Add the following line to ", _jsx(_components.code, {
        children: "ConfigureServices()"
      }), " method in all 3 projects."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "context.Services.AddSameSiteCookiePolicy();\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Go to ", _jsx(_components.code, {
        children: "OnApplicationInitialization()"
      }), " method in AcmeBookStoreWebModule.cs add ", _jsx(_components.code, {
        children: "app.UseCookiePolicy();"
      }), " in all 3 projects."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "app.UseCookiePolicy(); // added this, Before UseAuthentication or anything else that writes cookies.\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-new-client-for-the-production-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-new-client-for-the-production-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a new client for the production app"]
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "appsettings.json"
      }), " from the ", _jsx(_components.code, {
        children: "DbMigrator"
      }), " to add the new client."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "\"AbpDocker_Web_Docker\": {\r\n  \"ClientId\": \"AbpDocker_Web_Docker\",\r\n  \"ClientSecret\": \"1q2w3e*\",\r\n  \"RootUrl\": \"http://host.docker.internal:9005\"\r\n},\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "IdentityServerDataSeedContributor"
      }), " in the ", _jsx(_components.code, {
        children: "Domain"
      }), " project and add the new client to the identity server."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "//webDockerClient Client\r\nvar webDockerClientId = configurationSection[\"AbpDocker_Web_Docker:ClientId\"];\r\nif (!webClientId.IsNullOrWhiteSpace())\r\n{\r\n    var webClientRootUrl = configurationSection[\"AbpDocker_Web_Docker:RootUrl\"].EnsureEndsWith('/');\r\n\r\n    await CreateClientAsync(\r\n        name: webDockerClientId,\r\n        scopes: commonScopes,\r\n        grantTypes: new[] { \"hybrid\" },\r\n        secret: (configurationSection[\"AbpDocker_Web_Docker:ClientSecret\"] ?? \"1q2w3e*\").Sha256(),\r\n        redirectUri: $\"{webClientRootUrl}signin-oidc\",\r\n        postLogoutRedirectUri: $\"{webClientRootUrl}signout-callback-oidc\",\r\n        frontChannelLogoutUri: $\"{webClientRootUrl}Account/FrontChannelLogout\",\r\n        corsOrigins: new[] { webClientRootUrl.RemovePostFix(\"/\") }\r\n    );\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Run the ", _jsx(_components.code, {
        children: "DbMigrator"
      }), " project again to see the new client."]
    }), "\n", _jsxs(_components.h2, {
      id: "create-production-config",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-production-config",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create production config"]
    }), "\n", _jsxs(_components.p, {
      children: ["Create the ", _jsx(_components.code, {
        children: "appsettings.Production.json"
      }), " in all the three projects."]
    }), "\n", _jsxs(_components.h3, {
      id: "httpapihost",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#httpapihost",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "HttpApi.Host"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "{\r\n  \"App\": {\r\n    \"CorsOrigins\": \"https://*.AbpDocker.com\"\r\n  },\r\n  \"ConnectionStrings\": {\r\n    \"Default\": \"Host=host.docker.internal;Port=5432;Database=AbpDocker;User ID=postgres;Password=postgres;\"\r\n  },\r\n  \"Redis\": {\r\n    \"Configuration\": \"host.docker.internal\"\r\n  },\r\n  \"AuthServer\": {\r\n    \"Authority\": \"http://host.docker.internal:9006\",\r\n    \"RequireHttpsMetadata\": \"false\",\r\n    \"SwaggerClientId\": \"AbpDocker_Swagger\",\r\n    \"SwaggerClientSecret\": \"1q2w3e*\"\r\n  },\r\n  \"StringEncryption\": {\r\n    \"DefaultPassPhrase\": \"WBN0szwYr7wL8Dou\"\r\n  }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "identityserver",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#identityserver",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "IdentityServer"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "{\r\n  \"App\": {\r\n    \"SelfUrl\": \"http://host.docker.internal:9006\",\r\n    \"ClientUrl\": \"http://localhost:4200\",\r\n    \"CorsOrigins\": \"https://*.AbpDocker.com,http://localhost:4200,https://localhost:44307,https://localhost:44375,http://host.docker.internal:9006,http://host.docker.internal:9005,http://host.docker.internal:9007\",\r\n    \"RedirectAllowedUrls\": \"http://localhost:4200,https://localhost:44307,http://host.docker.internal:9006,http://host.docker.internal:9005,http://host.docker.internal:9007\"\r\n  },\r\n  \"ConnectionStrings\": {\r\n    \"Default\": \"Host=host.docker.internal;Port=5432;Database=AbpDocker;User ID=postgres;Password=postgres;\"\r\n  },\r\n  \"Redis\": {\r\n    \"Configuration\": \"host.docker.internal\"\r\n  }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "web",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#web",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Web"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "{\r\n  \"App\": {\r\n    \"SelfUrl\": \"http://host.docker.internal:9005\"\r\n  },\r\n  \"RemoteServices\": {\r\n    \"Default\": {\r\n      \"BaseUrl\": \"http://host.docker.internal:9007/\"\r\n    }\r\n  },\r\n  \"Redis\": {\r\n    \"Configuration\": \"host.docker.internal\"\r\n  },\r\n  \"AuthServer\": {\r\n    \"Authority\": \"http://host.docker.internal:9006\",\r\n    \"RequireHttpsMetadata\": \"false\",\r\n    \"ClientId\": \"AbpDocker_Web_Docker\",\r\n    \"ClientSecret\": \"1q2w3e*\"\r\n  }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "add-docker-support",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-docker-support",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add docker support"]
    }), "\n", _jsx(_components.p, {
      children: "Do the following in all 3 projects."
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsxs(_components.li, {
        children: ["\n", _jsx(_components.p, {
          children: _jsx(_components.code, {
            children: "Right Click -> Add -> Docker Support"
          })
        }), "\n", _jsxs(_components.p, {
          children: ["This will add ", _jsx(_components.code, {
            children: "Docker"
          }), " file into the project."]
        }), "\n"]
      }), "\n", _jsxs(_components.li, {
        children: ["\n", _jsx(_components.p, {
          children: _jsx(_components.code, {
            children: "Right Click -> Add -> Container Orchestrator Support"
          })
        }), "\n", _jsxs(_components.p, {
          children: ["This will add the docker file to the ", _jsx(_components.code, {
            children: "docker-compose.yml"
          })]
        }), "\n"]
      }), "\n"]
    }), "\n", _jsx(_components.p, {
      children: "Add port mapping to the services to the expose the services."
    }), "\n", _jsxs(_components.p, {
      children: ["Final ", _jsx(_components.code, {
        children: "docker-compose.yml"
      }), " will look like this."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "version: \"3.4\"\r\n\r\nservices:\r\n  web:\r\n    image: abpdockerweb\r\n    ports:\r\n      - 9005:80\r\n    build:\r\n      context: .\r\n      dockerfile: src/AbpDocker.Web/Dockerfile\r\n\r\n  identityserver:\r\n    image: abpdockeridentityserver\r\n    ports:\r\n      - 9006:80\r\n    build:\r\n      context: .\r\n      dockerfile: src/AbpDocker.IdentityServer/Dockerfile\r\n\r\n  httpapi:\r\n    image: abpdockerhttpapihost\r\n    ports:\r\n      - 9007:80\r\n    build:\r\n      context: .\r\n      dockerfile: src/AbpDocker.HttpApi.Host/Dockerfile\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "build-docker-containers",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#build-docker-containers",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Build docker containers"]
    }), "\n", _jsxs(_components.p, {
      children: ["Navigate to the directory where the ", _jsx(_components.code, {
        children: "docker-compose.yml"
      }), " file is present and then run the following command."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "docker-compose build\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "deploy-the-docker-stack",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#deploy-the-docker-stack",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Deploy the docker stack"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "docker stack deploy -c .\\docker-compose.yml abpdocker\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "run-the-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-the-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run the app"]
    }), "\n", _jsx(_components.p, {
      children: "Visit the web app in http://host.docker.internal:9005"
    }), "\n", _jsx(_components.p, {
      children: "Visit the identity server in http://host.docker.internal:9006"
    }), "\n", _jsx(_components.p, {
      children: "Visit the api in http://host.docker.internal:9007"
    }), "\n", _jsx(_components.p, {
      children: "Repo: https://github.com/antosubash/AbpWithDocker"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Centralized logging for .net core ABP microservices app using Seq. Part 8</title>
          <link>https://blog.antosubash.com/posts/abp-central-application-logging-with-seq</link>
          <guid>https://blog.antosubash.com/posts/abp-central-application-logging-with-seq</guid>
          <pubDate>Sun, 26 Sep 2021 00:00:00 GMT</pubDate>
          <description>In this post we will see how to implement a central logging system for your ABP app using Seq.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    h3: "h3",
    pre: "pre",
    code: "code",
    ul: "ul",
    li: "li"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to implement a central logging system for your ABP app using Seq."
    }), "\n", _jsxs(_components.h2, {
      id: "deploy-the-seq-dockers-container",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#deploy-the-seq-dockers-container",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Deploy the Seq dockers container"]
    }), "\n", _jsxs(_components.h3, {
      id: "enable-swarm-mode",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#enable-swarm-mode",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Enable swarm mode"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "docker swarm init\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Create the docker-compose file ", _jsx(_components.code, {
        children: "seq_stack.yaml"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "version: \"3.2\"\r\n\r\nservices:\r\n  seq:\r\n    image: datalust/seq\r\n    ports:\r\n      - 8003:80\r\n      - 5341:5341\r\n    volumes:\r\n      - D:\\docker\\data\\seq:/data\r\n    environment:\r\n      ACCEPT_EULA: \"Y\"\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "to-deploy-the-stack",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#to-deploy-the-stack",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "To deploy the stack"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "docker stack deploy -c seq_stack.yaml seq\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will deploy the seq docker container."
    }), "\n", _jsxs(_components.h2, {
      id: "create-abp-tired-application",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-abp-tired-application",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create ABP Tired application"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp new SeqWithAbp -t app -u mvc --tiered\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Once the app is created run the ", _jsx(_components.code, {
        children: "DbMigration"
      }), " project to setup the migrations and database seeding."]
    }), "\n", _jsxs(_components.h2, {
      id: "install-seq-sink-in-the-projects",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-seq-sink-in-the-projects",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install Seq Sink in the projects"]
    }), "\n", _jsxs(_components.p, {
      children: ["Install the ", _jsx(_components.code, {
        children: "Serilog.Sinks.Seq"
      }), " nuget package to the following projects."]
    }), "\n", _jsxs(_components.ul, {
      children: ["\n", _jsx(_components.li, {
        children: "SeqWithAbp.HttpApi.Host"
      }), "\n", _jsx(_components.li, {
        children: "SeqWithAbp.IdentityServer"
      }), "\n", _jsx(_components.li, {
        children: "SeqWithAbp.Web"
      }), "\n"]
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "LoggerConfiguration"
      }), " in the ", _jsx(_components.code, {
        children: "Program.cs"
      }), " with the seq endpoint in all the projects."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: ".WriteTo.Async(c => c.File(\"Logs/logs.txt\"))\r\n.WriteTo.Seq(\"http://localhost:5341\")\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will post all the logs to the seq."
    }), "\n", _jsx(_components.p, {
      children: "Sample Repo : https://github.com/antosubash/SeqWithAbp"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Extend Tenant management and add custom host to your ABP App. Part 7</title>
          <link>https://blog.antosubash.com/posts/abp-extend-tenant-with-custom-host</link>
          <guid>https://blog.antosubash.com/posts/abp-extend-tenant-with-custom-host</guid>
          <pubDate>Sat, 25 Sep 2021 00:00:00 GMT</pubDate>
          <description>In this post we will see how to extent the tenant entity and Add a custom tenant resolver for your ABP app.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    code: "code",
    pre: "pre",
    h3: "h3"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to extent the tenant entity and Add a custom tenant resolver for your ABP app."
    }), "\n", _jsxs(_components.h2, {
      id: "add-test-domain-in-the-host-file",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-test-domain-in-the-host-file",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add test domain in the host file"]
    }), "\n", _jsxs(_components.p, {
      children: ["In windows the host file is located in ", _jsx(_components.code, {
        children: "C:\\Windows\\System32\\drivers\\etc\\hosts"
      }), ". Open the file with the Admin privilege to update the below entry."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "127.0.0.1       test1.local\r\n127.0.0.1       test2.local\r\n127.0.0.1       test3.local\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-an-abp-app-and-run-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-an-abp-app-and-run-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create an abp App and Run Migrations"]
    }), "\n", _jsxs(_components.h3, {
      id: "create-the-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the App"]
    }), "\n", _jsx(_components.p, {
      children: "Run the following command to create the abp app."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp new CustomHost\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "run-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#run-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Run Migrations"]
    }), "\n", _jsx(_components.p, {
      children: "change directory to src/CustomHost.DbMigrator and run the migration project"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet run\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will create the migrations and seed the data for your project."
    }), "\n", _jsxs(_components.h2, {
      id: "extend-tenant-entity",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#extend-tenant-entity",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Extend Tenant Entity"]
    }), "\n", _jsxs(_components.h3, {
      id: "configure-extra-properties",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#configure-extra-properties",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Configure extra properties"]
    }), "\n", _jsxs(_components.p, {
      children: ["Create the Constant file in the ", _jsx(_components.code, {
        children: "Domain.Shared"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public static class Constant\r\n{\r\n    public const string Host = \"Host\";\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["In the ", _jsx(_components.code, {
        children: "Domain.Shared"
      }), " project update the ", _jsx(_components.code, {
        children: "CustomHostModuleExtensionConfigurator"
      }), " file inside the ", _jsx(_components.code, {
        children: "ConfigureExtraProperties"
      }), " methods with the following."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "ObjectExtensionManager.Instance.Modules()\r\n        .ConfigureTenantManagement(tenantConfig =>\r\n        {\r\n            tenantConfig.ConfigureTenant(tenant =>\r\n            {\r\n                tenant.AddOrUpdateProperty<string>(Constant.Host);\r\n            });\r\n        });\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "configure-ef-core",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#configure-ef-core",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Configure ef core"]
    }), "\n", _jsxs(_components.p, {
      children: ["In the ", _jsx(_components.code, {
        children: "EntityFrameworkCore"
      }), " project update the ", _jsx(_components.code, {
        children: "CustomHostEfCoreEntityExtensionMappings"
      }), " file inside the ", _jsx(_components.code, {
        children: "Configure"
      }), " method. Update the ", _jsx(_components.code, {
        children: "OneTimeRunner.Run"
      }), " with the following"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "ObjectExtensionManager.Instance\r\n    .MapEfCoreProperty<Tenant, string>(Constant.Host);\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "add-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add Migrations"]
    }), "\n", _jsxs(_components.p, {
      children: ["Navigate to the ", _jsx(_components.code, {
        children: "EntityFrameworkCore"
      }), "."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "cd .\\src\\CustomHost.EntityFrameworkCore\\\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Add migrations"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef migrations add \"update_tenant_with_host\"\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Apply the migrations"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef database update\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "add-a-custom-tenant-repo",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-a-custom-tenant-repo",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add a custom Tenant Repo"]
    }), "\n", _jsxs(_components.h3, {
      id: "create-a-custom-repo-interface-in-the-domain-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-custom-repo-interface-in-the-domain-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a Custom Repo Interface in the ", _jsx(_components.code, {
        children: "Domain"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public interface ICustomTenantRepository : IBasicRepository<Tenant, Guid>\r\n{\r\n    Task<Tenant> GetTenantByHost(string host, CancellationToken cancellationToken = default);\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "implement-the-custom-tenant-repo-in-the-entityframeworkcore-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#implement-the-custom-tenant-repo-in-the-entityframeworkcore-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Implement the custom tenant repo in the ", _jsx(_components.code, {
        children: "EntityFrameworkCore"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class CustomTenantRepository : EfCoreRepository<TenantManagementDbContext, Tenant, Guid>, ICustomTenantRepository\r\n{\r\n    public CustomTenantRepository(IDbContextProvider<TenantManagementDbContext> dbContextProvider) : base(dbContextProvider)\r\n    {\r\n    }\r\n\r\n    public async Task<Tenant> GetTenantByHost(string host, CancellationToken cancellationToken = default)\r\n    {\r\n        var context = await GetDbContextAsync();\r\n        var tenant =  context.Tenants.Where(u => EF.Property<string>(u, \"Host\") == host);\r\n        return await tenant.FirstOrDefaultAsync(cancellationToken: cancellationToken);\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "add-the-custom-repo-to-the-dbcontext",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-the-custom-repo-to-the-dbcontext",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add the custom Repo to the DbContext"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "options.AddRepository<Tenant, CustomTenantRepository>();\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "implement-host-tenant-resolve-contributor",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#implement-host-tenant-resolve-contributor",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Implement Host Tenant Resolve Contributor"]
    }), "\n", _jsxs(_components.p, {
      children: ["Create a file called ", _jsx(_components.code, {
        children: "HostTenantResolveContributor"
      }), " in the Domain Project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class HostTenantResolveContributor : TenantResolveContributorBase\r\n{\r\n    public override async Task ResolveAsync(ITenantResolveContext context)\r\n    {\r\n        var currentContextAccessor = context.ServiceProvider.GetRequiredService<IHttpContextAccessor>();\r\n        var tenantRepository = context.ServiceProvider.GetRequiredService<ICustomTenantRepository>();\r\n\r\n        var host = currentContextAccessor?.HttpContext?.Request.Host.Host;\r\n        if (tenantRepository != null)\r\n        {\r\n            var tenant = await tenantRepository.GetTenantByHost(host);\r\n\r\n            if (tenant != null)\r\n            {\r\n                context.TenantIdOrName = tenant.Name;\r\n            }\r\n        }\r\n    }\r\n\r\n    public override string Name => \"Host\";\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "configure-the-abptenantresolveoptions-in-the-web-project-at-configureservices-method",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#configure-the-abptenantresolveoptions-in-the-web-project-at-configureservices-method",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Configure the ", _jsx(_components.code, {
        children: "AbpTenantResolveOptions"
      }), " in the ", _jsx(_components.code, {
        children: "Web"
      }), " project at ", _jsx(_components.code, {
        children: "ConfigureServices"
      }), " method"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "Configure<AbpTenantResolveOptions>(options =>\r\n{\r\n    options.TenantResolvers.Clear();\r\n    options.TenantResolvers.Add(new HostTenantResolveContributor());\r\n});\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "update-the-customhostbrandingprovider-in-the-web-project-to-display-the-current-tenant-name",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#update-the-customhostbrandingprovider-in-the-web-project-to-display-the-current-tenant-name",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Update the ", _jsx(_components.code, {
        children: "CustomHostBrandingProvider"
      }), " in the ", _jsx(_components.code, {
        children: "Web"
      }), " project to display the current tenant name."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[Dependency(ReplaceServices = true)]\r\npublic class CustomHostBrandingProvider : DefaultBrandingProvider\r\n{\r\n    private readonly ICurrentTenant _currentTenant;\r\n    public override string AppName => _currentTenant.Name ?? \"CustomHost\";\r\n\r\n    public CustomHostBrandingProvider(ICurrentTenant currentTenant)\r\n    {\r\n        _currentTenant = currentTenant;\r\n    }\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will display the current tenant name in the home page."
    }), "\n", _jsx(_components.p, {
      children: "Now create the new tenant and set the host name and use that host name to login to the app."
    }), "\n", _jsx(_components.p, {
      children: "GitHub Repo : https://github.com/antosubash/TenantWithCustomHost"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Add profile picture to User Entity in ABP app using BlobStore and Minio. Part 6</title>
          <link>https://blog.antosubash.com/posts/abp-extend-user-entity-with-profile-picture</link>
          <guid>https://blog.antosubash.com/posts/abp-extend-user-entity-with-profile-picture</guid>
          <pubDate>Sun, 15 Aug 2021 00:00:00 GMT</pubDate>
          <description>In this post we will implement the profile picture upload for the ABP app using BlobStore and Minio.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    pre: "pre",
    code: "code",
    h3: "h3"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will implement the profile picture upload for the ABP app using BlobStore and Minio."
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-new-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-new-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a new project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp new ProfilePictureSample\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-container",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-container",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a container"]
    }), "\n", _jsxs(_components.p, {
      children: ["Create the container in ", _jsx(_components.code, {
        children: "Domain"
      }), " project."]
    }), "\n", _jsxs(_components.p, {
      children: ["Install ", _jsx(_components.code, {
        children: "Volo.Abp.BlobStoring"
      }), " NuGet package to your ", _jsx(_components.code, {
        children: "Domain"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[BlobContainerName(\"profile-picture\")]\r\npublic class ProfilePictureContainer\r\n{\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "configure-minio",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#configure-minio",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Configure Minio"]
    }), "\n", _jsxs(_components.p, {
      children: ["Install ", _jsx(_components.code, {
        children: "Volo.Abp.BlobStoring.Minio"
      }), " NuGet package to your ", _jsx(_components.code, {
        children: "Web"
      }), " and add ", _jsx(_components.code, {
        children: "[DependsOn(typeof(AbpBlobStoringMinioModule))]"
      }), " to the ", _jsx(_components.code, {
        children: "Web"
      }), " Module"]
    }), "\n", _jsxs(_components.p, {
      children: ["Configuration is done in the ", _jsx(_components.code, {
        children: "ConfigureServices"
      }), " method of your module class"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "Configure<AbpBlobStoringOptions>(options =>\r\n{\r\n    options.Containers.ConfigureDefault(container =>\r\n    {\r\n        container.UseMinio(minio =>\r\n        {\r\n            minio.EndPoint = \"localhost:9900\"; // your minio endPoint\r\n            minio.AccessKey = \"AKIAIOSFODNN7EXAMPLE\"; // your minio accessKey\r\n            minio.SecretKey = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"; // your minio secretKey\r\n            minio.BucketName = \"profile-picture\"; // your minio bucketName\r\n        });\r\n    });\r\n});\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "extend-user-entity",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#extend-user-entity",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Extend User Entity"]
    }), "\n", _jsxs(_components.h3, {
      id: "configure-extra-properties",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#configure-extra-properties",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Configure extra properties"]
    }), "\n", _jsxs(_components.p, {
      children: ["Create the Constant file in the ", _jsx(_components.code, {
        children: "Domain.Shared"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public static class ProfilePictureConsts\r\n{\r\n    public const string ProfilePictureId = \"ProfilePictureId\";\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["In the ", _jsx(_components.code, {
        children: "Domain.Shared"
      }), " project update the ", _jsx(_components.code, {
        children: "ProfilePictureSampleModuleExtensionConfigurator"
      }), " file inside the ", _jsx(_components.code, {
        children: "ConfigureExtraProperties"
      }), " methods with the following."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "ObjectExtensionManager.Instance.Modules()\r\n    .ConfigureIdentity(identity =>\r\n    {\r\n        identity.ConfigureUser(user =>\r\n        {\r\n            user.AddOrUpdateProperty<Guid>(ProfilePictureConsts.ProfilePictureId);\r\n        });\r\n    });\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "configure-ef-core",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#configure-ef-core",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Configure ef core"]
    }), "\n", _jsxs(_components.p, {
      children: ["In the ", _jsx(_components.code, {
        children: "EntityFrameworkCore"
      }), " project update the ", _jsx(_components.code, {
        children: "ProfilePictureSampleEfCoreEntityExtensionMappings"
      }), " file inside the ", _jsx(_components.code, {
        children: "Configure"
      }), " method. Update the ", _jsx(_components.code, {
        children: "OneTimeRunner.Run"
      }), " with the following"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "ObjectExtensionManager.Instance\r\n    .MapEfCoreProperty<IdentityUser, Guid>(ProfilePictureConsts.ProfilePictureId);\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "add-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add Migrations"]
    }), "\n", _jsxs(_components.p, {
      children: ["Navigate to the ", _jsx(_components.code, {
        children: "EntityFrameworkCore"
      }), "."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "cd .\\src\\ProfilePictureSample.EntityFrameworkCore\\\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Add migrations"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef migrations add \"update_user\"\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Apply the migrations"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef database update\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-the-appservice",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-appservice",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the AppService"]
    }), "\n", _jsx(_components.p, {
      children: "Create a AppService to upload and view the profile picture."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[Authorize]\r\npublic class ProfilePictureAppService : ProfilePictureSampleAppService\r\n{\r\n    private readonly IBlobContainer<ProfilePictureContainer> _blobContainer;\r\n    private readonly IRepository<IdentityUser, Guid> _repository;\r\n\r\n    public ProfilePictureAppService(IBlobContainer<ProfilePictureContainer> blobContainer, IRepository<IdentityUser, Guid> repository)\r\n    {\r\n        _blobContainer = blobContainer;\r\n        _repository = repository;\r\n    }\r\n\r\n    public virtual async Task<Guid> UploadAsync(IFormFile file)\r\n    {\r\n        await using var memoryStream = new MemoryStream();\r\n        await file.CopyToAsync(memoryStream).ConfigureAwait(false);\r\n        if (CurrentUser.Id == null)\r\n        {\r\n            return Guid.Empty;\r\n        }\r\n\r\n        var user = await _repository.GetAsync(CurrentUser.Id.Value).ConfigureAwait(false);\r\n        var pictureId = user.GetProperty<Guid>(ProfilePictureConsts.ProfilePictureId);\r\n\r\n        if (pictureId == Guid.Empty)\r\n        {\r\n            pictureId = Guid.NewGuid();\r\n        }\r\n        var id = pictureId.ToString();\r\n        if (await _blobContainer.ExistsAsync(id).ConfigureAwait(false))\r\n        {\r\n            await _blobContainer.DeleteAsync(id).ConfigureAwait(false);\r\n        }\r\n        await _blobContainer.SaveAsync(id, memoryStream.ToArray()).ConfigureAwait(false);\r\n        user.SetProperty(ProfilePictureConsts.ProfilePictureId, pictureId);\r\n        await _repository.UpdateAsync(user).ConfigureAwait(false);\r\n        return pictureId;\r\n    }\r\n\r\n    public async Task<FileResult> GetAsync()\r\n    {\r\n        if (CurrentUser.Id == null)\r\n        {\r\n            throw new FileNotFoundException();\r\n        }\r\n\r\n        var user = await _repository.GetAsync(CurrentUser.Id.Value).ConfigureAwait(false);\r\n        var pictureId = user.GetProperty<Guid>(ProfilePictureConsts.ProfilePictureId);\r\n        if (pictureId == default)\r\n        {\r\n            throw new FileNotFoundException();\r\n        }\r\n\r\n        var profilePicture = await _blobContainer.GetAllBytesOrNullAsync(pictureId.ToString()).ConfigureAwait(false);\r\n        return new FileContentResult(profilePicture, \"image/jpeg\");\r\n\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "repo-link",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#repo-link",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Repo ", _jsx(_components.a, {
        href: "https://github.com/antosubash/AbpProfilePictureSample",
        children: "Link"
      })]
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>dotnet core large file upload with resume using tus and react/nextjs</title>
          <link>https://blog.antosubash.com/posts/dotnet-and-react-nextjs-large-file-upload-with-tus</link>
          <guid>https://blog.antosubash.com/posts/dotnet-and-react-nextjs-large-file-upload-with-tus</guid>
          <pubDate>Thu, 22 Jul 2021 00:00:00 GMT</pubDate>
          <description>In this post you will see how to upload large files with resume using tus. We will use dotnet core for the backend and nextjs for the frontend</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    h3: "h3",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "large-file-upload-with-dotnet-and-react-with-tus",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#large-file-upload-with-dotnet-and-react-with-tus",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Large file upload with dotnet and react with tus"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to do large file upload in chunks with resume capabilities in dotnet core as a backend and react/nextjs as frontend."
    }), "\n", _jsxs(_components.h2, {
      id: "dotnet-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#dotnet-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "dotnet project"]
    }), "\n", _jsxs(_components.h3, {
      id: "create-the-net-project-using-this-following-command",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-net-project-using-this-following-command",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the .net project using this following command"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet new webapp -n FileUpload -o .\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "add-tusdotnet-nuget-package",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-tusdotnet-nuget-package",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add tusdotnet nuget package"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet add package tusdotnet --version 2.4.0\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "enable-cors",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#enable-cors",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Enable Cors"]
    }), "\n", _jsxs(_components.p, {
      children: ["Update the ", _jsx(_components.code, {
        children: "ConfigureServices"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "services.AddCors();\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Update ", _jsx(_components.code, {
        children: "Configure"
      }), " method"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "app.UseCors(builder => builder\r\n        .AllowAnyHeader()\r\n        .AllowAnyMethod()\r\n        .AllowAnyOrigin()\r\n        .WithExposedHeaders(CorsHelper.GetExposedHeaders()));\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "configure-maxrequestbodysize",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#configure-maxrequestbodysize",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Configure MaxRequestBodySize"]
    }), "\n", _jsxs(_components.p, {
      children: ["Update ", _jsx(_components.code, {
        children: "Configure"
      }), " method and make sure this is the first pipeline request."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "app.Use((context, next) =>\r\n{\r\n    // Default limit was changed some time ago. Should work by setting MaxRequestBodySize to null using ConfigureKestrel but this does not seem to work for IISExpress.\r\n    // Source: https://github.com/aspnet/Announcements/issues/267\r\n    context.Features.Get<IHttpMaxRequestBodySizeFeature>().MaxRequestBodySize = null;\r\n    return next.Invoke();\r\n});\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "configure-tus",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#configure-tus",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Configure tus"]
    }), "\n", _jsxs(_components.p, {
      children: ["Update ", _jsx(_components.code, {
        children: "Configure"
      }), " method"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "app.UseTus(httpContext => new DefaultTusConfiguration\r\n{\r\n    Store = new TusDiskStore(@\"C:\\tusfiles\\\"),\r\n    UrlPath = \"/files\",\r\n    Events = new Events\r\n    {\r\n        OnFileCompleteAsync = async eventContext =>\r\n        {\r\n            // eventContext.FileId is the id of the file that was uploaded.\r\n            // eventContext.Store is the data store that was used (in this case an instance of the TusDiskStore)\r\n\r\n            // A normal use case here would be to read the file and do some processing on it.\r\n            ITusFile file = await eventContext.GetFileAsync();\r\n            var result = await DoSomeProcessing(file, eventContext.CancellationToken).ConfigureAwait(false);\r\n\r\n            if (!result)\r\n            {\r\n                //throw new MyProcessingException(\"Something went wrong during processing\");\r\n            }\r\n        }\r\n    }\r\n});\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Make sure to put this before ", _jsx(_components.code, {
        children: "UseRouting"
      }), " and ", _jsx(_components.code, {
        children: "UseAuthorization"
      })]
    }), "\n", _jsxs(_components.h2, {
      id: "nextjs-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#nextjs-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Nextjs App"]
    }), "\n", _jsx(_components.p, {
      children: "Create next app"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "yarn create next-app --typescript\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Add tus package"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "yarn add tus-js-client\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Create file upload component"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-js",
        children: "import React from \"react\";\r\nimport { Upload } from \"tus-js-client\";\r\ninterface Props {}\r\n\r\nconst FileUpload = (props: Props) => {\r\n  const onFileChange = (e: any) => {\r\n    var file = e.target.files[0];\r\n    const upload = new Upload(file, {\r\n      endpoint: \"https://localhost:5001/files\",\r\n      retryDelays: [0, 1000, 3000, 5000],\r\n      metadata: {\r\n        filename: file.name,\r\n        filetype: file.type,\r\n      },\r\n      onError: function (error) {\r\n        console.log(\"Failed because: \" + error);\r\n      },\r\n      onProgress: function (bytesUploaded, bytesTotal) {\r\n        var percentage = ((bytesUploaded / bytesTotal) * 100).toFixed(2);\r\n        console.log(bytesUploaded, bytesTotal, percentage + \"%\");\r\n      },\r\n      onSuccess: function () {\r\n        console.log(\"Download %s from %s\", upload.file.name, upload.url);\r\n      },\r\n    });\r\n\r\n    // Check if there are any previous uploads to continue.\r\n    upload.findPreviousUploads().then(function (previousUploads) {\r\n      // Found previous uploads so we select the first one.\r\n      if (previousUploads.length) {\r\n        upload.resumeFromPreviousUpload(previousUploads[0]);\r\n      }\r\n\r\n      // Start the upload\r\n      upload.start();\r\n    });\r\n  };\r\n  return (\r\n    <div className=\"text-center text-2xl p-6\">\r\n      <input type=\"file\" name=\"file\" id=\"\" onChange={onFileChange} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FileUpload;\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Add the component to the page."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-html",
        children: "<FileUpload></FileUpload>\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Github Repo: https://github.com/antosubash/LargeFileUploadSample"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>dotnet file upload with ABP Blob store and Minio</title>
          <link>https://blog.antosubash.com/posts/dotnet-file-upload-with-abp</link>
          <guid>https://blog.antosubash.com/posts/dotnet-file-upload-with-abp</guid>
          <pubDate>Sat, 10 Jul 2021 00:00:00 GMT</pubDate>
          <description>In this post we will implement file upload using the ABP blob store and Minio</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will implement file upload using the ABP blob store and Minio"
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-new-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-new-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a new project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "abp new FileUpload\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-container",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-container",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a container"]
    }), "\n", _jsxs(_components.p, {
      children: ["Create the container in ", _jsx(_components.code, {
        children: "Domain"
      }), " project."]
    }), "\n", _jsxs(_components.p, {
      children: ["Install ", _jsx(_components.code, {
        children: "Volo.Abp.BlobStoring"
      }), " NuGet package to your ", _jsx(_components.code, {
        children: "Domain"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[BlobContainerName(\"document\")]\r\npublic class DocumentContainer\r\n{\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-the-entity-and-entity-dto",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-the-entity-and-entity-dto",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create the Entity and Entity Dto"]
    }), "\n", _jsxs(_components.p, {
      children: ["Create the Entity in ", _jsx(_components.code, {
        children: "Domain"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class Document : FullAuditedAggregateRoot<Guid>, IMultiTenant\r\n{\r\n    public long FileSize { get; set; }\r\n\r\n    public string MimeType { get; set; }\r\n\r\n    public Guid? TenantId { get; set; }\r\n\r\n    protected Document()\r\n    {\r\n    }\r\n\r\n    public Document(\r\n        Guid id,\r\n        long fileSize,\r\n        string mimeType,\r\n        Guid? tenantId\r\n    ) : base(id)\r\n    {\r\n        FileSize = fileSize;\r\n        MimeType = mimeType;\r\n        TenantId = tenantId;\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Create EntityDto in ", _jsx(_components.code, {
        children: "Contracts"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class DocumentDto : EntityDto<Guid>\r\n{\r\n    public long FileSize { get; set; }\r\n\r\n    public string FileUrl { get; set; }\r\n\r\n    public string MimeType { get; set; }\r\n}\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Add mapping for the Entity and Dto in the ", _jsx(_components.code, {
        children: "ApplicationAutoMapperProfile"
      }), " class in the ", _jsx(_components.code, {
        children: "Application"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "CreateMap<Document, DocumentDto>().ReverseMap();\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "add-entity-to-the-dbcontext",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-entity-to-the-dbcontext",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add entity to the DBContext"]
    }), "\n", _jsx(_components.p, {
      children: "Add DbSet"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public DbSet<Document> Documents { get; set; }\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Configure Ef core"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "builder.Entity<Document>(b =>\r\n{\r\n    b.ToTable(FileUploadConsts.DbTablePrefix + \"Document\", FileUploadConsts.DbSchema);\r\n    b.ConfigureByConvention();\r\n});\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "add-migration-and-update-the-database",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#add-migration-and-update-the-database",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Add migration and update the database"]
    }), "\n", _jsx(_components.p, {
      children: "To create ef migration"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef migrations add \"added_documents\"\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "To update the database"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef database update\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "configure-minio",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#configure-minio",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Configure Minio"]
    }), "\n", _jsxs(_components.p, {
      children: ["Install ", _jsx(_components.code, {
        children: "Volo.Abp.BlobStoring.Minio"
      }), " NuGet package to your ", _jsx(_components.code, {
        children: "Web"
      }), " and add ", _jsx(_components.code, {
        children: "[DependsOn(typeof(AbpBlobStoringMinioModule))]"
      }), " to the ", _jsx(_components.code, {
        children: "Web"
      }), " Module"]
    }), "\n", _jsxs(_components.p, {
      children: ["Configuration is done in the ", _jsx(_components.code, {
        children: "ConfigureServices"
      }), " method of your module class"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "Configure<AbpBlobStoringOptions>(options =>\r\n{\r\n    options.Containers.ConfigureDefault(container =>\r\n    {\r\n        container.UseMinio(minio =>\r\n        {\r\n            minio.EndPoint = \"localhost:9900\"; // your minio endPoint\r\n            minio.AccessKey = \"AKIAIOSFODNN7EXAMPLE\"; // your minio accessKey\r\n            minio.SecretKey = \"wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\"; // your minio secretKey\r\n            minio.BucketName = \"test1\"; // your minio bucketName\r\n        });\r\n    });\r\n});\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-document-appservice",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-document-appservice",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create Document AppService"]
    }), "\n", _jsx(_components.p, {
      children: "The app service will have 2 methods one is to upload the files and another one is to view the files."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class DocumentAppService : FileUploadAppService\r\n{\r\n    private readonly IBlobContainer<DocumentContainer> _blobContainer;\r\n    private readonly IRepository<Document, Guid> _repository;\r\n    public DocumentAppService(IRepository<Document, Guid> repository, IBlobContainer<DocumentContainer> blobContainer)\r\n    {\r\n        _repository = repository;\r\n        _blobContainer = blobContainer;\r\n    }\r\n\r\n    public async Task<List<DocumentDto>> Upload([FromForm] List<IFormFile> files)\r\n    {\r\n        var output = new List<DocumentDto>();\r\n        foreach (var file in files)\r\n        {\r\n            using var memoryStream = new MemoryStream();\r\n            await file.CopyToAsync(memoryStream).ConfigureAwait(false);\r\n            var id = Guid.NewGuid();\r\n            var newFile = new Document(id, file.Length, file.ContentType, CurrentTenant.Id);\r\n            var created = await _repository.InsertAsync(newFile);\r\n            await _blobContainer.SaveAsync(id.ToString(), memoryStream.ToArray()).ConfigureAwait(false);\r\n            output.Add(ObjectMapper.Map<Document, DocumentDto>(newFile));\r\n        }\r\n\r\n        return output;\r\n    }\r\n\r\n    public async Task<FileResult> Get(Guid id)\r\n    {\r\n        var currentFile = _repository.FirstOrDefault(x => x.Id == id);\r\n        if (currentFile != null)\r\n        {\r\n            var myfile = await _blobContainer.GetAllBytesOrNullAsync(id.ToString());\r\n            return new FileContentResult(myfile, currentFile.MimeType);\r\n        }\r\n\r\n        throw new FileNotFoundException();\r\n    }\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Repo Link : https://github.com/antosubash/FileUpload"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Setting up oh-my-posh and PSReadLine in PowerShell</title>
          <link>https://blog.antosubash.com/posts/setting-up-powershell-with-oh-my-posh-v3</link>
          <guid>https://blog.antosubash.com/posts/setting-up-powershell-with-oh-my-posh-v3</guid>
          <pubDate>Wed, 30 Jun 2021 00:00:00 GMT</pubDate>
          <description>In this post we will see how to setup the oh-my-posh and PSReadLine with PowerShell.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    h3: "h3",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "oh-my-posh",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#oh-my-posh",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), _jsx(_components.a, {
        href: "https://ohmyposh.dev",
        children: "Oh My Posh"
      })]
    }), "\n", _jsx(_components.p, {
      children: "Oh my is a prompt theme engine for PowerShell. It has many builtin themes and you can also create your own theme if you want. Lets see how you can install it and setup ohmyposh."
    }), "\n", _jsxs(_components.h3, {
      id: "install-in-powershell-module",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-in-powershell-module",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install in PowerShell Module"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Install-Module oh-my-posh -Scope AllUsers\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will install ohmyposh to all the users."
    }), "\n", _jsx(_components.p, {
      children: "If you are using the older version of the Oh My Posh. please update or uninstall the module."
    }), "\n", _jsx(_components.p, {
      children: "To update"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Update-Module -Name oh-my-posh\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "To uninstall"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "UnInstall-Module -Name oh-my-posh\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "install-fonts",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-fonts",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install fonts"]
    }), "\n", _jsxs(_components.p, {
      children: ["Oh My Posh uses ", _jsx(_components.a, {
        href: "https://www.nerdfonts.com/",
        children: "Nerd Font"
      }), ". It is recommed to use ", _jsx(_components.a, {
        href: "https://github.com/ryanoasis/nerd-fonts/releases/download/v2.1.0/Meslo.zip",
        children: "Meslo Lgm NF"
      })]
    }), "\n", _jsx(_components.p, {
      children: "Download the fonts and install install it."
    }), "\n", _jsxs(_components.h3, {
      id: "setting-the-font-in-windows-terminal",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#setting-the-font-in-windows-terminal",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Setting the font in Windows Terminal"]
    }), "\n", _jsx(_components.p, {
      children: "Once the font is installed set the font as a default font in Windows Terminal."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "{\r\n  \"profiles\": {\r\n    \"defaults\": {\r\n      \"fontFace\": \"MesloLGM NF\"\r\n    }\r\n  }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "view-themes-and-select-one-you-like",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#view-themes-and-select-one-you-like",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "View themes and select one you like"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Get-PoshThemes\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "import-module-and-set-theme",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#import-module-and-set-theme",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Import module and set theme"]
    }), "\n", _jsx(_components.p, {
      children: "Once you have decided on the theme we can import module and set the theme."
    }), "\n", _jsx(_components.p, {
      children: "We need to update the PowerShell profile to import and set the theme."
    }), "\n", _jsx(_components.p, {
      children: "To open the profile use this command."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "notepad.exe $PROFILE\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will open the PowerShell profile in notepad."
    }), "\n", _jsx(_components.p, {
      children: "Update the PowerShell with the following"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Import-Module oh-my-posh\r\nSet-PoshPrompt powerlevel10k_rainbow\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will import the Oh My Posh and set the theme."
    }), "\n", _jsxs(_components.h2, {
      id: "install-psreadline-and-powershellget",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-psreadline-and-powershellget",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install PSReadLine and PowerShellGet"]
    }), "\n", _jsx(_components.p, {
      children: "Before updating PowerShellGet, you should always install the latest NuGet provider. From an elevated PowerShell session, run the following command."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Install-PackageProvider -Name NuGet -Force\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "install-or-update-the-powershellget",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-or-update-the-powershellget",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install or update the PowerShellGet"]
    }), "\n", _jsx(_components.p, {
      children: "To install"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Install-Module -Name PowerShellGet -Force\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "To update"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Update-Module -Name PowerShellGet\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "install-psreadline",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-psreadline",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install PSReadLine"]
    }), "\n", _jsx(_components.p, {
      children: "To install"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Install-Module -Name PSReadLine -AllowPrerelease\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "import-and-configure-psreadline",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#import-and-configure-psreadline",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Import and configure PSReadLine"]
    }), "\n", _jsx(_components.p, {
      children: "Open the powershell profile"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "notepad $profile\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Add the PSReadLine config"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Import-Module PSReadLine\r\nSet-PSReadLineOption -EditMode Windows\r\nSet-PSReadLineOption -PredictionSource History\r\nSet-PSReadLineOption -PredictionViewStyle ListView\r\nSet-PSReadLineOption -PredictionViewStyle InlineView\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["For more config look ", _jsx(_components.a, {
        href: "https://github.com/PowerShell/PSReadLine/blob/master/PSReadLine/SamplePSReadLineProfile.ps1",
        children: "here"
      })]
    }), "\n", _jsxs(_components.h3, {
      id: "install-terminal-icons",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-terminal-icons",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install Terminal-Icons"]
    }), "\n", _jsx(_components.p, {
      children: "To install the module from the PowerShell Gallery:"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Install-Module -Name Terminal-Icons -Repository PSGallery\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Open the powershell profile"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "notepad $profile\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Import the terminal font"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Import-Module -Name Terminal-Icons\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Open a new prompt and verify if you the icons with the following command"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Get-ChildItem -Path . -Force\n"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Flutter Authentication using OpenID, ABP and IdentityServer4. Part 5</title>
          <link>https://blog.antosubash.com/posts/abp-auth-with-flutter-p5</link>
          <guid>https://blog.antosubash.com/posts/abp-auth-with-flutter-p5</guid>
          <pubDate>Sat, 29 May 2021 00:00:00 GMT</pubDate>
          <description>In this post we will implement the OAuth for the Flutter app.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    code: "code",
    h3: "h3",
    pre: "pre"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will implement the OAuth for the Flutter app."
    }), "\n", _jsxs(_components.h2, {
      id: "1-adding-a-new-client-to-the-identityserver",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#1-adding-a-new-client-to-the-identityserver",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "1. Adding a new client to the IdentityServer"]
    }), "\n", _jsxs(_components.p, {
      children: ["first step is to create a new client for the nextjs application. list of client is available in the ", _jsx(_components.code, {
        children: "appsettings.json"
      }), " file at ", _jsx(_components.code, {
        children: "DbMigrator"
      }), " project."]
    }), "\n", _jsxs(_components.h3, {
      id: "11-add-the-new-json-entry",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#11-add-the-new-json-entry",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "1.1 Add the new json entry"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "\"Todos_Flutter_2\": {\r\n  \"ClientId\": \"Todos_Flutter_2\",\r\n  \"RedirectUri\": \"http://localhost:3000/\"\r\n},\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "12-update-the-createclientsasync-method",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#12-update-the-createclientsasync-method",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "1.2 Update the CreateClientsAsync method"]
    }), "\n", _jsxs(_components.p, {
      children: ["In the ", _jsx(_components.code, {
        children: "Domain"
      }), " project there is a ", _jsx(_components.code, {
        children: "IdentityServerDataSeedContributor"
      }), " class which has the ", _jsx(_components.code, {
        children: "CreateClientsAsync"
      }), " method. This method creates the Identity server clients during the migrations. so we will update this method to include the new json entry."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "// Flutter2 Client\r\nvar flutter2Client = configurationSection[\"Todos_Flutter_2:ClientId\"];\r\nif (!flutter2Client.IsNullOrWhiteSpace())\r\n{\r\n    var redirectUrl = configurationSection[\"Todos_Flutter_2:RedirectUri\"];\r\n    await CreateClientAsync(\r\n        name: flutter2Client,\r\n        scopes: commonScopes,\r\n        grantTypes: new[] { \"authorization_code\" },\r\n        requireClientSecret: false,\r\n        redirectUri: redirectUrl\r\n    );\r\n}\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "13-run-the-migration",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#13-run-the-migration",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "1.3 Run the migration"]
    }), "\n", _jsx(_components.p, {
      children: "Now run the migration to add the client to the DB."
    }), "\n", _jsxs(_components.h2, {
      id: "2-exposing-localhost-using-ngrok",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#2-exposing-localhost-using-ngrok",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "2. Exposing localhost using ngrok"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: ".\\ngrok.exe http https://localhost:44354"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "3-creating-a-flutter-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#3-creating-a-flutter-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "3. Creating a flutter app"]
    }), "\n", _jsx(_components.p, {
      children: "Create the flutter app"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "flutter create mytodoapp\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Move into the folder"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "cd mytodoapp\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "List the devices"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "flutter devices\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Run the app"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "flutter run\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "4-add-dependencies",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#4-add-dependencies",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "4. Add dependencies"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yaml",
        children: "dependencies:\r\n  openid_client: ^0.4.1\r\n  url_launcher: ^6.0.4\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "41-update-the-android-manifest",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#41-update-the-android-manifest",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "4.1 Update the Android Manifest"]
    }), "\n", _jsxs(_components.p, {
      children: ["Update the android app to use the ", _jsx(_components.code, {
        children: "usesCleartextTraffic"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["you can find the android manifest in ", _jsx(_components.code, {
        children: "mytodoapp\\android\\app\\src\\main"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-xml",
        children: "<application\r\n    android:usesCleartextTraffic=\"true\"\r\n    android:label=\"mytodos\"\r\n    android:icon=\"@mipmap/ic_launcher\">\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "5-create-flutter-page-to-login-and-logout",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#5-create-flutter-page-to-login-and-logout",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "5. Create flutter page to login and logout"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-dart",
        children: "import 'package:flutter/material.dart';\r\nimport 'package:openid_client/openid_client.dart';\r\nimport 'package:openid_client/openid_client_io.dart';\r\nimport 'package:url_launcher/url_launcher.dart';\r\nimport 'dart:async';\r\n\r\nclass HomePage extends StatefulWidget {\r\n  HomePage({Key? key}) : super(key: key);\r\n\r\n  @override\r\n  _HomePageState createState() => _HomePageState();\r\n}\r\n\r\nclass _HomePageState extends State<HomePage> {\r\n  final String _clientId = 'Todos_Flutter_2';\r\n  static const String _issuer = 'https://d78170304b87.ngrok.io';\r\n  final List<String> _scopes = <String>[\r\n    'openid',\r\n    'profile',\r\n    'email',\r\n    'offline_access',\r\n    'Todos'\r\n  ];\r\n  String logoutUrl = \"\";\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    return Scaffold(\r\n      appBar: AppBar(\r\n        title: Text(\"Home\"),\r\n      ),\r\n      body: Container(\r\n        child: Center(\r\n          child: Column(\r\n            crossAxisAlignment: CrossAxisAlignment.center,\r\n            mainAxisAlignment: MainAxisAlignment.center,\r\n            children: [\r\n              ElevatedButton(\r\n                child: Text(\"Login\"),\r\n                onPressed: () async {\r\n                  var tokenInfo = await authenticate(\r\n                      Uri.parse(_issuer), _clientId, _scopes);\r\n                  print(tokenInfo.accessToken);\r\n                },\r\n              ),\r\n              ElevatedButton(\r\n                child: Text(\"Logout\"),\r\n                onPressed: () async {\r\n                  logout();\r\n                },\r\n              ),\r\n            ],\r\n          ),\r\n        ),\r\n      ),\r\n    );\r\n  }\r\n\r\n  Future<TokenResponse> authenticate(\r\n      Uri uri, String clientId, List<String> scopes) async {\r\n    // create the client\r\n    var issuer = await Issuer.discover(uri);\r\n    var client = new Client(issuer, clientId);\r\n\r\n    // create a function to open a browser with an url\r\n    urlLauncher(String url) async {\r\n      if (await canLaunch(url)) {\r\n        await launch(url, forceWebView: true, enableJavaScript: true);\r\n      } else {\r\n        throw 'Could not launch $url';\r\n      }\r\n    }\r\n\r\n    // create an authenticator\r\n    var authenticator = new Authenticator(\r\n      client,\r\n      scopes: scopes,\r\n      urlLancher: urlLauncher,\r\n      port: 3000,\r\n    );\r\n\r\n    // starts the authentication\r\n    var c = await authenticator.authorize();\r\n    // close the webview when finished\r\n    closeWebView();\r\n\r\n    var res = await c.getTokenResponse();\r\n    setState(() {\r\n      logoutUrl = c.generateLogoutUrl().toString();\r\n    });\r\n    print(res.accessToken);\r\n    return res;\r\n  }\r\n\r\n  Future<void> logout() async {\r\n    if (await canLaunch(logoutUrl)) {\r\n      await launch(logoutUrl, forceWebView: true);\r\n    } else {\r\n      throw 'Could not launch $logoutUrl';\r\n    }\r\n    await Future.delayed(Duration(seconds: 2));\r\n    closeWebView();\r\n  }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "github-repo-link--httpsgithubcomantosubashtodos",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#github-repo-link--httpsgithubcomantosubashtodos",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Github Repo Link : https://github.com/antosubash/Todos"]
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Application features with dotnet core and ABP. Part 4</title>
          <link>https://blog.antosubash.com/posts/abp-feature-p4</link>
          <guid>https://blog.antosubash.com/posts/abp-feature-p4</guid>
          <pubDate>Mon, 17 May 2021 00:00:00 GMT</pubDate>
          <description>ABP Feature system is used to enable, disable or change the behavior of the application features on runtime.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "ABP Feature system is used to enable, disable or change the behavior of the application features on runtime."
    }), "\n", _jsxs(_components.h2, {
      id: "create-feature-constant",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-feature-constant",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create feature constant"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public static class TodoFeatures\r\n{\r\n    public const string Todo = \"Todo\";\r\n    public const string MaxTodoPerUser = \"MaxTodoPerUser\";\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-feature-definition-provider",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-feature-definition-provider",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create feature definition provider"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class TodoFeatureDefinitionProvider : FeatureDefinitionProvider\r\n{\r\n    public override void Define(IFeatureDefinitionContext context)\r\n    {\r\n        var myGroup = context.AddGroup(\"MyTodoApp\");\r\n\r\n        myGroup.AddFeature(\r\n            TodoFeatures.Todo,\r\n            defaultValue: \"false\",\r\n            displayName: L(\"Todo\"),\r\n            valueType: new ToggleStringValueType()\r\n        );\r\n\r\n        myGroup.AddFeature(\r\n            TodoFeatures.MaxTodoPerUser,\r\n            defaultValue: \"10\",\r\n            displayName: L(\"MaxTodoPerUser\"),\r\n            valueType: new FreeTextStringValueType(\r\n                            new NumericValueValidator(0, 1000000))\r\n        );\r\n    }\r\n\r\n    private static LocalizableString L(string name)\r\n    {\r\n        return LocalizableString.Create<TodosResource>(name);\r\n    }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "expose-api-base-on-feature",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#expose-api-base-on-feature",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Expose api base on feature"]
    }), "\n", _jsxs(_components.p, {
      children: ["You can use the ", _jsx(_components.code, {
        children: "RequiresFeature"
      }), " attribute to restrict access to the api endpoint."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[RequiresFeature(TodoFeatures.Todo)]\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "ifeaturechecker-service",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#ifeaturechecker-service",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "IFeatureChecker service"]
    }), "\n", _jsx(_components.p, {
      children: "you can use the FeatureChecker service to check if the feature is enabled or not and get the value of the feature."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "var maxTodoPerUser = await FeatureChecker.GetAsync<int>(TodoFeatures.MaxTodoPerUser);\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "For more info check the official docs : https://docs.abp.io/en/abp/latest/Features"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Authorization in dotnet core with ABP. Part 3</title>
          <link>https://blog.antosubash.com/posts/abp-authorization-p3</link>
          <guid>https://blog.antosubash.com/posts/abp-authorization-p3</guid>
          <pubDate>Sun, 16 May 2021 00:00:00 GMT</pubDate>
          <description>In this post we will implement the Authorization in ABP with IdentityServer</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    code: "code",
    pre: "pre"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we are going to setup the authorization for the dotnet core ABP app. ABP extends ASP.NET Core Authorization by adding permissions as auto policies."
    }), "\n", _jsxs(_components.h2, {
      id: "creating-permission",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#creating-permission",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Creating permission"]
    }), "\n", _jsxs(_components.p, {
      children: ["In the ABP application the permission are available in the ", _jsx(_components.code, {
        children: "Contracts"
      }), " project. Find the Permissions class and add your custom permission."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public static class Todo\r\n{\r\n    public const string Default = GroupName + \".Todo\";\r\n    public const string Create = Default + \".Create\";\r\n    public const string Update = Default + \".Update\";\r\n    public const string Delete = Default + \".Delete\";\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "define-permission",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#define-permission",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Define permission"]
    }), "\n", _jsxs(_components.p, {
      children: [_jsx(_components.code, {
        children: "PermissionDefinitionProvider"
      }), " is where you have to define the permissions."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "var myGroup = context.AddGroup(TodosPermissions.GroupName);\r\n\r\nvar todoPermission = myGroup.AddPermission(TodosPermissions.Todo.Default, L(\"Permission:Default\"));\r\ntodoPermission.AddChild(TodosPermissions.Todo.Create, L(\"Permission:Create\"));\r\ntodoPermission.AddChild(TodosPermissions.Todo.Update, L(\"Permission:Update\"));\r\ntodoPermission.AddChild(TodosPermissions.Todo.Delete, L(\"Permission:Delete\"));\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "protecting-api-endpoint-based-on-permission",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#protecting-api-endpoint-based-on-permission",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Protecting api endpoint based on permission"]
    }), "\n", _jsxs(_components.p, {
      children: ["Once the permission is defined now we can create use the ", _jsx(_components.code, {
        children: "Authorize"
      }), " attribute to enforce the permission"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "[Authorize(TodosPermissions.Todo.Default)]\r\npublic async Task<List<TodoDto>> GetAll()\r\n{\r\n    return ObjectMapper.Map<List<Todo>, List<TodoDto>>(await todoRepository.GetListAsync());\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "In the above code we have added the default permission to the getAll api call."
    }), "\n", _jsxs(_components.h2, {
      id: "checking-permission",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#checking-permission",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Checking permission"]
    }), "\n", _jsxs(_components.p, {
      children: ["ASP.NET Core provides the ", _jsx(_components.code, {
        children: "IAuthorizationService"
      }), " that can be used to check for authorization. Once you inject, you can use it in your code to conditionally control the authorization."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "var result = await AuthorizationService\r\n    .AuthorizeAsync(TodosPermissions.Todo.Default);\r\nif (result.Succeeded == false)\r\n{\r\n    //throw exception\r\n    throw new AbpAuthorizationException(\"...\");\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "or"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "await AuthorizationService.CheckAsync(TodosPermissions.Todo.Default);\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "For more info check the official docs : https://docs.abp.io/en/abp/latest/Authorization"
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>SPA Authentication using Next.js, ABP and IdentityServer4. Part 2</title>
          <link>https://blog.antosubash.com/posts/abp-auth-with-nextjs-p2</link>
          <guid>https://blog.antosubash.com/posts/abp-auth-with-nextjs-p2</guid>
          <pubDate>Sat, 06 Mar 2021 00:00:00 GMT</pubDate>
          <description>In this post we will implement the SPA authentication for the Nexjs.js app as the frontend and ABP with IdentityServer as Backend</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    code: "code",
    h3: "h3",
    pre: "pre"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to create a Identity server Client and configure it to implement authenticate for the Next.js Application."
    }), "\n", _jsxs(_components.h2, {
      id: "1-adding-a-new-client-to-the-identityserver",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#1-adding-a-new-client-to-the-identityserver",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "1. Adding a new client to the IdentityServer"]
    }), "\n", _jsxs(_components.p, {
      children: ["first step is to create a new client for the nextjs application. list of client is available in the ", _jsx(_components.code, {
        children: "appsettings.json"
      }), " file at ", _jsx(_components.code, {
        children: "DbMigrator"
      }), " project."]
    }), "\n", _jsxs(_components.h3, {
      id: "11-add-the-new-json-entry",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#11-add-the-new-json-entry",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "1.1 Add the new json entry"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "\"Todos_Spa_1\": {\r\n    \"ClientId\": \"Todos_Spa_1\",\r\n    \"ClientSecret\": \"1q2w3e*\",\r\n    \"RootUrl\": \"http://localhost:3000\"\r\n},\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "12-update-the-createclientsasync-method",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#12-update-the-createclientsasync-method",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "1.2 Update the CreateClientsAsync method"]
    }), "\n", _jsxs(_components.p, {
      children: ["In the ", _jsx(_components.code, {
        children: "Domain"
      }), " project there is a ", _jsx(_components.code, {
        children: "IdentityServerDataSeedContributor"
      }), " class which has the ", _jsx(_components.code, {
        children: "CreateClientsAsync"
      }), " method. This method creates the Identity server clients during the migrations. so we will update this method to include the new json entry."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "// React Client\r\nvar reactClient = configurationSection[\"Todos_Spa_1:ClientId\"];\r\nif (!reactClient.IsNullOrWhiteSpace())\r\n{\r\n    var webClientRootUrl = configurationSection[\"Todos_Spa_1:RootUrl\"]?.TrimEnd('/');\r\n\r\n    await CreateClientAsync(\r\n        name: reactClient,\r\n        scopes: commonScopes,\r\n        grantTypes: new[] { \"client_credentials\", \"authorization_code\" },\r\n        secret: (configurationSection[\"Todos_Spa_1:ClientSecret\"] ?? \"1q2w3e*\").Sha256(),\r\n        requireClientSecret: false,\r\n        redirectUri: $\"{webClientRootUrl}/authentication/login-callback/identity-server4\",\r\n        postLogoutRedirectUri: $\"{webClientRootUrl}\",\r\n        corsOrigins: new[] { webClientRootUrl.RemovePostFix(\"/\") }\r\n    );\r\n}\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "13-run-the-migration",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#13-run-the-migration",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "1.3 Run the migration"]
    }), "\n", _jsx(_components.p, {
      children: "Now run the migration to add the client to the DB."
    }), "\n", _jsxs(_components.h2, {
      id: "2-create-nextjs-app",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#2-create-nextjs-app",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "2. Create Next.js App"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "yarn create next-app\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "3-add-next-auth-package",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#3-add-next-auth-package",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "3. Add next-auth package"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "yarn add next-auth\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "4-add-env-file",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#4-add-env-file",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "4. Add .env file"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "NEXTAUTH_URL=http://localhost:3000\r\nNEXT_PUBLIC_API_URL=https://localhost:44391\r\nIdentityServer4_Domain=localhost:44354\r\nIdentityServer4_CLIENT_ID=Todos_Spa_1\r\nIdentityServer4_CLIENT_SECRET=\"1q2w3e*\"\r\nNODE_TLS_REJECT_UNAUTHORIZED=0\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: [_jsx(_components.code, {
        children: "NEXT_PUBLIC_API_URL"
      }), " is the ABP application url."]
    }), "\n", _jsxs(_components.p, {
      children: [_jsx(_components.code, {
        children: "NEXTAUTH_URL"
      }), " is the nextjs app url."]
    }), "\n", _jsxs(_components.p, {
      children: [_jsx(_components.code, {
        children: "NODE_TLS_REJECT_UNAUTHORIZED"
      }), " is set to 0 to work with ssl in localhost."]
    }), "\n", _jsxs(_components.h2, {
      id: "5-setup-next-auth",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#5-setup-next-auth",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "5. Setup next-auth"]
    }), "\n", _jsxs(_components.p, {
      children: ["create a ", _jsx(_components.code, {
        children: "/pages/api/auth/[...nextauth].js"
      }), " and add the following"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-js",
        children: "import NextAuth from \"next-auth\";\r\nimport Providers from \"next-auth/providers\";\r\n\r\nexport default NextAuth({\r\n  // Configure one or more authentication providers\r\n  providers: [\r\n    Providers.IdentityServer4({\r\n      id: \"identity-server4\",\r\n      name: \"IdentityServer4\",\r\n      scope: \"openid profile email Todos offline_access\", // Allowed Scopes\r\n      domain: process.env.IdentityServer4_Domain,\r\n      clientId: process.env.IdentityServer4_CLIENT_ID,\r\n      clientSecret: process.env.IdentityServer4_CLIENT_SECRET,\r\n    }),\r\n  ],\r\n  callbacks: {\r\n    /**\r\n     * @param  {object} session      Session object\r\n     * @param  {object} token        User object    (if using database sessions)\r\n     *                               JSON Web Token (if not using database sessions)\r\n     * @return {object}              Session that will be returned to the client\r\n     */\r\n    async session(session, token) {\r\n      // Add property to session, like an access_token from a provider.\r\n      session.accessToken = token.accessToken;\r\n      return session;\r\n    },\r\n\r\n    async jwt(token, user, account, profile, isNewUser) {\r\n      // Add access_token to the token right after signin\r\n      if (account?.accessToken) {\r\n        token.accessToken = account.accessToken;\r\n      }\r\n      return token;\r\n    },\r\n  },\r\n});\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "6-create-login-component",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#6-create-login-component",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "6. Create login Component"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-js",
        children: "import React from \"react\";\r\nimport { signIn, signOut, useSession } from \"next-auth/client\";\r\nfunction Login() {\r\n  const [session, loading] = useSession();\r\n\r\n  return (\r\n    <>\r\n      {!session && (\r\n        <>\r\n          Not signed in <br />\r\n          <button onClick={() => signIn(\"identity-server4\")}>Sign in</button>\r\n        </>\r\n      )}\r\n      {session && (\r\n        <>\r\n          Signed in as {session.user.email} <br />\r\n          <button onClick={() => signOut()}>Sign out</button>\r\n        </>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Login;\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "7-render-the-login-component",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#7-render-the-login-component",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "7. Render the login component"]
    }), "\n", _jsx(_components.p, {
      children: "Now you can render the login component in any page to trigger the auth."
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "<Login></Login>"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "github-repo-link--httpsgithubcomantosubashtodos",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#github-repo-link--httpsgithubcomantosubashtodos",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Github Repo Link : https://github.com/antosubash/Todos"]
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>ABP Getting Started With .Net Core and EF Core. ABP Part 1</title>
          <link>https://blog.antosubash.com/posts/abp-getting-started-p1</link>
          <guid>https://blog.antosubash.com/posts/abp-getting-started-p1</guid>
          <pubDate>Fri, 05 Mar 2021 00:00:00 GMT</pubDate>
          <description>This is an introduction to the ABP Application framework with .Net core and EF core. I have created a Todo App with a CRUD function.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    img: "img",
    code: "code",
    pre: "pre"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "intro",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#intro",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Intro"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how to create a CRUD API in ABP Application framework with dotnet core and ef core. It will be simple Todo api."
    }), "\n", _jsx(_components.p, {
      children: "You can watch the videos or continue with the post."
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "https://www.youtube.com/watch?v=m8pjAtmpmBI",
        children: _jsx(_components.img, {
          src: "https://img.youtube.com/vi/m8pjAtmpmBI/0.jpg",
          alt: "IMAGE ALT TEXT HERE"
        })
      })
    }), "\n", _jsxs(_components.h2, {
      id: "preparing-the-project",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#preparing-the-project",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Preparing the Project"]
    }), "\n", _jsx(_components.p, {
      children: "Use the Getting started at https://docs.abp.io/en/abp/latest/getting-started?ui=mvc&db=ef&tiered=no guide to setup the basic abp application"
    }), "\n", _jsxs(_components.h2, {
      id: "1-create-an-entity",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#1-create-an-entity",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "1. Create an ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Entities",
        children: "Entity"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["First step is to create an Entity. Create the Entity in the ", _jsx(_components.code, {
        children: "Domain"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class Todo : Entity<Guid>\r\n{\r\n    public string Content { get; set; }\r\n    public bool IsDone { get; set; }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "2-add-entity-to-ef-core",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#2-add-entity-to-ef-core",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "2. Add Entity to ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Entity-Framework-Core",
        children: "ef core"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["Next is to add Entity to the EF Core. you will find the DbContext in the ", _jsx(_components.code, {
        children: "EntityFrameworkCore"
      }), " project. Add the DbSet to the DbContext"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public DbSet<Todo> Todos { get; set; }\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "3-configure-entity-in-ef-core",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#3-configure-entity-in-ef-core",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "3. Configure Entity in ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Entity-Framework-Core#configurebyconvention-method",
        children: "ef core"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["Configuration is done in the ", _jsx(_components.code, {
        children: "DbContextModelCreatingExtensions"
      }), " class. This should be available in the ", _jsx(_components.code, {
        children: "EntityFrameworkCore"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "builder.Entity<Todo>(b =>\r\n{\r\n    b.ToTable(TodosConsts.DbTablePrefix + \"Todos\", TodosConsts.DbSchema);\r\n    b.ConfigureByConvention(); //auto configure for the base class props\r\n});\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "4-adding-migrations",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#4-adding-migrations",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "4. Adding Migrations"]
    }), "\n", _jsx(_components.p, {
      children: "Now the Entity is configured we can add the migrations."
    }), "\n", _jsxs(_components.p, {
      children: ["Go the ", _jsx(_components.code, {
        children: "EntityFrameworkCore.DbMigrations"
      }), " project in the terminal and create migrations."]
    }), "\n", _jsx(_components.p, {
      children: "To create migration run this command:"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef migrations add created_todo\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Verify the migrations created in the migrations folder."
    }), "\n", _jsx(_components.p, {
      children: "To update the database run this command"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "dotnet ef database update\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "5-create-a-entity-dto",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#5-create-a-entity-dto",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "5. Create a Entity Dto"]
    }), "\n", _jsxs(_components.p, {
      children: ["Dto are placed in ", _jsx(_components.code, {
        children: "Contracts"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class TodoDto : EntityDto<Guid>\r\n{\r\n    public string Content { get; set; }\r\n    public bool IsDone { get; set; }\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "6-map-entity-to-dto",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#6-map-entity-to-dto",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "6. Map Entity to Dto"]
    }), "\n", _jsxs(_components.p, {
      children: ["Abp uses AutoMapper to map Entity to Dto. you can find the ", _jsx(_components.code, {
        children: "ApplicationAutoMapperProfile"
      }), " file which is used by the AutoMapper in the ", _jsx(_components.code, {
        children: "Application"
      }), " project."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "CreateMap<Todo, TodoDto>();\r\nCreateMap<TodoDto, Todo>();\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "7-create-an-application-services",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#7-create-an-application-services",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "7. Create an ", _jsx(_components.a, {
        href: "https://docs.abp.io/en/abp/latest/Application-Services",
        children: "Application Services"
      })]
    }), "\n", _jsxs(_components.p, {
      children: ["Application service are created in the ", _jsx(_components.code, {
        children: "Application"
      }), " project"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-cs",
        children: "public class TodoAppService : YourProjectAppService\r\n{\r\n    private readonly IRepository<Todo, Guid> todoRepository;\r\n\r\n    public TodoAppService(IRepository<Todo, Guid> todoRepository)\r\n    {\r\n        this.todoRepository = todoRepository;\r\n    }\r\n\r\n    public async Task<List<TodoDto>> GetAll()\r\n    {\r\n        return ObjectMapper.Map<List<Todo>, List<TodoDto>>(await todoRepository.GetListAsync());\r\n    }\r\n\r\n    public async Task<TodoDto> CreateAsync(TodoDto todoDto)\r\n    {\r\n        var todo = ObjectMapper.Map<TodoDto, Todo>(todoDto);\r\n        var createdTodo = await todoRepository.InsertAsync(todo);\r\n        return ObjectMapper.Map<Todo, TodoDto>(createdTodo);\r\n    }\r\n\r\n    public async Task<TodoDto> UpdateAsync(TodoDto todoDto)\r\n    {\r\n        var todo = ObjectMapper.Map<TodoDto, Todo>(todoDto);\r\n        var createdTodo = await todoRepository.UpdateAsync(todo);\r\n        return ObjectMapper.Map<Todo, TodoDto>(createdTodo);\r\n    }\r\n\r\n    public async Task<bool> DeleteAsync(Guid id)\r\n    {\r\n        var todo = await todoRepository.FirstOrDefaultAsync(x=> x.Id == id);\r\n        if(todo != null)\r\n        {\r\n            await todoRepository.DeleteAsync(todo);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Once you created the Application configuration ABP can automatically configure your service as API controllers by conventions."
    }), "\n", _jsxs(_components.h2, {
      id: "github-repo-link--httpsgithubcomantosubashtodos",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#github-repo-link--httpsgithubcomantosubashtodos",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Github Repo Link : https://github.com/antosubash/Todos"]
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Docker swarm setup for localhost</title>
          <link>https://blog.antosubash.com/posts/docker-swarm-localhost</link>
          <guid>https://blog.antosubash.com/posts/docker-swarm-localhost</guid>
          <pubDate>Sat, 26 Dec 2020 00:00:00 GMT</pubDate>
          <description>In this post we will see how to setup docker swarm for localhost.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.p, {
      children: ["Most of the stack used here are available in my github ", _jsx(_components.a, {
        href: "https://github.com/antosubash/docker_stack",
        children: "repo"
      }), "."]
    }), "\n", _jsxs(_components.h2, {
      id: "my-docker-localhost-setup",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#my-docker-localhost-setup",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "My docker localhost setup"]
    }), "\n", _jsx(_components.p, {
      children: "This is my localhost setup."
    }), "\n", _jsxs(_components.h2, {
      id: "enable-swarn-mode",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#enable-swarn-mode",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Enable swarn mode"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "docker swarm init"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "protainer-deployment",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#protainer-deployment",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "protainer deployment"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "docker stack deploy --compose-file=portainer-agent-stack.yml portainer"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "mysql-volume",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#mysql-volume",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "MySql Volume"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "docker volume create mysql1"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "postgres-volume",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#postgres-volume",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Postgres Volume"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "docker volume create postgres"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "mongo-volume",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#mongo-volume",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Mongo Volume"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "docker volume create mongo1"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "deploy-mysql-stack",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#deploy-mysql-stack",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "deploy mysql stack"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "docker stack deploy --compose-file=mysql_stack.yml mysql"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "deploy-mongodb-stack",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#deploy-mongodb-stack",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "deploy mongodb stack"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "docker stack deploy --compose-file=mongo_stack.yml mongo"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "deploy-postgres-stack",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#deploy-postgres-stack",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "deploy postgres stack"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "docker stack deploy --compose-file=postgres_stack.yml postgres"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "docker-see-the-services",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#docker-see-the-services",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "docker see the services"]
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.code, {
        children: "docker service ls"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Set up Wsl with zsh and oh-my-zsh</title>
          <link>https://blog.antosubash.com/posts/setup-zsh-and-oh-my-zsh</link>
          <guid>https://blog.antosubash.com/posts/setup-zsh-and-oh-my-zsh</guid>
          <pubDate>Sat, 12 Dec 2020 00:00:00 GMT</pubDate>
          <description>In this post we will see how to setup zsh shell in the wsl and use oh-my-zsh.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    h3: "h3",
    pre: "pre",
    code: "code",
    ol: "ol",
    li: "li",
    h4: "h4"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsx(_components.p, {
      children: "In this post we will see how can we install and setup up zsh shell and use oh-my-posh with it in wsl ubuntu."
    }), "\n", _jsxs(_components.h2, {
      id: "setup-z-shell",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#setup-z-shell",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Setup Z Shell"]
    }), "\n", _jsxs(_components.h3, {
      id: "install-the-z-shell-and-git",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-the-z-shell-and-git",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install the Z shell and git"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "sudo apt install zsh\r\nsudo apt install git\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "check-the-z-shell-version",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#check-the-z-shell-version",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Check the Z shell version"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "zsh --version\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "change-the-default-shell",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#change-the-default-shell",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Change the default shell"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "chsh -s $(which zsh)\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "log-out-and-login-again-to-use-the-new-default-shell",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#log-out-and-login-again-to-use-the-new-default-shell",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Log out and login again to use the new default shell"]
    }), "\n", _jsxs(_components.h3, {
      id: "check-the-current-shell",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#check-the-current-shell",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Check the current shell"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "echo $SHELL // Expected result: /bin/zsh\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "install-oh-my-zsh",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-oh-my-zsh",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install Oh My Zsh"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "sh -c \"$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\"\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "install-zsh-autosuggestions-and-zsh-syntax-highlighting",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-zsh-autosuggestions-and-zsh-syntax-highlighting",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install zsh-autosuggestions and zsh-syntax-highlighting"]
    }), "\n", _jsxs(_components.h3, {
      id: "set-up-zsh-syntax-highlighting",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#set-up-zsh-syntax-highlighting",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Set up zsh-syntax-highlighting"]
    }), "\n", _jsxs(_components.ol, {
      children: ["\n", _jsxs(_components.li, {
        children: ["Clone this repository into ", _jsx(_components.code, {
          children: "$ZSH_CUSTOM/plugins"
        }), " (by default ", _jsx(_components.code, {
          children: "~/.oh-my-zsh/custom/plugins"
        }), "):"]
      }), "\n"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-zsh",
        children: "git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-syntax-highlighting\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "set-up-zsh-autosuggestions",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#set-up-zsh-autosuggestions",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Set up zsh-autosuggestions"]
    }), "\n", _jsxs(_components.ol, {
      children: ["\n", _jsxs(_components.li, {
        children: ["Clone this repository into ", _jsx(_components.code, {
          children: "$ZSH_CUSTOM/plugins"
        }), " (by default ", _jsx(_components.code, {
          children: "~/.oh-my-zsh/custom/plugins"
        }), ")"]
      }), "\n"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-sh",
        children: "git clone https://github.com/zsh-users/zsh-autosuggestions ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "plugins",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#plugins",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Plugins"]
    }), "\n", _jsxs(_components.p, {
      children: ["Oh My Zsh comes with a shitload of plugins for you to take advantage of. You can take a look in the ", _jsx(_components.a, {
        href: "https://github.com/ohmyzsh/ohmyzsh/tree/master/plugins",
        children: "plugins"
      }), " directory and/or the ", _jsx(_components.a, {
        href: "https://github.com/ohmyzsh/ohmyzsh/wiki/Plugins",
        children: "wiki"
      }), " to see what's currently available."]
    }), "\n", _jsxs(_components.h4, {
      id: "enabling-plugins",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#enabling-plugins",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Enabling Plugins"]
    }), "\n", _jsxs(_components.p, {
      children: ["Once you spot a plugin (or several) that you'd like to use with Oh My Zsh, you'll need to enable them in the ", _jsx(_components.code, {
        children: ".zshrc"
      }), " file. You'll find the zshrc file in your ", _jsx(_components.code, {
        children: "$HOME"
      }), " directory. Open it with your favorite text editor and you'll see a spot to list all the plugins you want to load."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-shell",
        children: "vi ~/.zshrc\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "For example, this might begin to look like this:"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-shell",
        children: "plugins=(\r\n  git\r\n  zsh-autosuggestions\r\n  zsh-syntax-highlighting\r\n)\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "load-the-config",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#load-the-config",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Load the config"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-sh",
        children: "source ~/.zshrc\n"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Set up Windows Terminal with PoshGit, oh-my-posh and Cascadia Code PL</title>
          <link>https://blog.antosubash.com/posts/setup-window-terminal-with-poshgit</link>
          <guid>https://blog.antosubash.com/posts/setup-window-terminal-with-poshgit</guid>
          <pubDate>Sat, 05 Dec 2020 00:00:00 GMT</pubDate>
          <description>In this post we will see how to setup windows terminal with PoshGit and oh-my-posh to make the terminal more productive</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    img: "img",
    pre: "pre",
    code: "code",
    strong: "strong"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "set-up-windows-terminal-with-poshgit-oh-my-posh-and-cascadia-code-pli",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#set-up-windows-terminal-with-poshgit-oh-my-posh-and-cascadia-code-pli",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Set up Windows Terminal with PoshGit, oh-my-posh and Cascadia Code PLi"]
    }), "\n", _jsx(_components.p, {
      children: "You can watch a videos of how to setup or continue with the post."
    }), "\n", _jsx(_components.p, {
      children: _jsx(_components.a, {
        href: "https://www.youtube.com/watch?v=cJ7oINPF2mo",
        children: _jsx(_components.img, {
          src: "https://img.youtube.com/vi/cJ7oINPF2mo/0.jpg",
          alt: "IMAGE ALT TEXT HERE"
        })
      })
    }), "\n", _jsxs(_components.p, {
      children: ["There are few ways to install the window terminal. The easy way is to install from the ", _jsx(_components.a, {
        href: "https://aka.ms/terminal",
        children: "windows store"
      }), ". There are few other ways available."]
    }), "\n", _jsxs(_components.p, {
      children: ["Via ", _jsx(_components.a, {
        href: "https://github.com/microsoft/winget-cli/",
        children: "WinGet"
      }), " (official package manager for Windows):"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-powershell",
        children: "winget install --id=Microsoft.WindowsTerminal -e\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Via ", _jsx(_components.a, {
        href: "https://chocolatey.org/",
        children: "Chocolatey"
      }), ":"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-powershell",
        children: "choco install microsoft-windows-terminal\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Via ", _jsx(_components.a, {
        href: "https://scoop.sh/",
        children: "Scoop"
      }), ":"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-powershell",
        children: "scoop install windows-terminal\n"
      })
    }), "\n", _jsxs(_components.p, {
      children: ["Once the terminal is installed then you have to install 2 important powershell modules they are ", _jsx(_components.code, {
        children: "posh-git"
      }), " and ", _jsx(_components.code, {
        children: "oh-my-posh"
      }), ". ", _jsx(_components.strong, {
        children: "Make sure you open the terminal as Administrator"
      })]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Install-Module posh-git -Scope CurrentUser\r\nInstall-Module oh-my-posh -Scope CurrentUser\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Once module is installed then we have to import the module. We will do this in the powershell profile."
    }), "\n", _jsx(_components.p, {
      children: "To open the profile type"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "if (!(Test-Path -Path $PROFILE )) { New-Item -Type File -Path $PROFILE -Force }\r\nnotepad $PROFILE\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "The above command will check if the profile is already available. if it is not available then it will create one for you. Once created we can open this in the notepad. once the notepad is opened append the following."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "Import-Module posh-git\r\nImport-Module oh-my-posh\r\nSet-Theme Paradox\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "This will be executed before you open the powershell. we are importing the powershell modules and setting a theme for our powershell."
    }), "\n", _jsxs(_components.p, {
      children: ["Now we have to install the font ", _jsx(_components.a, {
        href: "https://github.com/microsoft/cascadia-code/releases",
        children: "Cascadia Code PL"
      }), ". You can get it from here https://github.com/microsoft/cascadia-code/releases"]
    }), "\n", _jsxs(_components.p, {
      children: ["Once the font is installed you can set the font in the ", _jsx(_components.a, {
        href: "https://docs.microsoft.com/en-us/windows/terminal/customize-settings/profile-settings",
        children: "profile settings"
      }), "."]
    }), "\n", _jsx(_components.p, {
      children: "here is the sample"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-json",
        children: "{\r\n    // Make changes here to the powershell.exe profile.\r\n    \"guid\": \"{61c54bbd-c2c6-5271-96e7-009a87ff44bf}\",\r\n    \"name\": \"Windows PowerShell\",\r\n    \"commandline\": \"powershell.exe\",\r\n    \"fontFace\": \"Cascadia Code PL\",\r\n    \"hidden\": false\r\n},\n"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Css for leaflet div element</title>
          <link>https://blog.antosubash.com/posts/css-for-leaflet-div-element</link>
          <guid>https://blog.antosubash.com/posts/css-for-leaflet-div-element</guid>
          <pubDate>Mon, 21 Sep 2020 00:00:00 GMT</pubDate>
          <description>If you are like me who struggle with anything CSS. These are some small css that will help you to fill the leaflet map without setting the fixed height</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    p: "p",
    h3: "h3",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "css-for-the-leaflet-div",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#css-for-the-leaflet-div",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Css for the leaflet div"]
    }), "\n", _jsx(_components.p, {
      children: "There are a few times when I set the div height to 100% the leaflet map is empty. This is mostly because the div is not fully occupying the entries space available. These are some CSS snippets I use during those times."
    }), "\n", _jsxs(_components.h3, {
      id: "to-fill-the-entire-page",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#to-fill-the-entire-page",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "To fill the entire page"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-css",
        children: "#map {\r\n  height: 100vh;\r\n  width: 100vw;\r\n}\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "to-fill-the-entire-div",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#to-fill-the-entire-div",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "To fill the entire div"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-css",
        children: "#map {\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n}\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "using-css-calc",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#using-css-calc",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Using CSS calc"]
    }), "\n", _jsxs(_components.p, {
      children: ["Most of the times there will be a Top bar or a Sidebar available in the map during these times the ", _jsx(_components.code, {
        children: "calc"
      }), " function in the css will come in handy. lets assume you have side bar which is ", _jsx(_components.code, {
        children: "100px"
      }), " and top bar which is ", _jsx(_components.code, {
        children: "60px"
      }), " you can use something like below."]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-css",
        children: "#map {\r\n  width: calc(100vw - 100px);\r\n  height: calc(100vh - 60px);\r\n  margin-top: 60px;\r\n  margin-left: 100px;\r\n}\n"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Setup docker in Ubuntu 18.04</title>
          <link>https://blog.antosubash.com/posts/setup-docker-node-hetzner</link>
          <guid>https://blog.antosubash.com/posts/setup-docker-node-hetzner</guid>
          <pubDate>Thu, 17 Sep 2020 07:35:07 GMT</pubDate>
          <description>In this post you will see how to setup docker in Ubuntu 18.04. We will also change the default ssh port and install fail2ban.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    pre: "pre",
    code: "code"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "adding-new-user",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#adding-new-user",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Adding new user"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "adduser docker-login\r\nusermod -aG sudo docker-login\r\nsu - docker-login\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "changing-ssh",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#changing-ssh",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Changing ssh"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "nano /etc/ssh/sshd_config\r\n\r\nClientAliveInterval 300\r\nClientAliveCountMax 1\r\nAllowUsers root docker-login\r\nPort 234\r\nMaxAuthTries 5\r\nAllowTcpForwarding no                   # Disables port forwarding.\r\nAllowAgentForwarding no                 # Disables the forwarding of the SSH login.\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "refresh-and-restart",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#refresh-and-restart",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Refresh and restart"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "\r\nsshd -t\r\n\r\nsystemctl restart sshd\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "fail2ban",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#fail2ban",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Fail2ban"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "apt install fail2ban\r\nsystemctl enable fail2ban\r\n\r\ncp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local\r\n\r\nnano /etc/fail2ban/jail.local\r\n\r\nenabled = true\r\nport = 234\r\n\r\nsystemctl restart fail2ban\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "install-docker",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#install-docker",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Install Docker"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "sudo apt update\r\n\r\nsudo apt install apt-transport-https ca-certificates curl software-properties-common\r\n\r\ncurl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\r\nsudo add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable\"\r\nsudo apt update\r\napt-cache policy docker-ce\r\nsudo apt install docker-ce\r\nsudo systemctl status docker\r\nsudo systemctl enable docker\r\nsudo usermod -aG docker ${USER}\r\nsu - ${USER}\r\nid -nG\r\nsudo usermod -aG docker docker-login\r\ndocker\n"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item><item>
          <title>Traefik setup with docker swarm</title>
          <link>https://blog.antosubash.com/posts/setup-traefik-docker</link>
          <guid>https://blog.antosubash.com/posts/setup-traefik-docker</guid>
          <pubDate>Thu, 17 Sep 2020 05:35:07 GMT</pubDate>
          <description>In this post you will see how to setup traefik with docker swarm. Along with that we will also setup Portainer and Swarmpit so that it is easy to manage the docker swarm.</description>
          <content:encoded><![CDATA[/*@jsxRuntime automatic @jsxImportSource react*/
const {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];
function _createMdxContent(props) {
  const _components = Object.assign({
    h2: "h2",
    a: "a",
    span: "span",
    pre: "pre",
    code: "code",
    p: "p",
    h3: "h3"
  }, props.components);
  return _jsxs(_Fragment, {
    children: [_jsxs(_components.h2, {
      id: "table-of-contents",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#table-of-contents",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Table of contents"]
    }), "\n", _jsxs(_components.h2, {
      id: "docker-swarm-init",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#docker-swarm-init",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Docker swarm init"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "docker swarm init --advertise-addr 10.0.0.3\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-traefik-network",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-traefik-network",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a traefik network"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "docker network create --driver overlay traefik-public\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "create-a-htpasswd-password",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-a-htpasswd-password",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create a htpasswd password"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "docker run --rm httpd:2.4-alpine htpasswd -nbB admin <password> | cut -d \":\" -f 2\n"
      })
    }), "\n", _jsx(_components.p, {
      children: "Escape the $ sign in the password by adding one more $"
    }), "\n", _jsxs(_components.h2, {
      id: "create-folders",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#create-folders",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Create folders"]
    }), "\n", _jsxs(_components.h3, {
      id: "for-traefik",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#for-traefik",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "for Traefik"]
    }), "\n", _jsx(_components.p, {
      children: "create a folder and set 600 as permission."
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "mkdir /home/docker-login/data/traefik\r\ntouch /home/docker-login/data/traefik/acme.json\r\nchmod 600 /home/docker-login/data/traefik/acme.json\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "for-swarmpit",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#for-swarmpit",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "for Swarmpit"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "mkdir /home/docker-login/data/db-data\r\nmkdir /home/docker-login/data/influx-data\n"
      })
    }), "\n", _jsxs(_components.h3, {
      id: "for-portainer",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#for-portainer",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "for Portainer"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-bash",
        children: "mkdir /mnt/volume2/portainer\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "traefik-docker-compose-yml",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#traefik-docker-compose-yml",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Traefik docker compose yml"]
    }), "\n", _jsx(_components.p, {
      children: "Sample yml"
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "version: \"3.3\"\r\n\r\nservices:\r\n  traefik:\r\n    image: \"traefik:v2.1.4\"\r\n    command:\r\n      - --log.level=INFO\r\n      - --entrypoints.web.address=:80\r\n      - --entrypoints.websecure.address=:443\r\n      - --providers.docker\r\n      - --providers.docker.exposedbydefault=false\r\n      - --providers.docker.swarmmode=true\r\n      - --providers.docker.network=traefik-public\r\n      - --api\r\n      - --api.dashboard=true\r\n      - --certificatesresolvers.leresolver.acme.caserver=https://acme-v02.api.letsencrypt.org/directory\r\n      # update your email here\r\n      - --certificatesresolvers.leresolver.acme.email=youremail@test.com\r\n      # Make sure the this file is available and permission is set correctly\r\n      - --certificatesresolvers.leresolver.acme.storage=/le/acme.json\r\n      - --certificatesresolvers.leresolver.acme.tlschallenge=true\r\n    ports:\r\n      - \"80:80\"\r\n      - \"443:443\"\r\n    networks:\r\n      - traefik-public\r\n    volumes:\r\n      - \"/var/run/docker.sock:/var/run/docker.sock:ro\"\r\n      # Make sure the volume folder is created\r\n      - \"/home/docker-login/data/traefik/acme.json:/le/acme.json\"\r\n    deploy:\r\n      labels:\r\n        # Dashboard\r\n        - \"traefik.enable=true\"\r\n        # Change the host url here\r\n        - \"traefik.http.routers.traefik.rule=Host(`traefik.example.com`)\"\r\n        - \"traefik.http.routers.traefik.service=api@internal\"\r\n        - \"traefik.http.services.traefik.loadbalancer.server.port=8080\"\r\n        - \"traefik.http.routers.traefik.tls.certresolver=leresolver\"\r\n        - \"traefik.http.routers.traefik.entrypoints=websecure\"\r\n        - \"traefik.http.routers.traefik.middlewares=authtraefik\"\r\n        # Change the auth password here\r\n        - \"traefik.http.middlewares.authtraefik.basicauth.users=admin:yournewpassword\" # user/password\r\n\r\n        # global redirect to https\r\n        - \"traefik.http.routers.http-catchall.rule=hostregexp(`{host:.+}`)\"\r\n        - \"traefik.http.routers.http-catchall.entrypoints=web\"\r\n        - \"traefik.http.routers.http-catchall.middlewares=redirect-to-https\"\r\n\r\n        # middleware redirect\r\n        - \"traefik.http.middlewares.redirect-to-https.redirectscheme.scheme=https\"\r\n\r\n  my-app:\r\n    image: containous/whoami:v1.3.0\r\n    networks:\r\n      - traefik-public\r\n    command:\r\n      - --port=8082 # Our service listens on 8082\r\n    deploy:\r\n      labels:\r\n        - \"traefik.enable=true\"\r\n        # Change the host url here\r\n        - \"traefik.http.routers.my-app.rule=Host(`whoami.example.com`)\"\r\n        - \"traefik.http.services.my-app.loadbalancer.server.port=8082\"\r\n        - \"traefik.http.routers.my-app.middlewares=auth\"\r\n        - \"traefik.http.routers.my-app.entrypoints=websecure\"\r\n        - \"traefik.http.routers.my-app.tls=true\"\r\n        - \"traefik.http.routers.my-app.tls.certresolver=leresolver\"\r\n        # Change the password here\r\n        - \"traefik.http.middlewares.auth.basicauth.users=admin:changeme\" # user/password\r\n\r\nnetworks:\r\n  traefik-public:\r\n    external: true\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "swarmpit-docker-compose",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#swarmpit-docker-compose",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Swarmpit Docker compose"]
    }), "\n", _jsx(_components.p, {
      children: "Make sure the service name for swarmpit is \"app\""
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "version: \"3.3\"\r\n\r\nservices:\r\n  app:\r\n    image: swarmpit/swarmpit:latest\r\n    environment:\r\n      - SWARMPIT_DB=http://db:5984\r\n      - SWARMPIT_INFLUXDB=http://influxdb:8086\r\n    volumes:\r\n      - /var/run/docker.sock:/var/run/docker.sock:ro\r\n    networks:\r\n      - traefik-public\r\n    deploy:\r\n      labels:\r\n        - \"traefik.enable=true\"\r\n        # change the host name here\r\n        - \"traefik.http.routers.app.rule=Host(`swarm.example.com`)\"\r\n        - \"traefik.http.services.app.loadbalancer.server.port=8080\"\r\n        - \"traefik.http.routers.app.tls=true\"\r\n        - \"traefik.http.routers.app.tls.certresolver=leresolver\"\r\n        - \"traefik.docker.network=traefik-public\"\r\n      resources:\r\n        limits:\r\n          cpus: \"0.50\"\r\n          memory: 1024M\r\n        reservations:\r\n          cpus: \"0.25\"\r\n          memory: 512M\r\n      placement:\r\n        constraints:\r\n          - node.role == manager\r\n\r\n  db:\r\n    image: couchdb:2.3.0\r\n    volumes:\r\n      # make sure the folder is available\r\n      - /home/docker-login/data/db-data:/opt/couchdb/data\r\n    networks:\r\n      - traefik-public\r\n    deploy:\r\n      resources:\r\n        limits:\r\n          cpus: \"0.30\"\r\n          memory: 256M\r\n        reservations:\r\n          cpus: \"0.15\"\r\n          memory: 128M\r\n\r\n  influxdb:\r\n    image: influxdb:1.7\r\n    volumes:\r\n      # make sure the folder is available\r\n      - /home/docker-login/data/influx-data:/var/lib/influxdb\r\n    networks:\r\n      - traefik-public\r\n    deploy:\r\n      resources:\r\n        limits:\r\n          cpus: \"0.60\"\r\n          memory: 512M\r\n        reservations:\r\n          cpus: \"0.30\"\r\n          memory: 128M\r\n\r\n  agent:\r\n    image: swarmpit/agent:latest\r\n    environment:\r\n      - DOCKER_API_VERSION=1.35\r\n    volumes:\r\n      - /var/run/docker.sock:/var/run/docker.sock:ro\r\n    networks:\r\n      - traefik-public\r\n    deploy:\r\n      mode: global\r\n      labels:\r\n        swarmpit.agent: \"true\"\r\n      resources:\r\n        limits:\r\n          cpus: \"0.10\"\r\n          memory: 64M\r\n        reservations:\r\n          cpus: \"0.05\"\r\n          memory: 32M\r\n\r\nnetworks:\r\n  traefik-public:\r\n    external: true\n"
      })
    }), "\n", _jsxs(_components.h2, {
      id: "portainer",
      children: [_jsx(_components.a, {
        "aria-hidden": "true",
        tabIndex: "-1",
        href: "#portainer",
        children: _jsx(_components.span, {
          className: "icon icon-link"
        })
      }), "Portainer"]
    }), "\n", _jsx(_components.pre, {
      children: _jsx(_components.code, {
        className: "language-yml",
        children: "version: \"3.2\"\r\n\r\nservices:\r\n  agent:\r\n    image: portainer/agent\r\n    volumes:\r\n      - /var/run/docker.sock:/var/run/docker.sock\r\n      - /var/lib/docker/volumes:/var/lib/docker/volumes\r\n    networks:\r\n      - traefik-public\r\n    deploy:\r\n      mode: global\r\n      placement:\r\n        constraints: [node.platform.os == linux]\r\n\r\n  portainer:\r\n    image: portainer/portainer\r\n    command: -H tcp://tasks.agent:9001 --tlsskipverify\r\n    volumes:\r\n      - /var/run/docker.sock:/var/run/docker.sock\r\n      # make sure the folder is available\r\n      - /mnt/volume2/portainer:/data\r\n    networks:\r\n      - traefik-public\r\n    deploy:\r\n      labels:\r\n        - \"traefik.enable=true\"\r\n        # change the host here\r\n        - \"traefik.http.routers.portainer.rule=Host(`admin.example.com`)\"\r\n        - \"traefik.http.services.portainer.loadbalancer.server.port=9000\"\r\n        - \"traefik.http.routers.portainer.entrypoints=websecure\"\r\n        - \"traefik.http.routers.portainer.tls=true\"\r\n        - \"traefik.http.routers.portainer.tls.certresolver=leresolver\"\r\n      mode: replicated\r\n      placement:\r\n        constraints: [node.role == manager]\r\n\r\nnetworks:\r\n  traefik-public:\r\n    external: true\n"
      })
    })]
  });
}
function MDXContent(props = {}) {
  const {wrapper: MDXLayout} = props.components || ({});
  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {
    children: _jsx(_createMdxContent, props)
  })) : _createMdxContent(props);
}
return {
  default: MDXContent
};
]]></content:encoded>
          </item>
        </channel>
        </rss>